{"meta":{"version":1,"warehouse":"4.0.0"},"models":{"Asset":[{"_id":"themes/butterfly/source/css/index.styl","path":"css/index.styl","modified":0,"renderable":1},{"_id":"themes/butterfly/source/css/var.styl","path":"css/var.styl","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/main.js","path":"js/main.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/tw_cn.js","path":"js/tw_cn.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/img/404.jpg","path":"img/404.jpg","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/utils.js","path":"js/utils.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/img/algolia.svg","path":"img/algolia.svg","modified":0,"renderable":1},{"_id":"themes/butterfly/source/img/favicon.png","path":"img/favicon.png","modified":0,"renderable":1},{"_id":"themes/butterfly/source/img/friend_404.gif","path":"img/friend_404.gif","modified":0,"renderable":1},{"_id":"themes/butterfly/source/img/loading.gif","path":"img/loading.gif","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/search/algolia.js","path":"js/search/algolia.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/search/local-search.js","path":"js/search/local-search.js","modified":0,"renderable":1},{"_id":"source/image/gitlab-project.png","path":"image/gitlab-project.png","modified":0,"renderable":0},{"_id":"source/image/image-20210106101222963.png","path":"image/image-20210106101222963.png","modified":0,"renderable":0},{"_id":"source/image/image-20210106144024660.png","path":"image/image-20210106144024660.png","modified":0,"renderable":0},{"_id":"source/image/用户画像标签体系1-1610100155452.png","path":"image/用户画像标签体系1-1610100155452.png","modified":0,"renderable":0},{"_id":"source/image/用户画像标签体系1-1610100324696.png","path":"image/用户画像标签体系1-1610100324696.png","modified":0,"renderable":0},{"_id":"source/image/用户画像标签体系1-1610100479337.png","path":"image/用户画像标签体系1-1610100479337.png","modified":0,"renderable":0},{"_id":"source/image/用户画像标签体系1-1610100447523.png","path":"image/用户画像标签体系1-1610100447523.png","modified":0,"renderable":0},{"_id":"source/image/用户画像标签体系1-1610100346329.png","path":"image/用户画像标签体系1-1610100346329.png","modified":0,"renderable":0},{"_id":"source/image/用户画像标签体系1-1610100518466.png","path":"image/用户画像标签体系1-1610100518466.png","modified":0,"renderable":0},{"_id":"source/image/用户画像标签体系1-1610100559561.png","path":"image/用户画像标签体系1-1610100559561.png","modified":0,"renderable":0},{"_id":"source/image/用户画像标签体系1-1610100569781.png","path":"image/用户画像标签体系1-1610100569781.png","modified":0,"renderable":0},{"_id":"source/image/用户画像标签体系1-1610100589257.png","path":"image/用户画像标签体系1-1610100589257.png","modified":0,"renderable":0},{"_id":"source/image/用户画像标签体系1-1610100608905.png","path":"image/用户画像标签体系1-1610100608905.png","modified":0,"renderable":0},{"_id":"source/image/用户画像标签体系1-1610100632944.png","path":"image/用户画像标签体系1-1610100632944.png","modified":0,"renderable":0}],"Cache":[{"_id":"source/_posts/Git.md","hash":"05216e61efe3dfeabde1d51f635f9cf3d7a92a11","modified":1610084197384},{"_id":"source/_posts/flink-table-api和flink-sql.md","hash":"5fb9311f552f97f3d62c1b6511796bdeca0a56db","modified":1610525956493},{"_id":"source/_posts/hello-world.md","hash":"fa0e876012585fa0f954ec24e64babfb7adc2768","modified":1610079645680},{"_id":"source/_posts/标签体系.md","hash":"0785ef37893ca7a043444c4ce1b2e8f2f1beca8d","modified":1610078793304},{"_id":"source/_posts/标签体系一些坑.md","hash":"de927c91362b22faecd00e3f1d059743d518b8a4","modified":1610706006467},{"_id":"source/_posts/标签体系级联更新、删除.md","hash":"27f17aaeb9741d945ba8530b33604a61641148b9","modified":1610439413420},{"_id":"source/_posts/用户画像标签体系3.md","hash":"f2b32dc74cde87e148a9f13102c5372779b10330","modified":1610101749140},{"_id":"source/about/index.md","hash":"b7d0ee2d6ef6573faa711490d875b215c0840293","modified":1610949829792},{"_id":"source/image/image-20210106101222963.png","hash":"808fab05a90f07518375de870a36265a7e66dc75","modified":1610078750845},{"_id":"source/image/image-20210106144024660.png","hash":"073bee7a6cfc9ccf373271480f51db5becc88eb6","modified":1610078688080},{"_id":"source/image/用户画像标签体系1-1610100479337.png","hash":"8cbc399d4c28ebece418f0f359394d4f4f941ba1","modified":1610100483336},{"_id":"source/image/用户画像标签体系1-1610100559561.png","hash":"dd04a94847fe153ae563a64d581ea3b04b6b46e7","modified":1610100563454},{"_id":"source/image/用户画像标签体系1-1610100569781.png","hash":"cb5b153a32ead91c2ff4037d0c4d3b36aed62fc7","modified":1610100574212},{"_id":"source/image/用户画像标签体系1-1610100589257.png","hash":"b8ee067def63a63977590a5da805974006d4ed47","modified":1610100598481},{"_id":"source/todos/index.md","hash":"07f060a3234c4cfb17caea37b6c4431c7e437770","modified":1610950476676},{"_id":"source/image/用户画像标签体系1-1610100518466.png","hash":"7e69c497ff32d012aa990f99bee18367fdf84d4f","modified":1610100524890},{"_id":"source/image/用户画像标签体系1-1610100632944.png","hash":"ee326e3828b9596a97bfd979dce7c9e0e077ae94","modified":1610100637291},{"_id":"source/image/用户画像标签体系1-1610100608905.png","hash":"fd8f4784df5404578088aa258c60e882c0908b5c","modified":1610100612669},{"_id":"source/image/用户画像标签体系1-1610100346329.png","hash":"81096486f7ae6e8370c0e05df0a361d964859afa","modified":1610100349220},{"_id":"source/image/用户画像标签体系1-1610100447523.png","hash":"542f7fec23dfd3ca4e2b770358c15d9a84856e82","modified":1610100454529},{"_id":"source/image/用户画像标签体系1-1610100155452.png","hash":"781e1b0dc1e84d48318ea01f1e779cdaa22e5052","modified":1610100159137},{"_id":"source/image/用户画像标签体系1-1610100324696.png","hash":"ae16a2fac8c1952f454583b969ddda9fccac9aa3","modified":1610100327700},{"_id":"themes/butterfly/README.md","hash":"d9ac9b7c8eea12d58a5465ef452a94ef44e1a798","modified":1610950929038},{"_id":"themes/butterfly/LICENSE","hash":"1128f8f91104ba9ef98d37eea6523a888dcfa5de","modified":1610950929038},{"_id":"themes/butterfly/README_CN.md","hash":"95939ce71e4020784a852e7c6e5543f4e3998bf0","modified":1610950929038},{"_id":"themes/butterfly/package.json","hash":"3a9142a8e70c383d70fad36a7d8ecc7464bad079","modified":1610950929081},{"_id":"themes/butterfly/_config.yml","hash":"ba8d34b81f9b3450f7803ca336de62d7f3b7527b","modified":1610951195569},{"_id":"themes/butterfly/.github/stale.yml","hash":"05a55a87fa7f122c59683e41c8b2e37e79f688f0","modified":1610950929038},{"_id":"themes/butterfly/layout/404.pug","hash":"cb7b4fb164621d1fd7c33184241bd24662c85299","modified":1610950929041},{"_id":"themes/butterfly/layout/archive.pug","hash":"bd62286afb64a51c97e800c5945620d51605d5fa","modified":1610950929041},{"_id":"themes/butterfly/layout/page.pug","hash":"d5063ec93d33bd8488c12007709b6aafd8b9cf5f","modified":1610950929080},{"_id":"themes/butterfly/favicon.png","hash":"17d5e00f617685d8155ffb0e5971405d4614b9c3","modified":1610951053924},{"_id":"themes/butterfly/layout/index.pug","hash":"e1c3146834c16e6077406180858add0a8183875a","modified":1610950929080},{"_id":"themes/butterfly/layout/category.pug","hash":"d014234c26d2c07caaea6703f7b48cb69c51907d","modified":1610950929041},{"_id":"themes/butterfly/layout/post.pug","hash":"de0c69f0583347f6064e9f2c344aac6b97c2a74d","modified":1610950929080},{"_id":"themes/butterfly/languages/default.yml","hash":"9840c4341123f326bb8ae1e871cda916a4e4825a","modified":1610950929039},{"_id":"themes/butterfly/layout/tag.pug","hash":"0440f42569df2676273c026a92384fa7729bc4e9","modified":1610950929080},{"_id":"themes/butterfly/languages/en.yml","hash":"69bdeac93fd3e816eb5ed9748b9be0a570fcef03","modified":1610950929040},{"_id":"themes/butterfly/.github/ISSUE_TEMPLATE/bug_report.md","hash":"476802922b774b679225102ac30a9d9183394701","modified":1610950929037},{"_id":"themes/butterfly/languages/zh-TW.yml","hash":"fe97468c40dbce850756f9b262389270f7fe9421","modified":1610950929040},{"_id":"themes/butterfly/languages/zh-CN.yml","hash":"b434d133125cd6bb597c91e0e591fb1d563377e7","modified":1610950929040},{"_id":"themes/butterfly/.github/ISSUE_TEMPLATE/feature_request.md","hash":"f6867a2f0417fe89a0f2008730ee19dd38422021","modified":1610950929038},{"_id":"themes/butterfly/.github/ISSUE_TEMPLATE/custom.md","hash":"eff495eb1584cf4586e33c76e8b2fa6a469a179b","modified":1610950929038},{"_id":"themes/butterfly/layout/includes/additional-js.pug","hash":"6961a4f98f9971581e7d41d527fd90f9d2e82163","modified":1610950929042},{"_id":"themes/butterfly/layout/includes/footer.pug","hash":"02390a5b6ae1f57497b22ba2e6be9f13cfb7acac","modified":1610950929042},{"_id":"themes/butterfly/layout/includes/layout.pug","hash":"acb5657931fa0857f80b37116ec1a16b0c250544","modified":1610950929047},{"_id":"themes/butterfly/layout/includes/head.pug","hash":"6c517d30c606c22883053998ce0d89e11da2f769","modified":1610950929042},{"_id":"themes/butterfly/scripts/events/404.js","hash":"3c30dbd8b910ce7d8d7d8353cf2266cbc5d8775d","modified":1610950929081},{"_id":"themes/butterfly/scripts/events/init.js","hash":"43b245c308797c2d62cb70429a85f1a05d3395ab","modified":1610950929082},{"_id":"themes/butterfly/scripts/events/welcome.js","hash":"d575137c8779e50422c2416f4d0832fdea346ee6","modified":1610950929082},{"_id":"themes/butterfly/scripts/filters/post_lazyload.js","hash":"e9cf275c362d8634f093e63068da7ed1e53c7600","modified":1610950929082},{"_id":"themes/butterfly/scripts/filters/random_cover.js","hash":"0f5017be123ae2b2ddf231d9d71a5c4cd1f2f206","modified":1610950929083},{"_id":"themes/butterfly/scripts/helpers/aside_archives.js","hash":"f30b0c108474b2869b35ee70dbc6ed2f2066979d","modified":1610950929083},{"_id":"themes/butterfly/scripts/helpers/aside_categories.js","hash":"e01e86233820a32690e3e2e14a20f01511407644","modified":1610950929084},{"_id":"themes/butterfly/scripts/helpers/page.js","hash":"51fb52f76423e4dbebd198f0a2a4190ed14e3093","modified":1610950929084},{"_id":"themes/butterfly/scripts/helpers/related_post.js","hash":"0d8ba6120dce617a2a1fbc9167572db2ee9f22ef","modified":1610950929084},{"_id":"themes/butterfly/scripts/tag/button.js","hash":"e75283267f3a4773e6d803593d557e218396f260","modified":1610950929085},{"_id":"themes/butterfly/scripts/tag/gallery.js","hash":"94826ea6bcc4d2304199adae12c4e2b272caf529","modified":1610950929085},{"_id":"themes/butterfly/scripts/tag/hide.js","hash":"f33858ffb9e88191e644796e11d2f901eb332308","modified":1610950929085},{"_id":"themes/butterfly/layout/includes/pagination.pug","hash":"c543384810f7989a5381b3cdf191e7daac17178b","modified":1610950929050},{"_id":"themes/butterfly/layout/includes/rightside.pug","hash":"2d0453adf92a3fd3466cf0793f14685d17b8b51d","modified":1610950929052},{"_id":"themes/butterfly/layout/includes/sidebar.pug","hash":"f81b25dfabfa50e76acd100b97774936179ad85f","modified":1610950929053},{"_id":"themes/butterfly/scripts/tag/mermaid.js","hash":"35f073021db93699fcac9ef351e26c59c31aadf7","modified":1610950929086},{"_id":"themes/butterfly/scripts/tag/note.js","hash":"c16c6eb058af2b36bcd583b2591076c7ebdd51ad","modified":1610950929086},{"_id":"themes/butterfly/scripts/tag/tabs.js","hash":"6c6e415623d0fd39da016d9e353bb4f5cca444f5","modified":1610950929088},{"_id":"themes/butterfly/source/css/var.styl","hash":"e92eaefda462315051872b7894a6f6eb70a29006","modified":1610950929114},{"_id":"themes/butterfly/source/css/index.styl","hash":"861998e4ac67a59529a8245a9130d68f826c9c12","modified":1610950929114},{"_id":"themes/butterfly/source/js/utils.js","hash":"41481019ef510c74e744f4f7ec4d0a13b5ccc04c","modified":1610950929124},{"_id":"themes/butterfly/source/js/main.js","hash":"4e526092321b8c4e93837e716ef4f587ffff9a60","modified":1610950929118},{"_id":"themes/butterfly/source/js/tw_cn.js","hash":"00053ce73210274b3679f42607edef1206eebc68","modified":1610950929123},{"_id":"themes/butterfly/source/img/404.jpg","hash":"fb4489bc1d30c93d28f7332158c1c6c1416148de","modified":1610950929115},{"_id":"themes/butterfly/source/img/favicon.png","hash":"3cf89864b4f6c9b532522a4d260a2e887971c92d","modified":1610950929116},{"_id":"themes/butterfly/source/img/loading.gif","hash":"5f0287fb8fb98872fe1998c6f781111819e71806","modified":1610950929117},{"_id":"themes/butterfly/layout/includes/head/Open_Graph.pug","hash":"5390f2aea030486bf78678b910bda177b0ba5d05","modified":1610950929042},{"_id":"themes/butterfly/source/img/algolia.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1610950929115},{"_id":"themes/butterfly/source/img/friend_404.gif","hash":"8d2d0ebef70a8eb07329f57e645889b0e420fa48","modified":1610950929116},{"_id":"themes/butterfly/layout/includes/head/analytics.pug","hash":"90d01b88d0f406d00184960b1afe9230aec2ebe6","modified":1610950929043},{"_id":"themes/butterfly/layout/includes/head/config_site.pug","hash":"189ab8ea17a8c342b0aafd68439f32889a096253","modified":1610950929043},{"_id":"themes/butterfly/layout/includes/head/js.pug","hash":"de4eb7c3536e5cfb82f5d7586afa9a093e85e695","modified":1610950929044},{"_id":"themes/butterfly/layout/includes/head/config.pug","hash":"3da1dc28cfb2ae1ca4a7a52c760fdc8e1e983215","modified":1610950929043},{"_id":"themes/butterfly/layout/includes/head/google_adsense.pug","hash":"95a37e92b39c44bcbea4be7e29ddb3921c5b8220","modified":1610950929043},{"_id":"themes/butterfly/layout/includes/head/site_verification.pug","hash":"62cf37e28795d8b68a0e850ec8c94987b9e08db5","modified":1610950929045},{"_id":"themes/butterfly/layout/includes/head/preconnect.pug","hash":"c9725750346975ea66b058fe71f57c5c69291ee4","modified":1610950929044},{"_id":"themes/butterfly/layout/includes/head/noscript.pug","hash":"d16ad2ee0ff5751fd7f8a5ce1b83935518674977","modified":1610950929044},{"_id":"themes/butterfly/layout/includes/head/pwa.pug","hash":"3d492cfe645d37c94d30512e0b230b0a09913148","modified":1610950929045},{"_id":"themes/butterfly/layout/includes/header/menu_item.pug","hash":"14cd0f9c0c578512896b487263cd48570d74771a","modified":1610950929045},{"_id":"themes/butterfly/layout/includes/header/index.pug","hash":"abfa1d6a4f57273baedc6d1106d568d9c5c8014f","modified":1610950929045},{"_id":"themes/butterfly/layout/includes/header/post-info.pug","hash":"12f6c0010fd1161ee0f9e2cba1bbe197578481b0","modified":1610950929046},{"_id":"themes/butterfly/layout/includes/header/nav.pug","hash":"0a8b0b3d82bef350fea5b42b1f69dbb6551b8627","modified":1610950929046},{"_id":"themes/butterfly/layout/includes/header/social.pug","hash":"0d953e51d04a9294a64153c89c20f491a9ec42d4","modified":1610950929046},{"_id":"themes/butterfly/layout/includes/loading/loading-js.pug","hash":"7ffcf93bc5ee95ca461aea2735cedc0785c9884d","modified":1610950929047},{"_id":"themes/butterfly/layout/includes/mixins/article-sort.pug","hash":"68dfd3c6a0f00b3ffc0333c81e165b4626f7425f","modified":1610950929048},{"_id":"themes/butterfly/layout/includes/loading/loading.pug","hash":"5276937fbcceb9d62879dc47be880cd469a27349","modified":1610950929047},{"_id":"themes/butterfly/layout/includes/page/categories.pug","hash":"1f30952fed73dec21b42e2e30b7fe2e84618d2e4","modified":1610950929049},{"_id":"themes/butterfly/layout/includes/page/artitalk.pug","hash":"2a435df727ba4a0e6678c06c1b4b83745dfef841","modified":1610950929049},{"_id":"themes/butterfly/layout/includes/page/flink.pug","hash":"da24e13ca15a376373fa3bae65f2bfb02f881b87","modified":1610950929049},{"_id":"themes/butterfly/layout/includes/mixins/post-ui.pug","hash":"1ba251eca702b7d34f4f65d58d51a87db1799144","modified":1610950929048},{"_id":"themes/butterfly/layout/includes/page/default-page.pug","hash":"dbec869c62135695495703a29ad7655e9965d461","modified":1610950929049},{"_id":"themes/butterfly/layout/includes/post/post-copyright.pug","hash":"88e3b611b03149665e4113cfa39595c1a3fca7e5","modified":1610950929050},{"_id":"themes/butterfly/layout/includes/post/reward.pug","hash":"bab59f87da66386e5abc84550614752c660a0705","modified":1610950929051},{"_id":"themes/butterfly/layout/includes/page/tags.pug","hash":"93d4ebc7dc8228c7a10ddeb5a553d0dcdabbe145","modified":1610950929049},{"_id":"themes/butterfly/layout/includes/third-party/aplayer.pug","hash":"292646dfab135973b09f0fa9e3931e83da2ed30e","modified":1610950929054},{"_id":"themes/butterfly/layout/includes/third-party/baidu_push.pug","hash":"6c8f95d54f337e2c6b3a40beff01d8554605df75","modified":1610950929054},{"_id":"themes/butterfly/layout/includes/third-party/effect.pug","hash":"b9d54a01d7c2a7a183cb7209e99430ce7fea1fe3","modified":1610950929062},{"_id":"themes/butterfly/layout/includes/third-party/pangu.pug","hash":"491d177a0a9c72321a8d208f3a186f667c170087","modified":1610950929066},{"_id":"themes/butterfly/layout/includes/third-party/prismjs.pug","hash":"1fbecfd299068f90d727f0c8c65e2a792fa6e3e2","modified":1610950929067},{"_id":"themes/butterfly/layout/includes/third-party/pjax.pug","hash":"cf8f2fff10e7adf1b0404b8d194c49dc35796721","modified":1610950929066},{"_id":"themes/butterfly/layout/includes/third-party/subtitle.pug","hash":"50f0574a1db1c62d56042b10880ba348d65d8fd9","modified":1610950929072},{"_id":"themes/butterfly/layout/includes/widget/card_ad.pug","hash":"60dc48a7b5d89c2a49123c3fc5893ab9c57dd225","modified":1610950929073},{"_id":"themes/butterfly/layout/includes/widget/card_archives.pug","hash":"934fbf955aee6219538ca5dc9b0a662472f2901e","modified":1610950929074},{"_id":"themes/butterfly/layout/includes/widget/card_announcement.pug","hash":"3d8e3706a056389176f55dd21956aabc78046761","modified":1610950929074},{"_id":"themes/butterfly/layout/includes/widget/card_author.pug","hash":"64bd872377d190966727668a00b156a8b3d95da3","modified":1610950929075},{"_id":"themes/butterfly/layout/includes/widget/card_categories.pug","hash":"c32bb3164b93b806c90d3f7a12d52859cb799458","modified":1610950929075},{"_id":"themes/butterfly/layout/includes/widget/card_newest_comment.pug","hash":"36b368516b5a746be84a6aa08767ee24d220d509","modified":1610950929076},{"_id":"themes/butterfly/layout/includes/widget/card_post_toc.pug","hash":"ae9336bf31cdad08ff586ead4295912a96563c76","modified":1610950929077},{"_id":"themes/butterfly/layout/includes/widget/card_recent_post.pug","hash":"e356f916ceb28702812d8f66c1fea0ae75eece47","modified":1610950929078},{"_id":"themes/butterfly/layout/includes/widget/card_self.pug","hash":"a1b2f5575b6804c5c4b9288db143b5164cbbd289","modified":1610950929078},{"_id":"themes/butterfly/layout/includes/widget/card_tags.pug","hash":"1c9652cf71da32414a79b0ea6704421a59bdce2e","modified":1610950929079},{"_id":"themes/butterfly/layout/includes/widget/card_webinfo.pug","hash":"0612aaee878f33ea8d3da0293c7dc3b6cd871466","modified":1610950929079},{"_id":"themes/butterfly/layout/includes/widget/index.pug","hash":"c99c7daf6f83a79f13f794c9097e3a1b171a3988","modified":1610950929079},{"_id":"themes/butterfly/source/css/_global/function.styl","hash":"13321de90ca8d5e092b9124dbe65f36a07c14af7","modified":1610950929092},{"_id":"themes/butterfly/source/css/_global/index.styl","hash":"29a404ffe2f9a7bec9330f48f4c43f21bf67d8b5","modified":1610950929093},{"_id":"themes/butterfly/source/css/_highlight/highlight.styl","hash":"3305ab95795801339bc515affca56c11ddc954e6","modified":1610950929094},{"_id":"themes/butterfly/source/css/_highlight/theme.styl","hash":"fa7a4c1685f391d60ed863e869b9604b59746c27","modified":1610950929097},{"_id":"themes/butterfly/source/css/_layout/404.styl","hash":"a510b67364d40794f9f0575c24b6987cab0b802a","modified":1610950929097},{"_id":"themes/butterfly/source/css/_layout/aside.styl","hash":"b740fc80f2018c6d7b4ec3b4ec37b8a686687caf","modified":1610950929098},{"_id":"themes/butterfly/source/css/_layout/chat.styl","hash":"29f48f9370f245e6e575b5836bccf47eb5688d8b","modified":1610950929098},{"_id":"themes/butterfly/source/css/_layout/comments.styl","hash":"f1b63892baafa48ab872bc79671d57aafd511f6c","modified":1610950929098},{"_id":"themes/butterfly/source/css/_layout/footer.styl","hash":"dd8cdf639ba2b726437c77fa7aa8d5edbabe8f9b","modified":1610950929099},{"_id":"themes/butterfly/source/css/_layout/loading.styl","hash":"7d18a7be9cfea65091de3ef00014063d2d649912","modified":1610950929100},{"_id":"themes/butterfly/source/css/_layout/pagination.styl","hash":"9e63cad808503d787b1485211333bef8e8a37571","modified":1610950929100},{"_id":"themes/butterfly/source/css/_layout/head.styl","hash":"24eea44716748c528725d994ae84cec19c308c5b","modified":1610950929099},{"_id":"themes/butterfly/source/css/_layout/post.styl","hash":"5edca90d42cc25ca60cfeed167a52951ed14865d","modified":1610950929101},{"_id":"themes/butterfly/source/css/_layout/relatedposts.styl","hash":"76d67b9a42e8b0c3d17316a6d75c5b5b4c65fb68","modified":1610950929102},{"_id":"themes/butterfly/source/css/_layout/rightside.styl","hash":"bb266c8cb123cdad508527e5a742566bc59d16c3","modified":1610950929103},{"_id":"themes/butterfly/source/css/_layout/reward.styl","hash":"7bf7af4754baba07edfc614621bdb965442cdc2f","modified":1610950929103},{"_id":"themes/butterfly/source/css/_layout/third-party.styl","hash":"a8673447cf327931ca4e90e03c7188bdaf8c0bca","modified":1610950929104},{"_id":"themes/butterfly/source/css/_layout/sidebar.styl","hash":"7a6e1f21173022a3a1f18a62785cdd657a1af0a1","modified":1610950929103},{"_id":"themes/butterfly/source/css/_mode/darkmode.styl","hash":"ab8b09d752a2a28ac8879d219a533a7b64aed164","modified":1610950929105},{"_id":"themes/butterfly/source/css/_mode/readmode.styl","hash":"39e7ccd83aefa3deccf42be8a82b74c5d9928b58","modified":1610950929106},{"_id":"themes/butterfly/source/css/_page/archives.styl","hash":"6874adc2e276443f354bbe50d0072e9bec37243c","modified":1610950929107},{"_id":"themes/butterfly/source/css/_page/flink.styl","hash":"43f00986410f3dc0eed9e0bf9478801da32be24f","modified":1610950929109},{"_id":"themes/butterfly/source/css/_page/common.styl","hash":"275091fc84f69f2b75b9dc4b0da1bc3c2c9d7a59","modified":1610950929108},{"_id":"themes/butterfly/source/css/_page/categories.styl","hash":"e554549f0a0ae85362f0b0e8687981741f486f6b","modified":1610950929107},{"_id":"themes/butterfly/source/css/_page/homepage.styl","hash":"d486cf1dfcfdbc0acd1a414c78f6a66df7432aa0","modified":1610950929110},{"_id":"themes/butterfly/source/css/_page/tags.styl","hash":"9a881c031f463c486bd25248c2814fd09f97892b","modified":1610950929110},{"_id":"themes/butterfly/source/css/_search/index.styl","hash":"89e744abc5e41f4855e7b87b13b854f4ec4ffc0e","modified":1610950929111},{"_id":"themes/butterfly/source/css/_search/local-search.styl","hash":"51f2bd03a2d0787911d0c090fb555a664b3fac8b","modified":1610950929111},{"_id":"themes/butterfly/source/css/_search/algolia.styl","hash":"6b05ca4409d2dc09e123af4e0af9f9d0f7142b73","modified":1610950929110},{"_id":"themes/butterfly/source/css/_tags/button.styl","hash":"a7fc7624a8d893bdf9444f14154484c29c790e99","modified":1610950929112},{"_id":"themes/butterfly/source/css/_tags/gallery.styl","hash":"53ecae272e16223a436c497abbf25dd5f0fc4aaa","modified":1610950929112},{"_id":"themes/butterfly/source/css/_tags/hexo.styl","hash":"d0386ba6d8d63afc72b9673e8f3e89df6446ffc2","modified":1610950929112},{"_id":"themes/butterfly/source/css/_tags/hide.styl","hash":"21964fdd6d74ffbea519418bab65024aee5f3736","modified":1610950929113},{"_id":"themes/butterfly/source/css/_tags/tabs.styl","hash":"1756791581c0ec51cb03353a09dac4778d944349","modified":1610950929113},{"_id":"themes/butterfly/source/css/_tags/note.styl","hash":"86fee274a62f7f034547342930f445c47378eb55","modified":1610950929113},{"_id":"themes/butterfly/source/css/_third-party/normalize.min.css","hash":"2c18a1c9604af475b4749def8f1959df88d8b276","modified":1610950929114},{"_id":"themes/butterfly/source/js/search/local-search.js","hash":"459e2541afda483916d16fce4aaa56b41bcd42ba","modified":1610950929121},{"_id":"themes/butterfly/source/js/search/algolia.js","hash":"65b45e61586f7e66c3f338370bfd9daadd71a4b7","modified":1610950929121},{"_id":"themes/butterfly/layout/includes/third-party/chat/chatra.pug","hash":"481cd5053bafb1a19f623554a27d3aa077ea59c3","modified":1610950929055},{"_id":"themes/butterfly/layout/includes/third-party/chat/daovoice.pug","hash":"cfe63e7d26a6665df6aa32ca90868ad48e05ec04","modified":1610950929056},{"_id":"themes/butterfly/layout/includes/third-party/chat/index.pug","hash":"3f05f8311ae559d768ee3d0925e84ed767c314d3","modified":1610950929057},{"_id":"themes/butterfly/layout/includes/third-party/chat/crisp.pug","hash":"76634112c64023177260d1317ae39cef2a68e35f","modified":1610950929055},{"_id":"themes/butterfly/layout/includes/third-party/chat/gitter.pug","hash":"d1d2474420bf4edc2e43ccdff6f92b8b082143df","modified":1610950929056},{"_id":"themes/butterfly/layout/includes/third-party/chat/tidio.pug","hash":"24a926756c2300b9c561aaab6bd3a71fdd16e16d","modified":1610950929058},{"_id":"themes/butterfly/layout/includes/third-party/comments/disqus.pug","hash":"f617cacf5d1e8335abba96ee1ce4b79c17411e1e","modified":1610950929059},{"_id":"themes/butterfly/layout/includes/third-party/comments/facebook_comments.pug","hash":"b579b947a87da500a4f3abbdf870fb5a6f2a5a79","modified":1610950929060},{"_id":"themes/butterfly/layout/includes/third-party/comments/disqusjs.pug","hash":"b2fb4af74d54f1daa39d4afc321d38a2a72e0ddd","modified":1610950929060},{"_id":"themes/butterfly/layout/includes/third-party/comments/gitalk.pug","hash":"99dbf2b87b372f07315a3b879a77131eaf3da066","modified":1610950929060},{"_id":"themes/butterfly/layout/includes/third-party/comments/index.pug","hash":"da9813f8dc0d388869c15413cf056012cfb69e1a","modified":1610950929060},{"_id":"themes/butterfly/layout/includes/third-party/comments/js.pug","hash":"d7ccd37cceaf4338e3e440b0dd4503765aaf4e1d","modified":1610950929061},{"_id":"themes/butterfly/layout/includes/third-party/comments/livere.pug","hash":"52ea8aa26b84d3ad38ae28cdf0f163e9ca8dced7","modified":1610950929061},{"_id":"themes/butterfly/layout/includes/third-party/comments/utterances.pug","hash":"b871ea208e36398b4d668db9a9a0b61c79415381","modified":1610950929062},{"_id":"themes/butterfly/layout/includes/third-party/comments/twikoo.pug","hash":"119c110afd331264cb6283f0078b6477d457d130","modified":1610950929061},{"_id":"themes/butterfly/layout/includes/third-party/comments/valine.pug","hash":"5b015bb6fc61d136512f78aa4e3bc3165afb9cf2","modified":1610950929062},{"_id":"themes/butterfly/layout/includes/third-party/comments/waline.pug","hash":"544fb85361c61dffc39a87e808d8bda04cfd863f","modified":1610950929062},{"_id":"themes/butterfly/layout/includes/third-party/math/index.pug","hash":"53af4ffa8119c7bbba3f066de74845be91400b5b","modified":1610950929063},{"_id":"themes/butterfly/layout/includes/third-party/math/mathjax.pug","hash":"4afc12ce42d067fa4012039aa444343a36f73599","modified":1610950929063},{"_id":"themes/butterfly/layout/includes/third-party/math/mermaid.pug","hash":"3f3a3cd8bea2103dedd754f767aca5cb84d5f586","modified":1610950929064},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/disqus-comment.pug","hash":"cdad89a0f7e5c404fd277c1469330cb0703c8079","modified":1610950929064},{"_id":"themes/butterfly/layout/includes/third-party/math/katex.pug","hash":"21b7ec96c606823d3d72e72775495ef77502b4cb","modified":1610950929063},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/github-issues.pug","hash":"b94df53a56b66afb33b2c438b946f5c5a37d5f02","modified":1610950929065},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/index.pug","hash":"18dcf05ab58107bbff426376aef2577f59583fc2","modified":1610950929065},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/valine.pug","hash":"9f4cb2f0d924a45aefa10888c50f91d29029cba4","modified":1610950929065},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/twikoo-comment.pug","hash":"dbc4e513eb0f1eed1baebe2fd438518856794c70","modified":1610950929065},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/waline.pug","hash":"7e2287dd20a0865f1ec29e6cd86c5027c1b48087","modified":1610950929066},{"_id":"themes/butterfly/layout/includes/third-party/search/algolia.pug","hash":"d8f59e94eafc669c49349561dc5bbea3915aecb7","modified":1610950929067},{"_id":"themes/butterfly/layout/includes/third-party/share/add-this.pug","hash":"2980f1889226ca981aa23b8eb1853fde26dcf89a","modified":1610950929068},{"_id":"themes/butterfly/layout/includes/third-party/search/local-search.pug","hash":"613280d61b8ab9612014ec016ae3d3698d36fd1a","modified":1610950929068},{"_id":"themes/butterfly/layout/includes/third-party/search/index.pug","hash":"da3b9437d061ee68dbc383057db5c73034c49605","modified":1610950929067},{"_id":"themes/butterfly/layout/includes/third-party/share/index.pug","hash":"c40f7d6973811e53fcfbe881174ab373b4ea03ad","modified":1610950929071},{"_id":"themes/butterfly/layout/includes/third-party/share/share-js.pug","hash":"006acc91ce25fc7c7d778ca043e970f57dc46b83","modified":1610950929071},{"_id":"themes/butterfly/layout/includes/third-party/share/addtoany.pug","hash":"309f51bc5302e72fc469d54c577fbcfe57fb07a8","modified":1610950929070},{"_id":"themes/butterfly/source/css/_highlight/highlight/diff.styl","hash":"3bcd66576d13db8f93fa5b799a973d55e060a708","modified":1610950929095},{"_id":"themes/butterfly/source/css/_highlight/highlight/index.styl","hash":"52c63a50a37fa315753e72b3661676156aeae794","modified":1610950929095},{"_id":"themes/butterfly/source/css/_highlight/prismjs/diff.styl","hash":"5972c61f5125068cbe0af279a0c93a54847fdc3b","modified":1610950929096},{"_id":"themes/butterfly/source/css/_highlight/prismjs/line-number.styl","hash":"d40f1baec16c4a62e4a3a9a0379d1ca3ac6746b2","modified":1610950929097},{"_id":"themes/butterfly/source/css/_highlight/prismjs/index.styl","hash":"897a18a82c0cad141b3ed9e2f1b4af60c24c334b","modified":1610950929096},{"_id":"source/image/gitlab-project.png","hash":"531a71bd4ae54afd8a3395d2969f53c62e9a4ed1","modified":1610005696444},{"_id":"public/about/index.html","hash":"62ab164d333758808662dc9c72a61a975561e1cd","modified":1610951400680},{"_id":"public/todos/index.html","hash":"520b6b3fe2f78dcf91c6cd5fbbcc65435bfd9559","modified":1610951400680},{"_id":"public/2021/01/15/标签体系一些坑/index.html","hash":"394cd265544fd6642c004102f16f7745fc3f24c1","modified":1610951400680},{"_id":"public/2021/01/12/标签体系级联更新、删除/index.html","hash":"03ba5b6c7a3f4c456c7c6d31cca7cb1821b96f77","modified":1610951400680},{"_id":"public/2021/01/11/flink-table-api和flink-sql/index.html","hash":"877e22847cf60d4d32d1a9294b2294ce80da1051","modified":1610951400680},{"_id":"public/2021/01/08/用户画像标签体系3/index.html","hash":"39e0d3918afff381bc5070b38de5b1b6fc4e95b9","modified":1610951400680},{"_id":"public/2021/01/08/标签体系/index.html","hash":"fec8778f0c9c89e7e3b80a9618c9aedaac2bf9ae","modified":1610951400680},{"_id":"public/2021/01/07/Git/index.html","hash":"1b8366490769ca60a80767593da8a7bfe87907ee","modified":1610951400680},{"_id":"public/2018/07/17/hello-world/index.html","hash":"f50cc4ead6f7f70c31f35bfac0874fb0d21c43ff","modified":1610951400680},{"_id":"public/categories/git/index.html","hash":"85e46ab741199b44b8ef6e4d85908ee1dcd68d1e","modified":1610951400680},{"_id":"public/categories/flink-sql/index.html","hash":"23eb498fbdc6fb84250782b964fddf4a1f861029","modified":1610951400680},{"_id":"public/categories/测试/index.html","hash":"ff6ebc68bb535ebca06c076ec76b0b093c2f7000","modified":1610951400680},{"_id":"public/categories/trident/index.html","hash":"43dd5ac97751e649a93575ae4cd0f82628ded5ae","modified":1610951400680},{"_id":"public/categories/trident-标签-画像/index.html","hash":"99d92e5a9d2a9d09dd3c5f18204357bbb1b51a58","modified":1610951400680},{"_id":"public/archives/index.html","hash":"301879820fe2561379a616a49a2064b955b6bb3c","modified":1610951400680},{"_id":"public/archives/2018/index.html","hash":"a2cf09bd267f0595d50e4422f9a28b3f67bfe3e4","modified":1610951400680},{"_id":"public/archives/2018/07/index.html","hash":"fe7f156f3a0a883539dcff30ee638a888be21810","modified":1610951400680},{"_id":"public/archives/2021/index.html","hash":"cda1b120d3b6a6fadedff0faaf74dec3b5b958e9","modified":1610951400680},{"_id":"public/archives/2021/01/index.html","hash":"3a81e06183e236e7996465744081f39ed188cd9a","modified":1610951400680},{"_id":"public/index.html","hash":"c569a6cc7ec529bd3622d9ed80c490eab29893a1","modified":1610951400680},{"_id":"public/tags/git/index.html","hash":"f95a03ad31466bca0c8c09dc2f9117a3e2cf527d","modified":1610951400680},{"_id":"public/tags/flink-sql/index.html","hash":"0b438c9009a9cc3bb6f4b2ef022b79e3e61086d7","modified":1610951400680},{"_id":"public/tags/hexo-demo/index.html","hash":"c3a0b6887906ae416de94e9a1928ea42c8302521","modified":1610951400680},{"_id":"public/tags/trident/index.html","hash":"11437984a4816ef9aaac6b771e14de2fcd93bde3","modified":1610951400680},{"_id":"public/tags/trident-标签-画像/index.html","hash":"864332d4ad368a5c6745057b28e7d3261bb8eba5","modified":1610951400680},{"_id":"public/img/404.jpg","hash":"fb4489bc1d30c93d28f7332158c1c6c1416148de","modified":1610951400680},{"_id":"public/img/algolia.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1610951400680},{"_id":"public/img/favicon.png","hash":"3cf89864b4f6c9b532522a4d260a2e887971c92d","modified":1610951400680},{"_id":"public/image/image-20210106101222963.png","hash":"808fab05a90f07518375de870a36265a7e66dc75","modified":1610951400680},{"_id":"public/image/image-20210106144024660.png","hash":"073bee7a6cfc9ccf373271480f51db5becc88eb6","modified":1610951400680},{"_id":"public/image/用户画像标签体系1-1610100479337.png","hash":"8cbc399d4c28ebece418f0f359394d4f4f941ba1","modified":1610951400680},{"_id":"public/image/用户画像标签体系1-1610100559561.png","hash":"dd04a94847fe153ae563a64d581ea3b04b6b46e7","modified":1610951400680},{"_id":"public/image/用户画像标签体系1-1610100569781.png","hash":"cb5b153a32ead91c2ff4037d0c4d3b36aed62fc7","modified":1610951400680},{"_id":"public/image/用户画像标签体系1-1610100589257.png","hash":"b8ee067def63a63977590a5da805974006d4ed47","modified":1610951400680},{"_id":"public/img/loading.gif","hash":"5f0287fb8fb98872fe1998c6f781111819e71806","modified":1610951400680},{"_id":"public/img/friend_404.gif","hash":"8d2d0ebef70a8eb07329f57e645889b0e420fa48","modified":1610951400680},{"_id":"public/image/用户画像标签体系1-1610100518466.png","hash":"7e69c497ff32d012aa990f99bee18367fdf84d4f","modified":1610951400680},{"_id":"public/image/用户画像标签体系1-1610100632944.png","hash":"ee326e3828b9596a97bfd979dce7c9e0e077ae94","modified":1610951400680},{"_id":"public/image/用户画像标签体系1-1610100608905.png","hash":"fd8f4784df5404578088aa258c60e882c0908b5c","modified":1610951400680},{"_id":"public/image/用户画像标签体系1-1610100447523.png","hash":"542f7fec23dfd3ca4e2b770358c15d9a84856e82","modified":1610951400680},{"_id":"public/image/用户画像标签体系1-1610100346329.png","hash":"81096486f7ae6e8370c0e05df0a361d964859afa","modified":1610951400680},{"_id":"public/css/var.css","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1610951400680},{"_id":"public/js/utils.js","hash":"41481019ef510c74e744f4f7ec4d0a13b5ccc04c","modified":1610951400680},{"_id":"public/js/search/local-search.js","hash":"459e2541afda483916d16fce4aaa56b41bcd42ba","modified":1610951400680},{"_id":"public/js/search/algolia.js","hash":"65b45e61586f7e66c3f338370bfd9daadd71a4b7","modified":1610951400680},{"_id":"public/css/index.css","hash":"5ca0444c7d2fd40e8ac8078f147d687257ba681e","modified":1610951400680},{"_id":"public/js/tw_cn.js","hash":"00053ce73210274b3679f42607edef1206eebc68","modified":1610951400680},{"_id":"public/js/main.js","hash":"4e526092321b8c4e93837e716ef4f587ffff9a60","modified":1610951400680},{"_id":"public/image/用户画像标签体系1-1610100155452.png","hash":"781e1b0dc1e84d48318ea01f1e779cdaa22e5052","modified":1610951400680},{"_id":"public/image/用户画像标签体系1-1610100324696.png","hash":"ae16a2fac8c1952f454583b969ddda9fccac9aa3","modified":1610951400680},{"_id":"public/image/gitlab-project.png","hash":"531a71bd4ae54afd8a3395d2969f53c62e9a4ed1","modified":1610951400680}],"Category":[{"name":"git","_id":"ckk26vf2p0004w5ha7h0mef21"},{"name":"flink sql","_id":"ckk26vf380009w5ha54rcftmr"},{"name":"测试","_id":"ckk26vf3s000fw5hafpmuhe5h"},{"name":"trident","_id":"ckk26vf3v000jw5hah5wnew8v"},{"name":"trident 标签 画像","_id":"ckk26vf49000uw5ha8r47fcs1"}],"Data":[],"Page":[{"title":"关于我","date":"2021-01-07T05:31:06.000Z","tag":"about","_content":"\n老程序员了\n\n技术不怎么行都那种\n\n偶尔听听陈绮贞的歌，向往诗和远方\n\n何时能财富自由，去体验诗和远方啊~~~~","source":"about/index.md","raw":"---\ntitle: 关于我\ndate: 2021-01-07 13:31:06\ntag: about\n---\n\n老程序员了\n\n技术不怎么行都那种\n\n偶尔听听陈绮贞的歌，向往诗和远方\n\n何时能财富自由，去体验诗和远方啊~~~~","updated":"2021-01-18T06:03:49.792Z","path":"about/index.html","comments":1,"layout":"page","_id":"ckk26vf1w0000w5habmb9huaq","content":"<p>老程序员了</p>\n<p>技术不怎么行都那种</p>\n<p>偶尔听听陈绮贞的歌，向往诗和远方</p>\n<p>何时能财富自由，去体验诗和远方啊~~~~</p>\n","site":{"data":{}},"cover":"https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg","excerpt":"","more":"<p>老程序员了</p>\n<p>技术不怎么行都那种</p>\n<p>偶尔听听陈绮贞的歌，向往诗和远方</p>\n<p>何时能财富自由，去体验诗和远方啊~~~~</p>\n"},{"title":"TODO","tag":"TODO","date":"2021-01-18T04:06:48.000Z","updated":"2021-01-18T04:06:48.000Z","_content":"# 2021-01-18\n- [ ] 标签体系联动物料表更新、删除\n- [ ] 熟悉海纳、工场源码，架构","source":"todos/index.md","raw":"---\ntitle: TODO\ntag: TODO\ndate: 2021-01-18 12:06:48\nupdated: 2021-01-18 12:06:48\n---\n# 2021-01-18\n- [ ] 标签体系联动物料表更新、删除\n- [ ] 熟悉海纳、工场源码，架构","path":"todos/index.html","comments":1,"layout":"page","_id":"ckk26vf2k0002w5hab08gd8mg","content":"<h1 id=\"2021-01-18\"><a href=\"#2021-01-18\" class=\"headerlink\" title=\"2021-01-18\"></a>2021-01-18</h1><ul>\n<li><input disabled=\"\" type=\"checkbox\"> 标签体系联动物料表更新、删除</li>\n<li><input disabled=\"\" type=\"checkbox\"> 熟悉海纳、工场源码，架构</li>\n</ul>\n","site":{"data":{}},"cover":"https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg","excerpt":"","more":"<h1 id=\"2021-01-18\"><a href=\"#2021-01-18\" class=\"headerlink\" title=\"2021-01-18\"></a>2021-01-18</h1><ul>\n<li><input disabled=\"\" type=\"checkbox\"> 标签体系联动物料表更新、删除</li>\n<li><input disabled=\"\" type=\"checkbox\"> 熟悉海纳、工场源码，架构</li>\n</ul>\n"}],"Post":[{"title":"Git","date":"2021-01-07T07:28:10.000Z","updated":"2021-01-08T02:21:10.000Z","_content":"# Git\n\n## 合并分支、打tag\n\n参考 [https://wiki.datastory.com.cn/pages/viewpage.action?pageId=38618481#id-%E5%B7%A5%E5%9C%BA%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91README-4.3%E5%8F%91%E5%B8%83&%E6%89%93tag](https://wiki.datastory.com.cn/pages/viewpage.action?pageId=38618481#id-工场后端开发README-4.3发布&打tag)\n\n### 合并分支操作：（以合并dev到master为例子）\n\na. 切换到master分支 git checkout master\n\nb. 合并代码 git merge dev\n\nc. 推到远程 git push\n\n\n### 发布前\n\n\ndev提交pr到master --> idea 下载 gitlab project插件，然后配置下gitlab的服务器 \n\n![gitlab](/image/gitlab-project.png)\n\nreview 然后合并到master\n\n修改版本号 mvn versions:set -DnewVersion=1.4.2.0-SNAPSHOT -DgenerateBackupPoms=false 并提交\n\n发布系统打tag\n\n### 完成后重新rebase\n","source":"_posts/Git.md","raw":"---\ntitle: Git\ndate: 2021-01-07 15:28:10\nupdated: 2021-01-08 10:21:10\ntags: git\ncategories: git # 目录\n---\n# Git\n\n## 合并分支、打tag\n\n参考 [https://wiki.datastory.com.cn/pages/viewpage.action?pageId=38618481#id-%E5%B7%A5%E5%9C%BA%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91README-4.3%E5%8F%91%E5%B8%83&%E6%89%93tag](https://wiki.datastory.com.cn/pages/viewpage.action?pageId=38618481#id-工场后端开发README-4.3发布&打tag)\n\n### 合并分支操作：（以合并dev到master为例子）\n\na. 切换到master分支 git checkout master\n\nb. 合并代码 git merge dev\n\nc. 推到远程 git push\n\n\n### 发布前\n\n\ndev提交pr到master --> idea 下载 gitlab project插件，然后配置下gitlab的服务器 \n\n![gitlab](/image/gitlab-project.png)\n\nreview 然后合并到master\n\n修改版本号 mvn versions:set -DnewVersion=1.4.2.0-SNAPSHOT -DgenerateBackupPoms=false 并提交\n\n发布系统打tag\n\n### 完成后重新rebase\n","slug":"Git","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"ckk26vf260001w5ha8ikmg4w2","content":"<h1 id=\"Git\"><a href=\"#Git\" class=\"headerlink\" title=\"Git\"></a>Git</h1><h2 id=\"合并分支、打tag\"><a href=\"#合并分支、打tag\" class=\"headerlink\" title=\"合并分支、打tag\"></a>合并分支、打tag</h2><p>参考 <a href=\"https://wiki.datastory.com.cn/pages/viewpage.action?pageId=38618481#id-%E5%B7%A5%E5%9C%BA%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91README-4.3%E5%8F%91%E5%B8%83&%E6%89%93tag\">https://wiki.datastory.com.cn/pages/viewpage.action?pageId=38618481#id-%E5%B7%A5%E5%9C%BA%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91README-4.3%E5%8F%91%E5%B8%83&amp;%E6%89%93tag</a></p>\n<h3 id=\"合并分支操作：（以合并dev到master为例子）\"><a href=\"#合并分支操作：（以合并dev到master为例子）\" class=\"headerlink\" title=\"合并分支操作：（以合并dev到master为例子）\"></a>合并分支操作：（以合并dev到master为例子）</h3><p>a. 切换到master分支 git checkout master</p>\n<p>b. 合并代码 git merge dev</p>\n<p>c. 推到远程 git push</p>\n<h3 id=\"发布前\"><a href=\"#发布前\" class=\"headerlink\" title=\"发布前\"></a>发布前</h3><p>dev提交pr到master –&gt; idea 下载 gitlab project插件，然后配置下gitlab的服务器 </p>\n<p><img src=\"/image/gitlab-project.png\" alt=\"gitlab\"></p>\n<p>review 然后合并到master</p>\n<p>修改版本号 mvn versions:set -DnewVersion=1.4.2.0-SNAPSHOT -DgenerateBackupPoms=false 并提交</p>\n<p>发布系统打tag</p>\n<h3 id=\"完成后重新rebase\"><a href=\"#完成后重新rebase\" class=\"headerlink\" title=\"完成后重新rebase\"></a>完成后重新rebase</h3>","site":{"data":{}},"cover":"https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg","excerpt":"","more":"<h1 id=\"Git\"><a href=\"#Git\" class=\"headerlink\" title=\"Git\"></a>Git</h1><h2 id=\"合并分支、打tag\"><a href=\"#合并分支、打tag\" class=\"headerlink\" title=\"合并分支、打tag\"></a>合并分支、打tag</h2><p>参考 <a href=\"https://wiki.datastory.com.cn/pages/viewpage.action?pageId=38618481#id-%E5%B7%A5%E5%9C%BA%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91README-4.3%E5%8F%91%E5%B8%83&%E6%89%93tag\">https://wiki.datastory.com.cn/pages/viewpage.action?pageId=38618481#id-%E5%B7%A5%E5%9C%BA%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91README-4.3%E5%8F%91%E5%B8%83&amp;%E6%89%93tag</a></p>\n<h3 id=\"合并分支操作：（以合并dev到master为例子）\"><a href=\"#合并分支操作：（以合并dev到master为例子）\" class=\"headerlink\" title=\"合并分支操作：（以合并dev到master为例子）\"></a>合并分支操作：（以合并dev到master为例子）</h3><p>a. 切换到master分支 git checkout master</p>\n<p>b. 合并代码 git merge dev</p>\n<p>c. 推到远程 git push</p>\n<h3 id=\"发布前\"><a href=\"#发布前\" class=\"headerlink\" title=\"发布前\"></a>发布前</h3><p>dev提交pr到master –&gt; idea 下载 gitlab project插件，然后配置下gitlab的服务器 </p>\n<p><img src=\"/image/gitlab-project.png\" alt=\"gitlab\"></p>\n<p>review 然后合并到master</p>\n<p>修改版本号 mvn versions:set -DnewVersion=1.4.2.0-SNAPSHOT -DgenerateBackupPoms=false 并提交</p>\n<p>发布系统打tag</p>\n<h3 id=\"完成后重新rebase\"><a href=\"#完成后重新rebase\" class=\"headerlink\" title=\"完成后重新rebase\"></a>完成后重新rebase</h3>"},{"title":"flink table api和flink sql","overdue":false,"date":"2021-01-11T06:58:04.000Z","updated":"2021-01-11T06:58:04.000Z","_content":"# 表（Table）\n+ tableEnvironment可以注册目录Catalog，并可以基于Catalog注册表\n+ 表（Table）是有一个\"标识符\"（identifier）来指定，由3部分组成：Catalog名，数据库（database）名和对象名\n+ 表可以是常规的，也可以是虚拟的（视图，view）\n+ 常规表（Table）一般可以用来描述外部数据，比如文件、数据库表或消息队列的数据，也可以直接从DataStream转换而来\n+ 视图（view）可以从现有表中创建，通常是table API 或者SQL查询的一个结果集\n\n## 创建表\n```scala\ntableEnv\n    .connect(...)       // 定义表的数据来源\n    .withFormat(...)    // 定义数据格式化方法\n    .withSchema(...)    // 定义表结构\n    .createTemporaryTable(\"myTable\"); // 创建临时表（在catalog中注册表）\n```\n","source":"_posts/flink-table-api和flink-sql.md","raw":"---\ntitle: flink table api和flink sql\ntags: flink sql\noverdue: false\ncategories: flink sql\ndate: 2021-01-11 14:58:04\nupdated: 2021-01-11 14:58:04\n---\n# 表（Table）\n+ tableEnvironment可以注册目录Catalog，并可以基于Catalog注册表\n+ 表（Table）是有一个\"标识符\"（identifier）来指定，由3部分组成：Catalog名，数据库（database）名和对象名\n+ 表可以是常规的，也可以是虚拟的（视图，view）\n+ 常规表（Table）一般可以用来描述外部数据，比如文件、数据库表或消息队列的数据，也可以直接从DataStream转换而来\n+ 视图（view）可以从现有表中创建，通常是table API 或者SQL查询的一个结果集\n\n## 创建表\n```scala\ntableEnv\n    .connect(...)       // 定义表的数据来源\n    .withFormat(...)    // 定义数据格式化方法\n    .withSchema(...)    // 定义表结构\n    .createTemporaryTable(\"myTable\"); // 创建临时表（在catalog中注册表）\n```\n","slug":"flink-table-api和flink-sql","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"ckk26vf2l0003w5ha3ppuddlq","content":"<h1 id=\"表（Table）\"><a href=\"#表（Table）\" class=\"headerlink\" title=\"表（Table）\"></a>表（Table）</h1><ul>\n<li>tableEnvironment可以注册目录Catalog，并可以基于Catalog注册表</li>\n<li>表（Table）是有一个”标识符”（identifier）来指定，由3部分组成：Catalog名，数据库（database）名和对象名</li>\n<li>表可以是常规的，也可以是虚拟的（视图，view）</li>\n<li>常规表（Table）一般可以用来描述外部数据，比如文件、数据库表或消息队列的数据，也可以直接从DataStream转换而来</li>\n<li>视图（view）可以从现有表中创建，通常是table API 或者SQL查询的一个结果集</li>\n</ul>\n<h2 id=\"创建表\"><a href=\"#创建表\" class=\"headerlink\" title=\"创建表\"></a>创建表</h2><figure class=\"highlight scala\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tableEnv</span><br><span class=\"line\">    .connect(...)       <span class=\"comment\">// 定义表的数据来源</span></span><br><span class=\"line\">    .withFormat(...)    <span class=\"comment\">// 定义数据格式化方法</span></span><br><span class=\"line\">    .withSchema(...)    <span class=\"comment\">// 定义表结构</span></span><br><span class=\"line\">    .createTemporaryTable(<span class=\"string\">&quot;myTable&quot;</span>); <span class=\"comment\">// 创建临时表（在catalog中注册表）</span></span><br></pre></td></tr></table></figure>","site":{"data":{}},"cover":"https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg","excerpt":"","more":"<h1 id=\"表（Table）\"><a href=\"#表（Table）\" class=\"headerlink\" title=\"表（Table）\"></a>表（Table）</h1><ul>\n<li>tableEnvironment可以注册目录Catalog，并可以基于Catalog注册表</li>\n<li>表（Table）是有一个”标识符”（identifier）来指定，由3部分组成：Catalog名，数据库（database）名和对象名</li>\n<li>表可以是常规的，也可以是虚拟的（视图，view）</li>\n<li>常规表（Table）一般可以用来描述外部数据，比如文件、数据库表或消息队列的数据，也可以直接从DataStream转换而来</li>\n<li>视图（view）可以从现有表中创建，通常是table API 或者SQL查询的一个结果集</li>\n</ul>\n<h2 id=\"创建表\"><a href=\"#创建表\" class=\"headerlink\" title=\"创建表\"></a>创建表</h2><figure class=\"highlight scala\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tableEnv</span><br><span class=\"line\">    .connect(...)       <span class=\"comment\">// 定义表的数据来源</span></span><br><span class=\"line\">    .withFormat(...)    <span class=\"comment\">// 定义数据格式化方法</span></span><br><span class=\"line\">    .withSchema(...)    <span class=\"comment\">// 定义表结构</span></span><br><span class=\"line\">    .createTemporaryTable(<span class=\"string\">&quot;myTable&quot;</span>); <span class=\"comment\">// 创建临时表（在catalog中注册表）</span></span><br></pre></td></tr></table></figure>"},{"title":"hello world","date":"2018-07-17T04:33:59.000Z","updated":"2021-01-08T04:33:59.000Z","overdue":true,"_content":"\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n\n### 流程图\n```flow\nst=>start: Start|past:>http://www.google.com[blank]\ne=>end: End:>http://www.google.com\nop1=>operation: My Operation|past\nop2=>operation: Stuff|current\nsub1=>subroutine: My Subroutine|invalid\ncond=>condition: Yes\nor No?|approved:>http://www.google.com\nc2=>condition: Good idea|rejected\nio=>inputoutput: catch something...|request\n\nst->op1(right)->cond\ncond(yes, right)->c2\ncond(no)->sub1(left)->op1\nc2(yes)->io->e\nc2(no)->op2->e\n```\n\n\n### class disagram\n```mermaid\nclassDiagram\n    Class01 <|-- AveryLongClass : Cool\n    Class03 *-- Class04\n    Class05 o-- Class06\n    Class07 .. Class08\n    Class09 --> C2 : Where am i?\n    Class09 --* C3\n    Class09 --|> Class07\n    Class07 : equals()\n    Class07 : Object[] elementData\n    Class01 : size()\n    Class01 : int chimp\n    Class01 : int gorilla\n    Class08 <--> C2: Cool label\n```\n\n### sequence\n```mermaid\nsequenceDiagram\n    participant Alice\n    participant Bob\n    Alice->>John: Hello John, how are you?\n    loop Healthcheck\n        John->>John: Fight against hypochondria\n    end\n    Note right of John: Rational thoughts <br/>prevail...\n    John-->>Alice: Great!\n    John->>Bob: How about you?\n    Bob-->>John: Jolly good!\n```\n### gantt\n\n```mermaid\ngantt\n    dateFormat  YYYY-MM-DD\n    title Adding GANTT diagram to mermaid\n    \n    section A section\n    Completed task            :done,    des1, 2014-01-06,2014-01-08\n    Active task               :active,  des2, 2014-01-09, 3d\n    Future task               :         des3, after des2, 5d\n    Future task2               :         des4, after des3, 5d\n```\n\n### mermaid diagrams\n```mermaid\ngraph TD;\n    A[test]\n    B[hello]\n    D-->G\n    A-->B\n    A-->C\n    B-->D\n    C-->D\n\tsubgraph test\n\tE-->G\n\tend\n```\n### graph TD\n\n```mermaid\ngraph TD;\n\trunJob-->ostart\n\tostart-->jstart\n\tprocessRuleUpdatedLabel--是-->cleanStart\n\tsubgraph all\n\tstart[开始]-->edit[修改标签]\n\tedit--执行标签任务-->redis[提交到redis的allJob队列]\n\tredis--JobAcceptor#parseMessage-->runJob[执行标签 调用海纳]\n\tend\n\n\tsubgraph ocean[海纳任务]\n\tostart[海纳task]-->oend[海纳任务执行完成]\n\tend\n\n\tsubgraph JobTracker\n\tjstart[从redis的scheduler:running获取运行中的任务]-->isJobEnd{任务是否到达终态}\n\tisJobEnd--是-->updateLabelCoverage[更新标签覆盖数]-->processRuleUpdatedLabel{判断规则是否改过}\n\tupdateLabelCoverage-->processOneTimeLabelStatus[一次性标签需要修改oneTimeStatus状态位为已执行]-->removeFromRedisSet[从redis的running中删除]-->oend\n\tisJobEnd--否-->jstart\n\tend\n\n\tsubgraph ofCleanOldRuleJob[清理修改过规则后的过期标签]\n\tcleanStart-->cleanEnd\n\tend\n```","source":"_posts/hello-world.md","raw":"---\ntitle: hello world\ndate: 2018-07-17 12:33:59\nupdated: 2021-01-08 12:33:59\ntags: hexo demo # 好像没用\noverdue: true #这一行\ncategories: 测试 # 目录\n---\n\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n\n### 流程图\n```flow\nst=>start: Start|past:>http://www.google.com[blank]\ne=>end: End:>http://www.google.com\nop1=>operation: My Operation|past\nop2=>operation: Stuff|current\nsub1=>subroutine: My Subroutine|invalid\ncond=>condition: Yes\nor No?|approved:>http://www.google.com\nc2=>condition: Good idea|rejected\nio=>inputoutput: catch something...|request\n\nst->op1(right)->cond\ncond(yes, right)->c2\ncond(no)->sub1(left)->op1\nc2(yes)->io->e\nc2(no)->op2->e\n```\n\n\n### class disagram\n```mermaid\nclassDiagram\n    Class01 <|-- AveryLongClass : Cool\n    Class03 *-- Class04\n    Class05 o-- Class06\n    Class07 .. Class08\n    Class09 --> C2 : Where am i?\n    Class09 --* C3\n    Class09 --|> Class07\n    Class07 : equals()\n    Class07 : Object[] elementData\n    Class01 : size()\n    Class01 : int chimp\n    Class01 : int gorilla\n    Class08 <--> C2: Cool label\n```\n\n### sequence\n```mermaid\nsequenceDiagram\n    participant Alice\n    participant Bob\n    Alice->>John: Hello John, how are you?\n    loop Healthcheck\n        John->>John: Fight against hypochondria\n    end\n    Note right of John: Rational thoughts <br/>prevail...\n    John-->>Alice: Great!\n    John->>Bob: How about you?\n    Bob-->>John: Jolly good!\n```\n### gantt\n\n```mermaid\ngantt\n    dateFormat  YYYY-MM-DD\n    title Adding GANTT diagram to mermaid\n    \n    section A section\n    Completed task            :done,    des1, 2014-01-06,2014-01-08\n    Active task               :active,  des2, 2014-01-09, 3d\n    Future task               :         des3, after des2, 5d\n    Future task2               :         des4, after des3, 5d\n```\n\n### mermaid diagrams\n```mermaid\ngraph TD;\n    A[test]\n    B[hello]\n    D-->G\n    A-->B\n    A-->C\n    B-->D\n    C-->D\n\tsubgraph test\n\tE-->G\n\tend\n```\n### graph TD\n\n```mermaid\ngraph TD;\n\trunJob-->ostart\n\tostart-->jstart\n\tprocessRuleUpdatedLabel--是-->cleanStart\n\tsubgraph all\n\tstart[开始]-->edit[修改标签]\n\tedit--执行标签任务-->redis[提交到redis的allJob队列]\n\tredis--JobAcceptor#parseMessage-->runJob[执行标签 调用海纳]\n\tend\n\n\tsubgraph ocean[海纳任务]\n\tostart[海纳task]-->oend[海纳任务执行完成]\n\tend\n\n\tsubgraph JobTracker\n\tjstart[从redis的scheduler:running获取运行中的任务]-->isJobEnd{任务是否到达终态}\n\tisJobEnd--是-->updateLabelCoverage[更新标签覆盖数]-->processRuleUpdatedLabel{判断规则是否改过}\n\tupdateLabelCoverage-->processOneTimeLabelStatus[一次性标签需要修改oneTimeStatus状态位为已执行]-->removeFromRedisSet[从redis的running中删除]-->oend\n\tisJobEnd--否-->jstart\n\tend\n\n\tsubgraph ofCleanOldRuleJob[清理修改过规则后的过期标签]\n\tcleanStart-->cleanEnd\n\tend\n```","slug":"hello-world","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"ckk26vf2t0006w5ha6erlff0a","content":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n<h3 id=\"流程图\"><a href=\"#流程图\" class=\"headerlink\" title=\"流程图\"></a>流程图</h3><div id=\"flowchart-0\" class=\"flow-chart\"></div>\n\n\n<h3 id=\"class-disagram\"><a href=\"#class-disagram\" class=\"headerlink\" title=\"class disagram\"></a>class disagram</h3><pre class=\"mermaid\">classDiagram\n    Class01 <|-- AveryLongClass : Cool\n    Class03 *-- Class04\n    Class05 o-- Class06\n    Class07 .. Class08\n    Class09 --> C2 : Where am i?\n    Class09 --* C3\n    Class09 --|> Class07\n    Class07 : equals()\n    Class07 : Object[] elementData\n    Class01 : size()\n    Class01 : int chimp\n    Class01 : int gorilla\n    Class08 <--> C2: Cool label</pre>\n\n<h3 id=\"sequence\"><a href=\"#sequence\" class=\"headerlink\" title=\"sequence\"></a>sequence</h3><pre class=\"mermaid\">sequenceDiagram\n    participant Alice\n    participant Bob\n    Alice->>John: Hello John, how are you?\n    loop Healthcheck\n        John->>John: Fight against hypochondria\n    end\n    Note right of John: Rational thoughts <br/>prevail...\n    John-->>Alice: Great!\n    John->>Bob: How about you?\n    Bob-->>John: Jolly good!</pre>\n<h3 id=\"gantt\"><a href=\"#gantt\" class=\"headerlink\" title=\"gantt\"></a>gantt</h3><pre class=\"mermaid\">gantt\n    dateFormat  YYYY-MM-DD\n    title Adding GANTT diagram to mermaid\n\n    section A section\n    Completed task            :done,    des1, 2014-01-06,2014-01-08\n    Active task               :active,  des2, 2014-01-09, 3d\n    Future task               :         des3, after des2, 5d\n    Future task2               :         des4, after des3, 5d</pre>\n\n<h3 id=\"mermaid-diagrams\"><a href=\"#mermaid-diagrams\" class=\"headerlink\" title=\"mermaid diagrams\"></a>mermaid diagrams</h3><pre class=\"mermaid\">graph TD;\n    A[test]\n    B[hello]\n    D-->G\n    A-->B\n    A-->C\n    B-->D\n    C-->D\n    subgraph test\n    E-->G\n    end</pre>\n<h3 id=\"graph-TD\"><a href=\"#graph-TD\" class=\"headerlink\" title=\"graph TD\"></a>graph TD</h3><pre class=\"mermaid\">graph TD;\n    runJob-->ostart\n    ostart-->jstart\n    processRuleUpdatedLabel--是-->cleanStart\n    subgraph all\n    start[开始]-->edit[修改标签]\n    edit--执行标签任务-->redis[提交到redis的allJob队列]\n    redis--JobAcceptor#parseMessage-->runJob[执行标签 调用海纳]\n    end\n\n    subgraph ocean[海纳任务]\n    ostart[海纳task]-->oend[海纳任务执行完成]\n    end\n\n    subgraph JobTracker\n    jstart[从redis的scheduler:running获取运行中的任务]-->isJobEnd{任务是否到达终态}\n    isJobEnd--是-->updateLabelCoverage[更新标签覆盖数]-->processRuleUpdatedLabel{判断规则是否改过}\n    updateLabelCoverage-->processOneTimeLabelStatus[一次性标签需要修改oneTimeStatus状态位为已执行]-->removeFromRedisSet[从redis的running中删除]-->oend\n    isJobEnd--否-->jstart\n    end\n\n    subgraph ofCleanOldRuleJob[清理修改过规则后的过期标签]\n    cleanStart-->cleanEnd\n    end</pre><script src=\"https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js\"></script><script src=\"https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js\"></script><textarea id=\"flowchart-0-code\" style=\"display: none\">st=>start: Start|past:>http://www.google.com[blank]\ne=>end: End:>http://www.google.com\nop1=>operation: My Operation|past\nop2=>operation: Stuff|current\nsub1=>subroutine: My Subroutine|invalid\ncond=>condition: Yes\nor No?|approved:>http://www.google.com\nc2=>condition: Good idea|rejected\nio=>inputoutput: catch something...|request\n\nst->op1(right)->cond\ncond(yes, right)->c2\ncond(no)->sub1(left)->op1\nc2(yes)->io->e\nc2(no)->op2->e</textarea><textarea id=\"flowchart-0-options\" style=\"display: none\">{\"scale\":1,\"line-width\":2,\"line-length\":50,\"text-margin\":10,\"font-size\":12}</textarea><script>  var code = document.getElementById(\"flowchart-0-code\").value;  var options = JSON.parse(decodeURIComponent(document.getElementById(\"flowchart-0-options\").value));  var diagram = flowchart.parse(code);  diagram.drawSVG(\"flowchart-0\", options);</script>","site":{"data":{}},"cover":"https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg","excerpt":"","more":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n<h3 id=\"流程图\"><a href=\"#流程图\" class=\"headerlink\" title=\"流程图\"></a>流程图</h3><div id=\"flowchart-0\" class=\"flow-chart\"></div>\n\n\n<h3 id=\"class-disagram\"><a href=\"#class-disagram\" class=\"headerlink\" title=\"class disagram\"></a>class disagram</h3><pre class=\"mermaid\">classDiagram\n    Class01 <|-- AveryLongClass : Cool\n    Class03 *-- Class04\n    Class05 o-- Class06\n    Class07 .. Class08\n    Class09 --> C2 : Where am i?\n    Class09 --* C3\n    Class09 --|> Class07\n    Class07 : equals()\n    Class07 : Object[] elementData\n    Class01 : size()\n    Class01 : int chimp\n    Class01 : int gorilla\n    Class08 <--> C2: Cool label</pre>\n\n<h3 id=\"sequence\"><a href=\"#sequence\" class=\"headerlink\" title=\"sequence\"></a>sequence</h3><pre class=\"mermaid\">sequenceDiagram\n    participant Alice\n    participant Bob\n    Alice->>John: Hello John, how are you?\n    loop Healthcheck\n        John->>John: Fight against hypochondria\n    end\n    Note right of John: Rational thoughts <br/>prevail...\n    John-->>Alice: Great!\n    John->>Bob: How about you?\n    Bob-->>John: Jolly good!</pre>\n<h3 id=\"gantt\"><a href=\"#gantt\" class=\"headerlink\" title=\"gantt\"></a>gantt</h3><pre class=\"mermaid\">gantt\n    dateFormat  YYYY-MM-DD\n    title Adding GANTT diagram to mermaid\n\n    section A section\n    Completed task            :done,    des1, 2014-01-06,2014-01-08\n    Active task               :active,  des2, 2014-01-09, 3d\n    Future task               :         des3, after des2, 5d\n    Future task2               :         des4, after des3, 5d</pre>\n\n<h3 id=\"mermaid-diagrams\"><a href=\"#mermaid-diagrams\" class=\"headerlink\" title=\"mermaid diagrams\"></a>mermaid diagrams</h3><pre class=\"mermaid\">graph TD;\n    A[test]\n    B[hello]\n    D-->G\n    A-->B\n    A-->C\n    B-->D\n    C-->D\n    subgraph test\n    E-->G\n    end</pre>\n<h3 id=\"graph-TD\"><a href=\"#graph-TD\" class=\"headerlink\" title=\"graph TD\"></a>graph TD</h3><pre class=\"mermaid\">graph TD;\n    runJob-->ostart\n    ostart-->jstart\n    processRuleUpdatedLabel--是-->cleanStart\n    subgraph all\n    start[开始]-->edit[修改标签]\n    edit--执行标签任务-->redis[提交到redis的allJob队列]\n    redis--JobAcceptor#parseMessage-->runJob[执行标签 调用海纳]\n    end\n\n    subgraph ocean[海纳任务]\n    ostart[海纳task]-->oend[海纳任务执行完成]\n    end\n\n    subgraph JobTracker\n    jstart[从redis的scheduler:running获取运行中的任务]-->isJobEnd{任务是否到达终态}\n    isJobEnd--是-->updateLabelCoverage[更新标签覆盖数]-->processRuleUpdatedLabel{判断规则是否改过}\n    updateLabelCoverage-->processOneTimeLabelStatus[一次性标签需要修改oneTimeStatus状态位为已执行]-->removeFromRedisSet[从redis的running中删除]-->oend\n    isJobEnd--否-->jstart\n    end\n\n    subgraph ofCleanOldRuleJob[清理修改过规则后的过期标签]\n    cleanStart-->cleanEnd\n    end</pre><script src=\"https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js\"></script><script src=\"https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js\"></script><textarea id=\"flowchart-0-code\" style=\"display: none\">st=>start: Start|past:>http://www.google.com[blank]\ne=>end: End:>http://www.google.com\nop1=>operation: My Operation|past\nop2=>operation: Stuff|current\nsub1=>subroutine: My Subroutine|invalid\ncond=>condition: Yes\nor No?|approved:>http://www.google.com\nc2=>condition: Good idea|rejected\nio=>inputoutput: catch something...|request\n\nst->op1(right)->cond\ncond(yes, right)->c2\ncond(no)->sub1(left)->op1\nc2(yes)->io->e\nc2(no)->op2->e</textarea><textarea id=\"flowchart-0-options\" style=\"display: none\">{\"scale\":1,\"line-width\":2,\"line-length\":50,\"text-margin\":10,\"font-size\":12}</textarea><script>  var code = document.getElementById(\"flowchart-0-code\").value;  var options = JSON.parse(decodeURIComponent(document.getElementById(\"flowchart-0-options\").value));  var diagram = flowchart.parse(code);  diagram.drawSVG(\"flowchart-0\", options);</script>"},{"title":"标签体系","date":"2021-01-08T04:33:59.000Z","overdue":true,"_content":"\n## 周期性标签运行\n\n### 获取需要执行的标签\n\nCronJobLauncher。10s扫描一次\n\n```sql\nSELECT i.id,\n       i.label_unique_id,\n       i.label_name,\n       i.label_type,\n       i.demand,\n       i.rule_descriptor,\n       i.rule_hash,\n       i.dsl_config,\n       i.execute_config,\n       i.next_run_time,\n       i.rule_recent_updated,\n       i.expire_type,\n       i.expire_value,\n       i.es_type,\n       t.cron_config AS tree_cron_config,\n       IFNULL(i.cron_config,t.cron_config) AS cron_config,\n       t.tree_type_id AS tree_type,\n       i.tree_id,\n       i.root_label_id,\n       i.parent_label_id,\n       i.depth,\n       i.acc_id,\n       i.emails,\n       i.del_flag,\n       i.create_time,\n       i.update_time,\n       i.label_count,\n       i.one_time_status\nFROM t_trident_label_info i\nLEFT JOIN t_trident_label_tree t ON t.tree_id = i.tree_id\nWHERE i.del_flag = 0\n  AND i.execute_config IS NOT NULL\n  AND i.dsl_config IS NOT NULL\n  AND (i.next_run_time > '1970-01-01 08:00:00'\n       AND i.next_run_time <= NOW())\n  AND i.one_time_status <> 2\n```\n\n桉树id分组\n\n遍历每个分组，如果分组下的标签执行周期 != 树的执行周期，ofSpecialCronJob 立即提交任务（fusion）\n\n否则合并多个标签任务id，ofNormalCronJob 提交任务（merged，waitForBatch=true） \n\n遍历完成后，更新下次执行时间（nextRunTime）\n\n以上任务提交后都先放在redis的```ds:trident:mq:allJob```​队列中\n\n\n\n运行中的任务在 redis的 ```ds:trident:scheduler:running```中\n\n![image-20210106101222963](/image/image-20210106101222963.png)\n\n### 任务分发\n\nJobAcceptor。 10s扫描一次 redis中的```ds:trident:mq:allJob```队列\n\n#### fusion\n\n将fusion作业直接提交到海纳执行，sendJobToTracker 放到```ds:trident:scheduler:running```中\n\n#### merged\n\n将merged且waitForBatch=false的，进行合并。ExecutionPlanner.INSTANCE.merge(ImmutableList.of(jobCtx))，然后提交海纳，sendJobToTracker 放到```ds:trident:scheduler:running```中\n\n```mermaid\ngraph LR\n\t合并任务-->condition{是否大于合并阈值}\n\tcondition--否,简单合并-->将多个sql语句放到一个task里面\n\tcondition--是,深度合并-->对sql逻辑进行合并后放到一个task里面\n```\n\n合并任务相关单元测试可以参考com.datastory.trident.serv.scheduler.ExecutionPlannerTest\n\n\n\n将merged且waitForBatch=true的，提交到```ds:trident:mq:mergeJob```队列\n\n![image-20210106144024660](/image/image-20210106144024660.png)\n\n```json\n{\"labelJobIdMap\":{\"2048\":1133541,\"2049\":1133542,\"2050\":1133543,\"2051\":1133544,\"2052\":1133545,\"2053\":1133546,\"2054\":1133547,\"2055\":1133548,\"2056\":1133549,\"2058\":1133550,\"2059\":1133551,\"2060\":1133552,\"2061\":1133553,\"2062\":1133554,\"2063\":1133555,\"2064\":1133556,\"2065\":1133557,\"2066\":1133558,\"2068\":1133559,\"2069\":1133560,\"2070\":1133561,\"2071\":1133562,\"2072\":1133563,\"2073\":1133564,\"2074\":1133565,\"2075\":1133566,\"2076\":1133567,\"2077\":1133568,\"2078\":1133569,\"2079\":1133570,\"2080\":1133571,\"2082\":1133572,\"2083\":1133573,\"2084\":1133574,\"2094\":1133575,\"2095\":1133576,\"2096\":1133577,\"2097\":1133578,\"2098\":1133579,\"2099\":1133580,\"2100\":1133581,\"2101\":1133582,\"2105\":1133583,\"2106\":1133584,\"2107\":1133585,\"2108\":1133586,\"2110\":1133587,\"2111\":1133588,\"2113\":1133589,\"2114\":1133590,\"2115\":1133591,\"2116\":1133592,\"2117\":1133593,\"2118\":1133594,\"2119\":1133595,\"2120\":1133596,\"2122\":1133597,\"2123\":1133598,\"2124\":1133599,\"2125\":1133600,\"2126\":1133601,\"2127\":1133602,\"2128\":1133603,\"2129\":1133604,\"2130\":1133605,\"2131\":1133606,\"2132\":1133607,\"2135\":1133608,\"2136\":1133609,\"2137\":1133610,\"2138\":1133611,\"2139\":1133612,\"2141\":1133613,\"2142\":1133614,\"2143\":1133615,\"2144\":1133616,\"2145\":1133617,\"2146\":1133618,\"2147\":1133619,\"2148\":1133620,\"2149\":1133621,\"2150\":1133622,\"2151\":1133623,\"2153\":1133624,\"2154\":1133625,\"2155\":1133626,\"2156\":1133627,\"2157\":1133628,\"2158\":1133629,\"2159\":1133630,\"2160\":1133631,\"2161\":1133632,\"2163\":1133633,\"2164\":1133634,\"2165\":1133635,\"2166\":1133636,\"2167\":1133637,\"2168\":1133638,\"2169\":1133639,\"2170\":1133640,\"2171\":1133641,\"2172\":1133642,\"2173\":1133643,\"2174\":1133644,\"2175\":1133645,\"2177\":1133646,\"2178\":1133647,\"2179\":1133648,\"2189\":1133649,\"2190\":1133650,\"2191\":1133651,\"2192\":1133652,\"2193\":1133653,\"2194\":1133654,\"2195\":1133655,\"2196\":1133656,\"2200\":1133657,\"2201\":1133658,\"2202\":1133659,\"2203\":1133660,\"2205\":1133661,\"2206\":1133662,\"2208\":1133663,\"2209\":1133664,\"2210\":1133665,\"2211\":1133666,\"2212\":1133667,\"2214\":1133668,\"2215\":1133669,\"2216\":1133670,\"2217\":1133671,\"2218\":1133672,\"2219\":1133673,\"2220\":1133674,\"2221\":1133675,\"2222\":1133676,\"2223\":1133677,\"2224\":1133678,\"2227\":1133679,\"2228\":1133680,\"2229\":1133681,\"2230\":1133682,\"2231\":1133683,\"2233\":1133684,\"2234\":1133685,\"2235\":1133686,\"2236\":1133687,\"2237\":1133688,\"2238\":1133689,\"2239\":1133690,\"2240\":1133691,\"2241\":1133692,\"2242\":1133693,\"2243\":1133694,\"2245\":1133695,\"2246\":1133696,\"2247\":1133697,\"2248\":1133698,\"2249\":1133699,\"2250\":1133700,\"2251\":1133701,\"2252\":1133702,\"2253\":1133703,\"2255\":1133704,\"2256\":1133705,\"2257\":1133706,\"2258\":1133707,\"2259\":1133708,\"2260\":1133709,\"2261\":1133710,\"2262\":1133711,\"2263\":1133712,\"2264\":1133713,\"2265\":1133714,\"2266\":1133715,\"2267\":1133716,\"2269\":1133717,\"2270\":1133718,\"2271\":1133719,\"2273\":1133720,\"2278\":1133721,\"2280\":1133722,\"2298\":1133723,\"2299\":1133724,\"2300\":1133725,\"2301\":1133726,\"2302\":1133727,\"2303\":1133728,\"2304\":1133729,\"2305\":1133730,\"2309\":1133731,\"2310\":1133732,\"2311\":1133733,\"2312\":1133734,\"2314\":1133735,\"2315\":1133736,\"2317\":1133737,\"2318\":1133738,\"2319\":1133739,\"2320\":1133740,\"2321\":1133741,\"2322\":1133742,\"2323\":1133743,\"2324\":1133744,\"2326\":1133745,\"2327\":1133746,\"2328\":1133747,\"2329\":1133748,\"2330\":1133749,\"2331\":1133750,\"2332\":1133751,\"2333\":1133752,\"2334\":1133753,\"2335\":1133754,\"2336\":1133755,\"2339\":1133756,\"2340\":1133757,\"2341\":1133758,\"2342\":1133759,\"2343\":1133760,\"2345\":1133761,\"2346\":1133762,\"2347\":1133763,\"2348\":1133764,\"2349\":1133765,\"2350\":1133766,\"2351\":1133767,\"2352\":1133768,\"2353\":1133769,\"2354\":1133770,\"2355\":1133771,\"2357\":1133772,\"2358\":1133773,\"2359\":1133774,\"2360\":1133775,\"2361\":1133776,\"2362\":1133777,\"2363\":1133778,\"2364\":1133779,\"2365\":1133780,\"2367\":1133781,\"2368\":1133782,\"2369\":1133783,\"2370\":1133784,\"2371\":1133785,\"2372\":1133786,\"2373\":1133787,\"2374\":1133788,\"2375\":1133789,\"2376\":1133790,\"2377\":1133791,\"2378\":1133792,\"2379\":1133793,\"2381\":1133794,\"2382\":1133795,\"2383\":1133796,\"2405\":1133797,\"2406\":1133798,\"2407\":1133799,\"2408\":1133800,\"2409\":1133801,\"2410\":1133802,\"2411\":1133803,\"2412\":1133804,\"2416\":1133805,\"2417\":1133806,\"2418\":1133807,\"2419\":1133808,\"2421\":1133809,\"2422\":1133810,\"2424\":1133811,\"2425\":1133812,\"2426\":1133813,\"2427\":1133814,\"2428\":1133815,\"2429\":1133816,\"2430\":1133817,\"2431\":1133818,\"2433\":1133819,\"2434\":1133820,\"2435\":1133821,\"2436\":1133822,\"2437\":1133823,\"2438\":1133824,\"2439\":1133825,\"2440\":1133826,\"2441\":1133827,\"2442\":1133828,\"2443\":1133829,\"2446\":1133830,\"2447\":1133831,\"2448\":1133832,\"2449\":1133833,\"2450\":1133834,\"2452\":1133835,\"2453\":1133836,\"2454\":1133837,\"2455\":1133838,\"2456\":1133839,\"2457\":1133840,\"2458\":1133841,\"2459\":1133842,\"2460\":1133843,\"2461\":1133844,\"2462\":1133845,\"2464\":1133846,\"2465\":1133847,\"2466\":1133848,\"2467\":1133849,\"2468\":1133850,\"2469\":1133851,\"2470\":1133852,\"2471\":1133853,\"2472\":1133854,\"2474\":1133855,\"2475\":1133856,\"2476\":1133857,\"2477\":1133858,\"2478\":1133859,\"2479\":1133860,\"2480\":1133861,\"2481\":1133862,\"2482\":1133863,\"2483\":1133864,\"2484\":1133865,\"2485\":1133866,\"2486\":1133867,\"2488\":1133868,\"2489\":1133869,\"2490\":1133870,\"2509\":1133871,\"2510\":1133872,\"2515\":1133873,\"2528\":1133874,\"2529\":1133875,\"1622\":1133876,\"1623\":1133877,\"1624\":1133878,\"1625\":1133879,\"1626\":1133880,\"1627\":1133881,\"1628\":1133882,\"1629\":1133883,\"1633\":1133884,\"1634\":1133885,\"1635\":1133886,\"1636\":1133887,\"1638\":1133888,\"1639\":1133889,\"1641\":1133890,\"1642\":1133891,\"1643\":1133892,\"1644\":1133893,\"1645\":1133894,\"1646\":1133895,\"1647\":1133896,\"1648\":1133897,\"1650\":1133898,\"1651\":1133899,\"1652\":1133900,\"1653\":1133901,\"1654\":1133902,\"1655\":1133903,\"1656\":1133904,\"1657\":1133905,\"1658\":1133906,\"1659\":1133907,\"1660\":1133908,\"1663\":1133909,\"1664\":1133910,\"1665\":1133911,\"1666\":1133912,\"1667\":1133913,\"1669\":1133914,\"1670\":1133915,\"1683\":1133916,\"1684\":1133917,\"1685\":1133918,\"1686\":1133919,\"1687\":1133920,\"1688\":1133921,\"1689\":1133922,\"1690\":1133923,\"1691\":1133924,\"1693\":1133925,\"1694\":1133926,\"1695\":1133927,\"1696\":1133928,\"1698\":1133929,\"1699\":1133930,\"1700\":1133931,\"1701\":1133932,\"1702\":1133933,\"1704\":1133934,\"1705\":1133935,\"1706\":1133936,\"1707\":1133937,\"1708\":1133938,\"1709\":1133939,\"1710\":1133940,\"1711\":1133941,\"1712\":1133942,\"1713\":1133943,\"1714\":1133944,\"1715\":1133945,\"1716\":1133946,\"1718\":1133947,\"1719\":1133948,\"1720\":1133949,\"1783\":1133950,\"1784\":1133951,\"1785\":1133952,\"1786\":1133953,\"1787\":1133954,\"1788\":1133955,\"1789\":1133956,\"1790\":1133957,\"1794\":1133958,\"1795\":1133959,\"1796\":1133960,\"1797\":1133961,\"1799\":1133962,\"1800\":1133963,\"1805\":1133964,\"1806\":1133965,\"1807\":1133966,\"1808\":1133967,\"1809\":1133968,\"1811\":1133969,\"1812\":1133970,\"1813\":1133971,\"1814\":1133972,\"1815\":1133973,\"1816\":1133974,\"1817\":1133975,\"1818\":1133976,\"1819\":1133977,\"1820\":1133978,\"1821\":1133979,\"1824\":1133980,\"1825\":1133981,\"1826\":1133982,\"1827\":1133983,\"1828\":1133984,\"1830\":1133985,\"1831\":1133986,\"1832\":1133987,\"1833\":1133988,\"1834\":1133989,\"1835\":1133990,\"1836\":1133991,\"1837\":1133992,\"1838\":1133993,\"1839\":1133994,\"1840\":1133995,\"1842\":1133996,\"1843\":1133997,\"1844\":1133998,\"1845\":1133999,\"1846\":1134000,\"1847\":1134001,\"1848\":1134002,\"1849\":1134003,\"1850\":1134004,\"1852\":1134005,\"1853\":1134006,\"1854\":1134007,\"1855\":1134008,\"1856\":1134009,\"1857\":1134010,\"1858\":1134011,\"1859\":1134012,\"1860\":1134013,\"1861\":1134014,\"1862\":1134015,\"1863\":1134016,\"1864\":1134017,\"1866\":1134018,\"1867\":1134019,\"1868\":1134020,\"1884\":1134021,\"1885\":1134022,\"1886\":1134023,\"1887\":1134024,\"1888\":1134025,\"1889\":1134026,\"1890\":1134027,\"1891\":1134028,\"1895\":1134029,\"1896\":1134030,\"1897\":1134031,\"1898\":1134032,\"1900\":1134033,\"1901\":1134034,\"1903\":1134035,\"1904\":1134036,\"1905\":1134037,\"1906\":1134038,\"1907\":1134039,\"1908\":1134040,\"1909\":1134041,\"1910\":1134042,\"1912\":1134043,\"1913\":1134044,\"1914\":1134045,\"1915\":1134046,\"1916\":1134047,\"1917\":1134048,\"1918\":1134049,\"1919\":1134050,\"1920\":1134051,\"1921\":1134052,\"1922\":1134053,\"1925\":1134054,\"1926\":1134055,\"1927\":1134056,\"1928\":1134057,\"1929\":1134058,\"1931\":1134059,\"1932\":1134060,\"1933\":1134061,\"1934\":1134062,\"1935\":1134063,\"1936\":1134064,\"1937\":1134065,\"1938\":1134066,\"1939\":1134067,\"1940\":1134068,\"1941\":1134069,\"1943\":1134070,\"1944\":1134071,\"1945\":1134072,\"1946\":1134073,\"1947\":1134074,\"1948\":1134075,\"1949\":1134076,\"1950\":1134077,\"1951\":1134078,\"1953\":1134079,\"1954\":1134080,\"1955\":1134081,\"1956\":1134082,\"1957\":1134083,\"1958\":1134084,\"1959\":1134085,\"1960\":1134086,\"1961\":1134087,\"1962\":1134088,\"1963\":1134089,\"1964\":1134090,\"1965\":1134091,\"1967\":1134092,\"1968\":1134093,\"1969\":1134094,\"1999\":1134095,\"2000\":1134096,\"2001\":1134097,\"2002\":1134098,\"2003\":1134099,\"2004\":1134100,\"2005\":1134101,\"2006\":1134102,\"2010\":1134103,\"2011\":1134104,\"2012\":1134105,\"2013\":1134106,\"2015\":1134107,\"2016\":1134108,\"2018\":1134109,\"2019\":1134110,\"2020\":1134111,\"2021\":1134112,\"2022\":1134113,\"2023\":1134114,\"2024\":1134115,\"2025\":1134116,\"2027\":1134117,\"2028\":1134118,\"2029\":1134119,\"2030\":1134120,\"2031\":1134121,\"2032\":1134122,\"2033\":1134123,\"2034\":1134124,\"2035\":1134125,\"2036\":1134126,\"2037\":1134127,\"2040\":1134128,\"2041\":1134129,\"2042\":1134130,\"2043\":1134131,\"2044\":1134132,\"2046\":1134133,\"2047\":1134134},\"waitForBatch\":true,\"jobType\":\"MERGED\",\"treeId\":256,\"treeTypeId\":497}\n```\n\n\n\n### 合并的任务\n\nBatchJobAcceptor。2小时扫描一次\n\n处理过程同merged 且watiForBatch=false，只是多了个等待时间，会收到多个jobCtx，ExecutionPlanner.INSTANCE.merge(jobCtxList)\n\n\n\n<font color=\"#FF000\">**难点在于合并任务的逻辑处理。@see com.datastory.trident.serv.scheduler.ExecutionPlanner#merge**</font>\n\n\n\n## 修改标签规则\n\n```mermaid\ngraph TD;\n\tsubgraph all[全部]\n\tstart[开始]-->edit[修改标签]\n\tedit--执行标签任务-->redis[提交到redis的allJob队列]\n\tredis--JobAcceptor#parseMessage-->runJob[执行标签 调用海纳]\t\n\trunJob-->ostart\n\tend\n\tsubgraph ocean[海纳任务]\n\tostart[海纳task]-->oend[海纳任务执行完成]\n\tostart-->jstart\n\tend\n\tsubgraph JobTracker\n\tjstart[从redis的scheduler:running获取运行中的任务]-->isJobEnd{任务是否到达终态}\n\tisJobEnd--是-->updateLabelCoverage[更新标签覆盖数]-->processRuleUpdatedLabel{判断规则是否改过}\n\tupdateLabelCoverage-->processOneTimeLabelStatus[一次性标签需要修改oneTimeStatus状态位为已执行]-->removeFromRedisSet[从redis的running中删除]-->oend\n\tisJobEnd--否-->jstart\n\tprocessRuleUpdatedLabel--是-->cleanStart\n\tend\n\tsubgraph ofCleanOldRuleJob[清理修改过规则后的过期标签]\n\tcleanStart-->cleanEnd\n\tend\n```\n### 任务终态定义\n```java\n\nthis.equals(SUCCESS) || this.equals(TIMEOUT) || this.equals(KILLED) || this.equals(FAILED) || this.equals(SYS_KILLED) || this.equals(SYS_FAILED)\n```\n\n","source":"_posts/标签体系.md","raw":"---\ntitle: 标签体系\ndate: 2021-01-08 12:33:59\ntags: trident # 好像没用\noverdue: true #这一行\ncategories: trident # 目录\n---\n\n## 周期性标签运行\n\n### 获取需要执行的标签\n\nCronJobLauncher。10s扫描一次\n\n```sql\nSELECT i.id,\n       i.label_unique_id,\n       i.label_name,\n       i.label_type,\n       i.demand,\n       i.rule_descriptor,\n       i.rule_hash,\n       i.dsl_config,\n       i.execute_config,\n       i.next_run_time,\n       i.rule_recent_updated,\n       i.expire_type,\n       i.expire_value,\n       i.es_type,\n       t.cron_config AS tree_cron_config,\n       IFNULL(i.cron_config,t.cron_config) AS cron_config,\n       t.tree_type_id AS tree_type,\n       i.tree_id,\n       i.root_label_id,\n       i.parent_label_id,\n       i.depth,\n       i.acc_id,\n       i.emails,\n       i.del_flag,\n       i.create_time,\n       i.update_time,\n       i.label_count,\n       i.one_time_status\nFROM t_trident_label_info i\nLEFT JOIN t_trident_label_tree t ON t.tree_id = i.tree_id\nWHERE i.del_flag = 0\n  AND i.execute_config IS NOT NULL\n  AND i.dsl_config IS NOT NULL\n  AND (i.next_run_time > '1970-01-01 08:00:00'\n       AND i.next_run_time <= NOW())\n  AND i.one_time_status <> 2\n```\n\n桉树id分组\n\n遍历每个分组，如果分组下的标签执行周期 != 树的执行周期，ofSpecialCronJob 立即提交任务（fusion）\n\n否则合并多个标签任务id，ofNormalCronJob 提交任务（merged，waitForBatch=true） \n\n遍历完成后，更新下次执行时间（nextRunTime）\n\n以上任务提交后都先放在redis的```ds:trident:mq:allJob```​队列中\n\n\n\n运行中的任务在 redis的 ```ds:trident:scheduler:running```中\n\n![image-20210106101222963](/image/image-20210106101222963.png)\n\n### 任务分发\n\nJobAcceptor。 10s扫描一次 redis中的```ds:trident:mq:allJob```队列\n\n#### fusion\n\n将fusion作业直接提交到海纳执行，sendJobToTracker 放到```ds:trident:scheduler:running```中\n\n#### merged\n\n将merged且waitForBatch=false的，进行合并。ExecutionPlanner.INSTANCE.merge(ImmutableList.of(jobCtx))，然后提交海纳，sendJobToTracker 放到```ds:trident:scheduler:running```中\n\n```mermaid\ngraph LR\n\t合并任务-->condition{是否大于合并阈值}\n\tcondition--否,简单合并-->将多个sql语句放到一个task里面\n\tcondition--是,深度合并-->对sql逻辑进行合并后放到一个task里面\n```\n\n合并任务相关单元测试可以参考com.datastory.trident.serv.scheduler.ExecutionPlannerTest\n\n\n\n将merged且waitForBatch=true的，提交到```ds:trident:mq:mergeJob```队列\n\n![image-20210106144024660](/image/image-20210106144024660.png)\n\n```json\n{\"labelJobIdMap\":{\"2048\":1133541,\"2049\":1133542,\"2050\":1133543,\"2051\":1133544,\"2052\":1133545,\"2053\":1133546,\"2054\":1133547,\"2055\":1133548,\"2056\":1133549,\"2058\":1133550,\"2059\":1133551,\"2060\":1133552,\"2061\":1133553,\"2062\":1133554,\"2063\":1133555,\"2064\":1133556,\"2065\":1133557,\"2066\":1133558,\"2068\":1133559,\"2069\":1133560,\"2070\":1133561,\"2071\":1133562,\"2072\":1133563,\"2073\":1133564,\"2074\":1133565,\"2075\":1133566,\"2076\":1133567,\"2077\":1133568,\"2078\":1133569,\"2079\":1133570,\"2080\":1133571,\"2082\":1133572,\"2083\":1133573,\"2084\":1133574,\"2094\":1133575,\"2095\":1133576,\"2096\":1133577,\"2097\":1133578,\"2098\":1133579,\"2099\":1133580,\"2100\":1133581,\"2101\":1133582,\"2105\":1133583,\"2106\":1133584,\"2107\":1133585,\"2108\":1133586,\"2110\":1133587,\"2111\":1133588,\"2113\":1133589,\"2114\":1133590,\"2115\":1133591,\"2116\":1133592,\"2117\":1133593,\"2118\":1133594,\"2119\":1133595,\"2120\":1133596,\"2122\":1133597,\"2123\":1133598,\"2124\":1133599,\"2125\":1133600,\"2126\":1133601,\"2127\":1133602,\"2128\":1133603,\"2129\":1133604,\"2130\":1133605,\"2131\":1133606,\"2132\":1133607,\"2135\":1133608,\"2136\":1133609,\"2137\":1133610,\"2138\":1133611,\"2139\":1133612,\"2141\":1133613,\"2142\":1133614,\"2143\":1133615,\"2144\":1133616,\"2145\":1133617,\"2146\":1133618,\"2147\":1133619,\"2148\":1133620,\"2149\":1133621,\"2150\":1133622,\"2151\":1133623,\"2153\":1133624,\"2154\":1133625,\"2155\":1133626,\"2156\":1133627,\"2157\":1133628,\"2158\":1133629,\"2159\":1133630,\"2160\":1133631,\"2161\":1133632,\"2163\":1133633,\"2164\":1133634,\"2165\":1133635,\"2166\":1133636,\"2167\":1133637,\"2168\":1133638,\"2169\":1133639,\"2170\":1133640,\"2171\":1133641,\"2172\":1133642,\"2173\":1133643,\"2174\":1133644,\"2175\":1133645,\"2177\":1133646,\"2178\":1133647,\"2179\":1133648,\"2189\":1133649,\"2190\":1133650,\"2191\":1133651,\"2192\":1133652,\"2193\":1133653,\"2194\":1133654,\"2195\":1133655,\"2196\":1133656,\"2200\":1133657,\"2201\":1133658,\"2202\":1133659,\"2203\":1133660,\"2205\":1133661,\"2206\":1133662,\"2208\":1133663,\"2209\":1133664,\"2210\":1133665,\"2211\":1133666,\"2212\":1133667,\"2214\":1133668,\"2215\":1133669,\"2216\":1133670,\"2217\":1133671,\"2218\":1133672,\"2219\":1133673,\"2220\":1133674,\"2221\":1133675,\"2222\":1133676,\"2223\":1133677,\"2224\":1133678,\"2227\":1133679,\"2228\":1133680,\"2229\":1133681,\"2230\":1133682,\"2231\":1133683,\"2233\":1133684,\"2234\":1133685,\"2235\":1133686,\"2236\":1133687,\"2237\":1133688,\"2238\":1133689,\"2239\":1133690,\"2240\":1133691,\"2241\":1133692,\"2242\":1133693,\"2243\":1133694,\"2245\":1133695,\"2246\":1133696,\"2247\":1133697,\"2248\":1133698,\"2249\":1133699,\"2250\":1133700,\"2251\":1133701,\"2252\":1133702,\"2253\":1133703,\"2255\":1133704,\"2256\":1133705,\"2257\":1133706,\"2258\":1133707,\"2259\":1133708,\"2260\":1133709,\"2261\":1133710,\"2262\":1133711,\"2263\":1133712,\"2264\":1133713,\"2265\":1133714,\"2266\":1133715,\"2267\":1133716,\"2269\":1133717,\"2270\":1133718,\"2271\":1133719,\"2273\":1133720,\"2278\":1133721,\"2280\":1133722,\"2298\":1133723,\"2299\":1133724,\"2300\":1133725,\"2301\":1133726,\"2302\":1133727,\"2303\":1133728,\"2304\":1133729,\"2305\":1133730,\"2309\":1133731,\"2310\":1133732,\"2311\":1133733,\"2312\":1133734,\"2314\":1133735,\"2315\":1133736,\"2317\":1133737,\"2318\":1133738,\"2319\":1133739,\"2320\":1133740,\"2321\":1133741,\"2322\":1133742,\"2323\":1133743,\"2324\":1133744,\"2326\":1133745,\"2327\":1133746,\"2328\":1133747,\"2329\":1133748,\"2330\":1133749,\"2331\":1133750,\"2332\":1133751,\"2333\":1133752,\"2334\":1133753,\"2335\":1133754,\"2336\":1133755,\"2339\":1133756,\"2340\":1133757,\"2341\":1133758,\"2342\":1133759,\"2343\":1133760,\"2345\":1133761,\"2346\":1133762,\"2347\":1133763,\"2348\":1133764,\"2349\":1133765,\"2350\":1133766,\"2351\":1133767,\"2352\":1133768,\"2353\":1133769,\"2354\":1133770,\"2355\":1133771,\"2357\":1133772,\"2358\":1133773,\"2359\":1133774,\"2360\":1133775,\"2361\":1133776,\"2362\":1133777,\"2363\":1133778,\"2364\":1133779,\"2365\":1133780,\"2367\":1133781,\"2368\":1133782,\"2369\":1133783,\"2370\":1133784,\"2371\":1133785,\"2372\":1133786,\"2373\":1133787,\"2374\":1133788,\"2375\":1133789,\"2376\":1133790,\"2377\":1133791,\"2378\":1133792,\"2379\":1133793,\"2381\":1133794,\"2382\":1133795,\"2383\":1133796,\"2405\":1133797,\"2406\":1133798,\"2407\":1133799,\"2408\":1133800,\"2409\":1133801,\"2410\":1133802,\"2411\":1133803,\"2412\":1133804,\"2416\":1133805,\"2417\":1133806,\"2418\":1133807,\"2419\":1133808,\"2421\":1133809,\"2422\":1133810,\"2424\":1133811,\"2425\":1133812,\"2426\":1133813,\"2427\":1133814,\"2428\":1133815,\"2429\":1133816,\"2430\":1133817,\"2431\":1133818,\"2433\":1133819,\"2434\":1133820,\"2435\":1133821,\"2436\":1133822,\"2437\":1133823,\"2438\":1133824,\"2439\":1133825,\"2440\":1133826,\"2441\":1133827,\"2442\":1133828,\"2443\":1133829,\"2446\":1133830,\"2447\":1133831,\"2448\":1133832,\"2449\":1133833,\"2450\":1133834,\"2452\":1133835,\"2453\":1133836,\"2454\":1133837,\"2455\":1133838,\"2456\":1133839,\"2457\":1133840,\"2458\":1133841,\"2459\":1133842,\"2460\":1133843,\"2461\":1133844,\"2462\":1133845,\"2464\":1133846,\"2465\":1133847,\"2466\":1133848,\"2467\":1133849,\"2468\":1133850,\"2469\":1133851,\"2470\":1133852,\"2471\":1133853,\"2472\":1133854,\"2474\":1133855,\"2475\":1133856,\"2476\":1133857,\"2477\":1133858,\"2478\":1133859,\"2479\":1133860,\"2480\":1133861,\"2481\":1133862,\"2482\":1133863,\"2483\":1133864,\"2484\":1133865,\"2485\":1133866,\"2486\":1133867,\"2488\":1133868,\"2489\":1133869,\"2490\":1133870,\"2509\":1133871,\"2510\":1133872,\"2515\":1133873,\"2528\":1133874,\"2529\":1133875,\"1622\":1133876,\"1623\":1133877,\"1624\":1133878,\"1625\":1133879,\"1626\":1133880,\"1627\":1133881,\"1628\":1133882,\"1629\":1133883,\"1633\":1133884,\"1634\":1133885,\"1635\":1133886,\"1636\":1133887,\"1638\":1133888,\"1639\":1133889,\"1641\":1133890,\"1642\":1133891,\"1643\":1133892,\"1644\":1133893,\"1645\":1133894,\"1646\":1133895,\"1647\":1133896,\"1648\":1133897,\"1650\":1133898,\"1651\":1133899,\"1652\":1133900,\"1653\":1133901,\"1654\":1133902,\"1655\":1133903,\"1656\":1133904,\"1657\":1133905,\"1658\":1133906,\"1659\":1133907,\"1660\":1133908,\"1663\":1133909,\"1664\":1133910,\"1665\":1133911,\"1666\":1133912,\"1667\":1133913,\"1669\":1133914,\"1670\":1133915,\"1683\":1133916,\"1684\":1133917,\"1685\":1133918,\"1686\":1133919,\"1687\":1133920,\"1688\":1133921,\"1689\":1133922,\"1690\":1133923,\"1691\":1133924,\"1693\":1133925,\"1694\":1133926,\"1695\":1133927,\"1696\":1133928,\"1698\":1133929,\"1699\":1133930,\"1700\":1133931,\"1701\":1133932,\"1702\":1133933,\"1704\":1133934,\"1705\":1133935,\"1706\":1133936,\"1707\":1133937,\"1708\":1133938,\"1709\":1133939,\"1710\":1133940,\"1711\":1133941,\"1712\":1133942,\"1713\":1133943,\"1714\":1133944,\"1715\":1133945,\"1716\":1133946,\"1718\":1133947,\"1719\":1133948,\"1720\":1133949,\"1783\":1133950,\"1784\":1133951,\"1785\":1133952,\"1786\":1133953,\"1787\":1133954,\"1788\":1133955,\"1789\":1133956,\"1790\":1133957,\"1794\":1133958,\"1795\":1133959,\"1796\":1133960,\"1797\":1133961,\"1799\":1133962,\"1800\":1133963,\"1805\":1133964,\"1806\":1133965,\"1807\":1133966,\"1808\":1133967,\"1809\":1133968,\"1811\":1133969,\"1812\":1133970,\"1813\":1133971,\"1814\":1133972,\"1815\":1133973,\"1816\":1133974,\"1817\":1133975,\"1818\":1133976,\"1819\":1133977,\"1820\":1133978,\"1821\":1133979,\"1824\":1133980,\"1825\":1133981,\"1826\":1133982,\"1827\":1133983,\"1828\":1133984,\"1830\":1133985,\"1831\":1133986,\"1832\":1133987,\"1833\":1133988,\"1834\":1133989,\"1835\":1133990,\"1836\":1133991,\"1837\":1133992,\"1838\":1133993,\"1839\":1133994,\"1840\":1133995,\"1842\":1133996,\"1843\":1133997,\"1844\":1133998,\"1845\":1133999,\"1846\":1134000,\"1847\":1134001,\"1848\":1134002,\"1849\":1134003,\"1850\":1134004,\"1852\":1134005,\"1853\":1134006,\"1854\":1134007,\"1855\":1134008,\"1856\":1134009,\"1857\":1134010,\"1858\":1134011,\"1859\":1134012,\"1860\":1134013,\"1861\":1134014,\"1862\":1134015,\"1863\":1134016,\"1864\":1134017,\"1866\":1134018,\"1867\":1134019,\"1868\":1134020,\"1884\":1134021,\"1885\":1134022,\"1886\":1134023,\"1887\":1134024,\"1888\":1134025,\"1889\":1134026,\"1890\":1134027,\"1891\":1134028,\"1895\":1134029,\"1896\":1134030,\"1897\":1134031,\"1898\":1134032,\"1900\":1134033,\"1901\":1134034,\"1903\":1134035,\"1904\":1134036,\"1905\":1134037,\"1906\":1134038,\"1907\":1134039,\"1908\":1134040,\"1909\":1134041,\"1910\":1134042,\"1912\":1134043,\"1913\":1134044,\"1914\":1134045,\"1915\":1134046,\"1916\":1134047,\"1917\":1134048,\"1918\":1134049,\"1919\":1134050,\"1920\":1134051,\"1921\":1134052,\"1922\":1134053,\"1925\":1134054,\"1926\":1134055,\"1927\":1134056,\"1928\":1134057,\"1929\":1134058,\"1931\":1134059,\"1932\":1134060,\"1933\":1134061,\"1934\":1134062,\"1935\":1134063,\"1936\":1134064,\"1937\":1134065,\"1938\":1134066,\"1939\":1134067,\"1940\":1134068,\"1941\":1134069,\"1943\":1134070,\"1944\":1134071,\"1945\":1134072,\"1946\":1134073,\"1947\":1134074,\"1948\":1134075,\"1949\":1134076,\"1950\":1134077,\"1951\":1134078,\"1953\":1134079,\"1954\":1134080,\"1955\":1134081,\"1956\":1134082,\"1957\":1134083,\"1958\":1134084,\"1959\":1134085,\"1960\":1134086,\"1961\":1134087,\"1962\":1134088,\"1963\":1134089,\"1964\":1134090,\"1965\":1134091,\"1967\":1134092,\"1968\":1134093,\"1969\":1134094,\"1999\":1134095,\"2000\":1134096,\"2001\":1134097,\"2002\":1134098,\"2003\":1134099,\"2004\":1134100,\"2005\":1134101,\"2006\":1134102,\"2010\":1134103,\"2011\":1134104,\"2012\":1134105,\"2013\":1134106,\"2015\":1134107,\"2016\":1134108,\"2018\":1134109,\"2019\":1134110,\"2020\":1134111,\"2021\":1134112,\"2022\":1134113,\"2023\":1134114,\"2024\":1134115,\"2025\":1134116,\"2027\":1134117,\"2028\":1134118,\"2029\":1134119,\"2030\":1134120,\"2031\":1134121,\"2032\":1134122,\"2033\":1134123,\"2034\":1134124,\"2035\":1134125,\"2036\":1134126,\"2037\":1134127,\"2040\":1134128,\"2041\":1134129,\"2042\":1134130,\"2043\":1134131,\"2044\":1134132,\"2046\":1134133,\"2047\":1134134},\"waitForBatch\":true,\"jobType\":\"MERGED\",\"treeId\":256,\"treeTypeId\":497}\n```\n\n\n\n### 合并的任务\n\nBatchJobAcceptor。2小时扫描一次\n\n处理过程同merged 且watiForBatch=false，只是多了个等待时间，会收到多个jobCtx，ExecutionPlanner.INSTANCE.merge(jobCtxList)\n\n\n\n<font color=\"#FF000\">**难点在于合并任务的逻辑处理。@see com.datastory.trident.serv.scheduler.ExecutionPlanner#merge**</font>\n\n\n\n## 修改标签规则\n\n```mermaid\ngraph TD;\n\tsubgraph all[全部]\n\tstart[开始]-->edit[修改标签]\n\tedit--执行标签任务-->redis[提交到redis的allJob队列]\n\tredis--JobAcceptor#parseMessage-->runJob[执行标签 调用海纳]\t\n\trunJob-->ostart\n\tend\n\tsubgraph ocean[海纳任务]\n\tostart[海纳task]-->oend[海纳任务执行完成]\n\tostart-->jstart\n\tend\n\tsubgraph JobTracker\n\tjstart[从redis的scheduler:running获取运行中的任务]-->isJobEnd{任务是否到达终态}\n\tisJobEnd--是-->updateLabelCoverage[更新标签覆盖数]-->processRuleUpdatedLabel{判断规则是否改过}\n\tupdateLabelCoverage-->processOneTimeLabelStatus[一次性标签需要修改oneTimeStatus状态位为已执行]-->removeFromRedisSet[从redis的running中删除]-->oend\n\tisJobEnd--否-->jstart\n\tprocessRuleUpdatedLabel--是-->cleanStart\n\tend\n\tsubgraph ofCleanOldRuleJob[清理修改过规则后的过期标签]\n\tcleanStart-->cleanEnd\n\tend\n```\n### 任务终态定义\n```java\n\nthis.equals(SUCCESS) || this.equals(TIMEOUT) || this.equals(KILLED) || this.equals(FAILED) || this.equals(SYS_KILLED) || this.equals(SYS_FAILED)\n```\n\n","slug":"标签体系","published":1,"updated":"2021-01-08T04:06:33.304Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckk26vf2x0007w5hacqqb82n5","content":"<h2 id=\"周期性标签运行\"><a href=\"#周期性标签运行\" class=\"headerlink\" title=\"周期性标签运行\"></a>周期性标签运行</h2><h3 id=\"获取需要执行的标签\"><a href=\"#获取需要执行的标签\" class=\"headerlink\" title=\"获取需要执行的标签\"></a>获取需要执行的标签</h3><p>CronJobLauncher。10s扫描一次</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> i.id,</span><br><span class=\"line\">       i.label_unique_id,</span><br><span class=\"line\">       i.label_name,</span><br><span class=\"line\">       i.label_type,</span><br><span class=\"line\">       i.demand,</span><br><span class=\"line\">       i.rule_descriptor,</span><br><span class=\"line\">       i.rule_hash,</span><br><span class=\"line\">       i.dsl_config,</span><br><span class=\"line\">       i.execute_config,</span><br><span class=\"line\">       i.next_run_time,</span><br><span class=\"line\">       i.rule_recent_updated,</span><br><span class=\"line\">       i.expire_type,</span><br><span class=\"line\">       i.expire_value,</span><br><span class=\"line\">       i.es_type,</span><br><span class=\"line\">       t.cron_config <span class=\"keyword\">AS</span> tree_cron_config,</span><br><span class=\"line\">       IFNULL(i.cron_config,t.cron_config) <span class=\"keyword\">AS</span> cron_config,</span><br><span class=\"line\">       t.tree_type_id <span class=\"keyword\">AS</span> tree_type,</span><br><span class=\"line\">       i.tree_id,</span><br><span class=\"line\">       i.root_label_id,</span><br><span class=\"line\">       i.parent_label_id,</span><br><span class=\"line\">       i.depth,</span><br><span class=\"line\">       i.acc_id,</span><br><span class=\"line\">       i.emails,</span><br><span class=\"line\">       i.del_flag,</span><br><span class=\"line\">       i.create_time,</span><br><span class=\"line\">       i.update_time,</span><br><span class=\"line\">       i.label_count,</span><br><span class=\"line\">       i.one_time_status</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> t_trident_label_info i</span><br><span class=\"line\"><span class=\"keyword\">LEFT</span> <span class=\"keyword\">JOIN</span> t_trident_label_tree t <span class=\"keyword\">ON</span> t.tree_id <span class=\"operator\">=</span> i.tree_id</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> i.del_flag <span class=\"operator\">=</span> <span class=\"number\">0</span></span><br><span class=\"line\">  <span class=\"keyword\">AND</span> i.execute_config <span class=\"keyword\">IS</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span></span><br><span class=\"line\">  <span class=\"keyword\">AND</span> i.dsl_config <span class=\"keyword\">IS</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span></span><br><span class=\"line\">  <span class=\"keyword\">AND</span> (i.next_run_time <span class=\"operator\">&gt;</span> <span class=\"string\">&#x27;1970-01-01 08:00:00&#x27;</span></span><br><span class=\"line\">       <span class=\"keyword\">AND</span> i.next_run_time <span class=\"operator\">&lt;=</span> NOW())</span><br><span class=\"line\">  <span class=\"keyword\">AND</span> i.one_time_status <span class=\"operator\">&lt;&gt;</span> <span class=\"number\">2</span></span><br></pre></td></tr></table></figure>\n<p>桉树id分组</p>\n<p>遍历每个分组，如果分组下的标签执行周期 != 树的执行周期，ofSpecialCronJob 立即提交任务（fusion）</p>\n<p>否则合并多个标签任务id，ofNormalCronJob 提交任务（merged，waitForBatch=true） </p>\n<p>遍历完成后，更新下次执行时间（nextRunTime）</p>\n<p>以上任务提交后都先放在redis的<code>ds:trident:mq:allJob</code>​队列中</p>\n<p>运行中的任务在 redis的 <code>ds:trident:scheduler:running</code>中</p>\n<p><img src=\"/image/image-20210106101222963.png\" alt=\"image-20210106101222963\"></p>\n<h3 id=\"任务分发\"><a href=\"#任务分发\" class=\"headerlink\" title=\"任务分发\"></a>任务分发</h3><p>JobAcceptor。 10s扫描一次 redis中的<code>ds:trident:mq:allJob</code>队列</p>\n<h4 id=\"fusion\"><a href=\"#fusion\" class=\"headerlink\" title=\"fusion\"></a>fusion</h4><p>将fusion作业直接提交到海纳执行，sendJobToTracker 放到<code>ds:trident:scheduler:running</code>中</p>\n<h4 id=\"merged\"><a href=\"#merged\" class=\"headerlink\" title=\"merged\"></a>merged</h4><p>将merged且waitForBatch=false的，进行合并。ExecutionPlanner.INSTANCE.merge(ImmutableList.of(jobCtx))，然后提交海纳，sendJobToTracker 放到<code>ds:trident:scheduler:running</code>中</p>\n<pre class=\"mermaid\">graph LR\n    合并任务-->condition{是否大于合并阈值}\n    condition--否,简单合并-->将多个sql语句放到一个task里面\n    condition--是,深度合并-->对sql逻辑进行合并后放到一个task里面</pre>\n\n<p>合并任务相关单元测试可以参考com.datastory.trident.serv.scheduler.ExecutionPlannerTest</p>\n<p>将merged且waitForBatch=true的，提交到<code>ds:trident:mq:mergeJob</code>队列</p>\n<p><img src=\"/image/image-20210106144024660.png\" alt=\"image-20210106144024660\"></p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"attr\">&quot;labelJobIdMap&quot;</span>:&#123;<span class=\"attr\">&quot;2048&quot;</span>:<span class=\"number\">1133541</span>,<span class=\"attr\">&quot;2049&quot;</span>:<span class=\"number\">1133542</span>,<span class=\"attr\">&quot;2050&quot;</span>:<span class=\"number\">1133543</span>,<span class=\"attr\">&quot;2051&quot;</span>:<span class=\"number\">1133544</span>,<span class=\"attr\">&quot;2052&quot;</span>:<span class=\"number\">1133545</span>,<span class=\"attr\">&quot;2053&quot;</span>:<span class=\"number\">1133546</span>,<span class=\"attr\">&quot;2054&quot;</span>:<span class=\"number\">1133547</span>,<span class=\"attr\">&quot;2055&quot;</span>:<span class=\"number\">1133548</span>,<span class=\"attr\">&quot;2056&quot;</span>:<span class=\"number\">1133549</span>,<span class=\"attr\">&quot;2058&quot;</span>:<span class=\"number\">1133550</span>,<span class=\"attr\">&quot;2059&quot;</span>:<span class=\"number\">1133551</span>,<span class=\"attr\">&quot;2060&quot;</span>:<span class=\"number\">1133552</span>,<span class=\"attr\">&quot;2061&quot;</span>:<span class=\"number\">1133553</span>,<span class=\"attr\">&quot;2062&quot;</span>:<span class=\"number\">1133554</span>,<span class=\"attr\">&quot;2063&quot;</span>:<span class=\"number\">1133555</span>,<span class=\"attr\">&quot;2064&quot;</span>:<span class=\"number\">1133556</span>,<span class=\"attr\">&quot;2065&quot;</span>:<span class=\"number\">1133557</span>,<span class=\"attr\">&quot;2066&quot;</span>:<span class=\"number\">1133558</span>,<span class=\"attr\">&quot;2068&quot;</span>:<span class=\"number\">1133559</span>,<span class=\"attr\">&quot;2069&quot;</span>:<span class=\"number\">1133560</span>,<span class=\"attr\">&quot;2070&quot;</span>:<span class=\"number\">1133561</span>,<span class=\"attr\">&quot;2071&quot;</span>:<span class=\"number\">1133562</span>,<span class=\"attr\">&quot;2072&quot;</span>:<span class=\"number\">1133563</span>,<span class=\"attr\">&quot;2073&quot;</span>:<span class=\"number\">1133564</span>,<span class=\"attr\">&quot;2074&quot;</span>:<span class=\"number\">1133565</span>,<span class=\"attr\">&quot;2075&quot;</span>:<span class=\"number\">1133566</span>,<span class=\"attr\">&quot;2076&quot;</span>:<span class=\"number\">1133567</span>,<span class=\"attr\">&quot;2077&quot;</span>:<span class=\"number\">1133568</span>,<span class=\"attr\">&quot;2078&quot;</span>:<span class=\"number\">1133569</span>,<span class=\"attr\">&quot;2079&quot;</span>:<span class=\"number\">1133570</span>,<span class=\"attr\">&quot;2080&quot;</span>:<span class=\"number\">1133571</span>,<span class=\"attr\">&quot;2082&quot;</span>:<span class=\"number\">1133572</span>,<span class=\"attr\">&quot;2083&quot;</span>:<span class=\"number\">1133573</span>,<span class=\"attr\">&quot;2084&quot;</span>:<span class=\"number\">1133574</span>,<span class=\"attr\">&quot;2094&quot;</span>:<span class=\"number\">1133575</span>,<span class=\"attr\">&quot;2095&quot;</span>:<span class=\"number\">1133576</span>,<span class=\"attr\">&quot;2096&quot;</span>:<span class=\"number\">1133577</span>,<span class=\"attr\">&quot;2097&quot;</span>:<span class=\"number\">1133578</span>,<span class=\"attr\">&quot;2098&quot;</span>:<span class=\"number\">1133579</span>,<span class=\"attr\">&quot;2099&quot;</span>:<span class=\"number\">1133580</span>,<span class=\"attr\">&quot;2100&quot;</span>:<span class=\"number\">1133581</span>,<span class=\"attr\">&quot;2101&quot;</span>:<span class=\"number\">1133582</span>,<span class=\"attr\">&quot;2105&quot;</span>:<span class=\"number\">1133583</span>,<span class=\"attr\">&quot;2106&quot;</span>:<span class=\"number\">1133584</span>,<span class=\"attr\">&quot;2107&quot;</span>:<span class=\"number\">1133585</span>,<span class=\"attr\">&quot;2108&quot;</span>:<span class=\"number\">1133586</span>,<span class=\"attr\">&quot;2110&quot;</span>:<span class=\"number\">1133587</span>,<span class=\"attr\">&quot;2111&quot;</span>:<span class=\"number\">1133588</span>,<span class=\"attr\">&quot;2113&quot;</span>:<span class=\"number\">1133589</span>,<span class=\"attr\">&quot;2114&quot;</span>:<span class=\"number\">1133590</span>,<span class=\"attr\">&quot;2115&quot;</span>:<span class=\"number\">1133591</span>,<span class=\"attr\">&quot;2116&quot;</span>:<span class=\"number\">1133592</span>,<span class=\"attr\">&quot;2117&quot;</span>:<span class=\"number\">1133593</span>,<span class=\"attr\">&quot;2118&quot;</span>:<span class=\"number\">1133594</span>,<span class=\"attr\">&quot;2119&quot;</span>:<span class=\"number\">1133595</span>,<span class=\"attr\">&quot;2120&quot;</span>:<span class=\"number\">1133596</span>,<span class=\"attr\">&quot;2122&quot;</span>:<span class=\"number\">1133597</span>,<span class=\"attr\">&quot;2123&quot;</span>:<span class=\"number\">1133598</span>,<span class=\"attr\">&quot;2124&quot;</span>:<span class=\"number\">1133599</span>,<span class=\"attr\">&quot;2125&quot;</span>:<span class=\"number\">1133600</span>,<span class=\"attr\">&quot;2126&quot;</span>:<span class=\"number\">1133601</span>,<span class=\"attr\">&quot;2127&quot;</span>:<span class=\"number\">1133602</span>,<span class=\"attr\">&quot;2128&quot;</span>:<span class=\"number\">1133603</span>,<span class=\"attr\">&quot;2129&quot;</span>:<span class=\"number\">1133604</span>,<span class=\"attr\">&quot;2130&quot;</span>:<span class=\"number\">1133605</span>,<span class=\"attr\">&quot;2131&quot;</span>:<span class=\"number\">1133606</span>,<span class=\"attr\">&quot;2132&quot;</span>:<span class=\"number\">1133607</span>,<span class=\"attr\">&quot;2135&quot;</span>:<span class=\"number\">1133608</span>,<span class=\"attr\">&quot;2136&quot;</span>:<span class=\"number\">1133609</span>,<span class=\"attr\">&quot;2137&quot;</span>:<span class=\"number\">1133610</span>,<span class=\"attr\">&quot;2138&quot;</span>:<span class=\"number\">1133611</span>,<span class=\"attr\">&quot;2139&quot;</span>:<span class=\"number\">1133612</span>,<span class=\"attr\">&quot;2141&quot;</span>:<span class=\"number\">1133613</span>,<span class=\"attr\">&quot;2142&quot;</span>:<span class=\"number\">1133614</span>,<span class=\"attr\">&quot;2143&quot;</span>:<span class=\"number\">1133615</span>,<span class=\"attr\">&quot;2144&quot;</span>:<span class=\"number\">1133616</span>,<span class=\"attr\">&quot;2145&quot;</span>:<span class=\"number\">1133617</span>,<span class=\"attr\">&quot;2146&quot;</span>:<span class=\"number\">1133618</span>,<span class=\"attr\">&quot;2147&quot;</span>:<span class=\"number\">1133619</span>,<span class=\"attr\">&quot;2148&quot;</span>:<span class=\"number\">1133620</span>,<span class=\"attr\">&quot;2149&quot;</span>:<span class=\"number\">1133621</span>,<span class=\"attr\">&quot;2150&quot;</span>:<span class=\"number\">1133622</span>,<span class=\"attr\">&quot;2151&quot;</span>:<span class=\"number\">1133623</span>,<span class=\"attr\">&quot;2153&quot;</span>:<span class=\"number\">1133624</span>,<span class=\"attr\">&quot;2154&quot;</span>:<span class=\"number\">1133625</span>,<span class=\"attr\">&quot;2155&quot;</span>:<span class=\"number\">1133626</span>,<span class=\"attr\">&quot;2156&quot;</span>:<span class=\"number\">1133627</span>,<span class=\"attr\">&quot;2157&quot;</span>:<span class=\"number\">1133628</span>,<span class=\"attr\">&quot;2158&quot;</span>:<span class=\"number\">1133629</span>,<span class=\"attr\">&quot;2159&quot;</span>:<span class=\"number\">1133630</span>,<span class=\"attr\">&quot;2160&quot;</span>:<span class=\"number\">1133631</span>,<span class=\"attr\">&quot;2161&quot;</span>:<span class=\"number\">1133632</span>,<span class=\"attr\">&quot;2163&quot;</span>:<span class=\"number\">1133633</span>,<span class=\"attr\">&quot;2164&quot;</span>:<span class=\"number\">1133634</span>,<span class=\"attr\">&quot;2165&quot;</span>:<span class=\"number\">1133635</span>,<span class=\"attr\">&quot;2166&quot;</span>:<span class=\"number\">1133636</span>,<span class=\"attr\">&quot;2167&quot;</span>:<span class=\"number\">1133637</span>,<span class=\"attr\">&quot;2168&quot;</span>:<span class=\"number\">1133638</span>,<span class=\"attr\">&quot;2169&quot;</span>:<span class=\"number\">1133639</span>,<span class=\"attr\">&quot;2170&quot;</span>:<span class=\"number\">1133640</span>,<span class=\"attr\">&quot;2171&quot;</span>:<span class=\"number\">1133641</span>,<span class=\"attr\">&quot;2172&quot;</span>:<span class=\"number\">1133642</span>,<span class=\"attr\">&quot;2173&quot;</span>:<span class=\"number\">1133643</span>,<span class=\"attr\">&quot;2174&quot;</span>:<span class=\"number\">1133644</span>,<span class=\"attr\">&quot;2175&quot;</span>:<span class=\"number\">1133645</span>,<span class=\"attr\">&quot;2177&quot;</span>:<span class=\"number\">1133646</span>,<span class=\"attr\">&quot;2178&quot;</span>:<span class=\"number\">1133647</span>,<span class=\"attr\">&quot;2179&quot;</span>:<span class=\"number\">1133648</span>,<span class=\"attr\">&quot;2189&quot;</span>:<span class=\"number\">1133649</span>,<span class=\"attr\">&quot;2190&quot;</span>:<span class=\"number\">1133650</span>,<span class=\"attr\">&quot;2191&quot;</span>:<span class=\"number\">1133651</span>,<span class=\"attr\">&quot;2192&quot;</span>:<span class=\"number\">1133652</span>,<span class=\"attr\">&quot;2193&quot;</span>:<span class=\"number\">1133653</span>,<span class=\"attr\">&quot;2194&quot;</span>:<span class=\"number\">1133654</span>,<span class=\"attr\">&quot;2195&quot;</span>:<span class=\"number\">1133655</span>,<span class=\"attr\">&quot;2196&quot;</span>:<span class=\"number\">1133656</span>,<span class=\"attr\">&quot;2200&quot;</span>:<span class=\"number\">1133657</span>,<span class=\"attr\">&quot;2201&quot;</span>:<span class=\"number\">1133658</span>,<span class=\"attr\">&quot;2202&quot;</span>:<span class=\"number\">1133659</span>,<span class=\"attr\">&quot;2203&quot;</span>:<span class=\"number\">1133660</span>,<span class=\"attr\">&quot;2205&quot;</span>:<span class=\"number\">1133661</span>,<span class=\"attr\">&quot;2206&quot;</span>:<span class=\"number\">1133662</span>,<span class=\"attr\">&quot;2208&quot;</span>:<span class=\"number\">1133663</span>,<span class=\"attr\">&quot;2209&quot;</span>:<span class=\"number\">1133664</span>,<span class=\"attr\">&quot;2210&quot;</span>:<span class=\"number\">1133665</span>,<span class=\"attr\">&quot;2211&quot;</span>:<span class=\"number\">1133666</span>,<span class=\"attr\">&quot;2212&quot;</span>:<span class=\"number\">1133667</span>,<span class=\"attr\">&quot;2214&quot;</span>:<span class=\"number\">1133668</span>,<span class=\"attr\">&quot;2215&quot;</span>:<span class=\"number\">1133669</span>,<span class=\"attr\">&quot;2216&quot;</span>:<span class=\"number\">1133670</span>,<span class=\"attr\">&quot;2217&quot;</span>:<span class=\"number\">1133671</span>,<span class=\"attr\">&quot;2218&quot;</span>:<span class=\"number\">1133672</span>,<span class=\"attr\">&quot;2219&quot;</span>:<span class=\"number\">1133673</span>,<span class=\"attr\">&quot;2220&quot;</span>:<span class=\"number\">1133674</span>,<span class=\"attr\">&quot;2221&quot;</span>:<span class=\"number\">1133675</span>,<span class=\"attr\">&quot;2222&quot;</span>:<span class=\"number\">1133676</span>,<span class=\"attr\">&quot;2223&quot;</span>:<span class=\"number\">1133677</span>,<span class=\"attr\">&quot;2224&quot;</span>:<span class=\"number\">1133678</span>,<span class=\"attr\">&quot;2227&quot;</span>:<span class=\"number\">1133679</span>,<span class=\"attr\">&quot;2228&quot;</span>:<span class=\"number\">1133680</span>,<span class=\"attr\">&quot;2229&quot;</span>:<span class=\"number\">1133681</span>,<span class=\"attr\">&quot;2230&quot;</span>:<span class=\"number\">1133682</span>,<span class=\"attr\">&quot;2231&quot;</span>:<span class=\"number\">1133683</span>,<span class=\"attr\">&quot;2233&quot;</span>:<span class=\"number\">1133684</span>,<span class=\"attr\">&quot;2234&quot;</span>:<span class=\"number\">1133685</span>,<span class=\"attr\">&quot;2235&quot;</span>:<span class=\"number\">1133686</span>,<span class=\"attr\">&quot;2236&quot;</span>:<span class=\"number\">1133687</span>,<span class=\"attr\">&quot;2237&quot;</span>:<span class=\"number\">1133688</span>,<span class=\"attr\">&quot;2238&quot;</span>:<span class=\"number\">1133689</span>,<span class=\"attr\">&quot;2239&quot;</span>:<span class=\"number\">1133690</span>,<span class=\"attr\">&quot;2240&quot;</span>:<span class=\"number\">1133691</span>,<span class=\"attr\">&quot;2241&quot;</span>:<span class=\"number\">1133692</span>,<span class=\"attr\">&quot;2242&quot;</span>:<span class=\"number\">1133693</span>,<span class=\"attr\">&quot;2243&quot;</span>:<span class=\"number\">1133694</span>,<span class=\"attr\">&quot;2245&quot;</span>:<span class=\"number\">1133695</span>,<span class=\"attr\">&quot;2246&quot;</span>:<span class=\"number\">1133696</span>,<span class=\"attr\">&quot;2247&quot;</span>:<span class=\"number\">1133697</span>,<span class=\"attr\">&quot;2248&quot;</span>:<span class=\"number\">1133698</span>,<span class=\"attr\">&quot;2249&quot;</span>:<span class=\"number\">1133699</span>,<span class=\"attr\">&quot;2250&quot;</span>:<span class=\"number\">1133700</span>,<span class=\"attr\">&quot;2251&quot;</span>:<span class=\"number\">1133701</span>,<span class=\"attr\">&quot;2252&quot;</span>:<span class=\"number\">1133702</span>,<span class=\"attr\">&quot;2253&quot;</span>:<span class=\"number\">1133703</span>,<span class=\"attr\">&quot;2255&quot;</span>:<span class=\"number\">1133704</span>,<span class=\"attr\">&quot;2256&quot;</span>:<span class=\"number\">1133705</span>,<span class=\"attr\">&quot;2257&quot;</span>:<span class=\"number\">1133706</span>,<span class=\"attr\">&quot;2258&quot;</span>:<span class=\"number\">1133707</span>,<span class=\"attr\">&quot;2259&quot;</span>:<span class=\"number\">1133708</span>,<span class=\"attr\">&quot;2260&quot;</span>:<span class=\"number\">1133709</span>,<span class=\"attr\">&quot;2261&quot;</span>:<span class=\"number\">1133710</span>,<span class=\"attr\">&quot;2262&quot;</span>:<span class=\"number\">1133711</span>,<span class=\"attr\">&quot;2263&quot;</span>:<span class=\"number\">1133712</span>,<span class=\"attr\">&quot;2264&quot;</span>:<span class=\"number\">1133713</span>,<span class=\"attr\">&quot;2265&quot;</span>:<span class=\"number\">1133714</span>,<span class=\"attr\">&quot;2266&quot;</span>:<span class=\"number\">1133715</span>,<span class=\"attr\">&quot;2267&quot;</span>:<span class=\"number\">1133716</span>,<span class=\"attr\">&quot;2269&quot;</span>:<span class=\"number\">1133717</span>,<span class=\"attr\">&quot;2270&quot;</span>:<span class=\"number\">1133718</span>,<span class=\"attr\">&quot;2271&quot;</span>:<span class=\"number\">1133719</span>,<span class=\"attr\">&quot;2273&quot;</span>:<span class=\"number\">1133720</span>,<span class=\"attr\">&quot;2278&quot;</span>:<span class=\"number\">1133721</span>,<span class=\"attr\">&quot;2280&quot;</span>:<span class=\"number\">1133722</span>,<span class=\"attr\">&quot;2298&quot;</span>:<span class=\"number\">1133723</span>,<span class=\"attr\">&quot;2299&quot;</span>:<span class=\"number\">1133724</span>,<span class=\"attr\">&quot;2300&quot;</span>:<span class=\"number\">1133725</span>,<span class=\"attr\">&quot;2301&quot;</span>:<span class=\"number\">1133726</span>,<span class=\"attr\">&quot;2302&quot;</span>:<span class=\"number\">1133727</span>,<span class=\"attr\">&quot;2303&quot;</span>:<span class=\"number\">1133728</span>,<span class=\"attr\">&quot;2304&quot;</span>:<span class=\"number\">1133729</span>,<span class=\"attr\">&quot;2305&quot;</span>:<span class=\"number\">1133730</span>,<span class=\"attr\">&quot;2309&quot;</span>:<span class=\"number\">1133731</span>,<span class=\"attr\">&quot;2310&quot;</span>:<span class=\"number\">1133732</span>,<span class=\"attr\">&quot;2311&quot;</span>:<span class=\"number\">1133733</span>,<span class=\"attr\">&quot;2312&quot;</span>:<span class=\"number\">1133734</span>,<span class=\"attr\">&quot;2314&quot;</span>:<span class=\"number\">1133735</span>,<span class=\"attr\">&quot;2315&quot;</span>:<span class=\"number\">1133736</span>,<span class=\"attr\">&quot;2317&quot;</span>:<span class=\"number\">1133737</span>,<span class=\"attr\">&quot;2318&quot;</span>:<span class=\"number\">1133738</span>,<span class=\"attr\">&quot;2319&quot;</span>:<span class=\"number\">1133739</span>,<span class=\"attr\">&quot;2320&quot;</span>:<span class=\"number\">1133740</span>,<span class=\"attr\">&quot;2321&quot;</span>:<span class=\"number\">1133741</span>,<span class=\"attr\">&quot;2322&quot;</span>:<span class=\"number\">1133742</span>,<span class=\"attr\">&quot;2323&quot;</span>:<span class=\"number\">1133743</span>,<span class=\"attr\">&quot;2324&quot;</span>:<span class=\"number\">1133744</span>,<span class=\"attr\">&quot;2326&quot;</span>:<span class=\"number\">1133745</span>,<span class=\"attr\">&quot;2327&quot;</span>:<span class=\"number\">1133746</span>,<span class=\"attr\">&quot;2328&quot;</span>:<span class=\"number\">1133747</span>,<span class=\"attr\">&quot;2329&quot;</span>:<span class=\"number\">1133748</span>,<span class=\"attr\">&quot;2330&quot;</span>:<span class=\"number\">1133749</span>,<span class=\"attr\">&quot;2331&quot;</span>:<span class=\"number\">1133750</span>,<span class=\"attr\">&quot;2332&quot;</span>:<span class=\"number\">1133751</span>,<span class=\"attr\">&quot;2333&quot;</span>:<span class=\"number\">1133752</span>,<span class=\"attr\">&quot;2334&quot;</span>:<span class=\"number\">1133753</span>,<span class=\"attr\">&quot;2335&quot;</span>:<span class=\"number\">1133754</span>,<span class=\"attr\">&quot;2336&quot;</span>:<span class=\"number\">1133755</span>,<span class=\"attr\">&quot;2339&quot;</span>:<span class=\"number\">1133756</span>,<span class=\"attr\">&quot;2340&quot;</span>:<span class=\"number\">1133757</span>,<span class=\"attr\">&quot;2341&quot;</span>:<span class=\"number\">1133758</span>,<span class=\"attr\">&quot;2342&quot;</span>:<span class=\"number\">1133759</span>,<span class=\"attr\">&quot;2343&quot;</span>:<span class=\"number\">1133760</span>,<span class=\"attr\">&quot;2345&quot;</span>:<span class=\"number\">1133761</span>,<span class=\"attr\">&quot;2346&quot;</span>:<span class=\"number\">1133762</span>,<span class=\"attr\">&quot;2347&quot;</span>:<span class=\"number\">1133763</span>,<span class=\"attr\">&quot;2348&quot;</span>:<span class=\"number\">1133764</span>,<span class=\"attr\">&quot;2349&quot;</span>:<span class=\"number\">1133765</span>,<span class=\"attr\">&quot;2350&quot;</span>:<span class=\"number\">1133766</span>,<span class=\"attr\">&quot;2351&quot;</span>:<span class=\"number\">1133767</span>,<span class=\"attr\">&quot;2352&quot;</span>:<span class=\"number\">1133768</span>,<span class=\"attr\">&quot;2353&quot;</span>:<span class=\"number\">1133769</span>,<span class=\"attr\">&quot;2354&quot;</span>:<span class=\"number\">1133770</span>,<span class=\"attr\">&quot;2355&quot;</span>:<span class=\"number\">1133771</span>,<span class=\"attr\">&quot;2357&quot;</span>:<span class=\"number\">1133772</span>,<span class=\"attr\">&quot;2358&quot;</span>:<span class=\"number\">1133773</span>,<span class=\"attr\">&quot;2359&quot;</span>:<span class=\"number\">1133774</span>,<span class=\"attr\">&quot;2360&quot;</span>:<span class=\"number\">1133775</span>,<span class=\"attr\">&quot;2361&quot;</span>:<span class=\"number\">1133776</span>,<span class=\"attr\">&quot;2362&quot;</span>:<span class=\"number\">1133777</span>,<span class=\"attr\">&quot;2363&quot;</span>:<span class=\"number\">1133778</span>,<span class=\"attr\">&quot;2364&quot;</span>:<span class=\"number\">1133779</span>,<span class=\"attr\">&quot;2365&quot;</span>:<span class=\"number\">1133780</span>,<span class=\"attr\">&quot;2367&quot;</span>:<span class=\"number\">1133781</span>,<span class=\"attr\">&quot;2368&quot;</span>:<span class=\"number\">1133782</span>,<span class=\"attr\">&quot;2369&quot;</span>:<span class=\"number\">1133783</span>,<span class=\"attr\">&quot;2370&quot;</span>:<span class=\"number\">1133784</span>,<span class=\"attr\">&quot;2371&quot;</span>:<span class=\"number\">1133785</span>,<span class=\"attr\">&quot;2372&quot;</span>:<span class=\"number\">1133786</span>,<span class=\"attr\">&quot;2373&quot;</span>:<span class=\"number\">1133787</span>,<span class=\"attr\">&quot;2374&quot;</span>:<span class=\"number\">1133788</span>,<span class=\"attr\">&quot;2375&quot;</span>:<span class=\"number\">1133789</span>,<span class=\"attr\">&quot;2376&quot;</span>:<span class=\"number\">1133790</span>,<span class=\"attr\">&quot;2377&quot;</span>:<span class=\"number\">1133791</span>,<span class=\"attr\">&quot;2378&quot;</span>:<span class=\"number\">1133792</span>,<span class=\"attr\">&quot;2379&quot;</span>:<span class=\"number\">1133793</span>,<span class=\"attr\">&quot;2381&quot;</span>:<span class=\"number\">1133794</span>,<span class=\"attr\">&quot;2382&quot;</span>:<span class=\"number\">1133795</span>,<span class=\"attr\">&quot;2383&quot;</span>:<span class=\"number\">1133796</span>,<span class=\"attr\">&quot;2405&quot;</span>:<span class=\"number\">1133797</span>,<span class=\"attr\">&quot;2406&quot;</span>:<span class=\"number\">1133798</span>,<span class=\"attr\">&quot;2407&quot;</span>:<span class=\"number\">1133799</span>,<span class=\"attr\">&quot;2408&quot;</span>:<span class=\"number\">1133800</span>,<span class=\"attr\">&quot;2409&quot;</span>:<span class=\"number\">1133801</span>,<span class=\"attr\">&quot;2410&quot;</span>:<span class=\"number\">1133802</span>,<span class=\"attr\">&quot;2411&quot;</span>:<span class=\"number\">1133803</span>,<span class=\"attr\">&quot;2412&quot;</span>:<span class=\"number\">1133804</span>,<span class=\"attr\">&quot;2416&quot;</span>:<span class=\"number\">1133805</span>,<span class=\"attr\">&quot;2417&quot;</span>:<span class=\"number\">1133806</span>,<span class=\"attr\">&quot;2418&quot;</span>:<span class=\"number\">1133807</span>,<span class=\"attr\">&quot;2419&quot;</span>:<span class=\"number\">1133808</span>,<span class=\"attr\">&quot;2421&quot;</span>:<span class=\"number\">1133809</span>,<span class=\"attr\">&quot;2422&quot;</span>:<span class=\"number\">1133810</span>,<span class=\"attr\">&quot;2424&quot;</span>:<span class=\"number\">1133811</span>,<span class=\"attr\">&quot;2425&quot;</span>:<span class=\"number\">1133812</span>,<span class=\"attr\">&quot;2426&quot;</span>:<span class=\"number\">1133813</span>,<span class=\"attr\">&quot;2427&quot;</span>:<span class=\"number\">1133814</span>,<span class=\"attr\">&quot;2428&quot;</span>:<span class=\"number\">1133815</span>,<span class=\"attr\">&quot;2429&quot;</span>:<span class=\"number\">1133816</span>,<span class=\"attr\">&quot;2430&quot;</span>:<span class=\"number\">1133817</span>,<span class=\"attr\">&quot;2431&quot;</span>:<span class=\"number\">1133818</span>,<span class=\"attr\">&quot;2433&quot;</span>:<span class=\"number\">1133819</span>,<span class=\"attr\">&quot;2434&quot;</span>:<span class=\"number\">1133820</span>,<span class=\"attr\">&quot;2435&quot;</span>:<span class=\"number\">1133821</span>,<span class=\"attr\">&quot;2436&quot;</span>:<span class=\"number\">1133822</span>,<span class=\"attr\">&quot;2437&quot;</span>:<span class=\"number\">1133823</span>,<span class=\"attr\">&quot;2438&quot;</span>:<span class=\"number\">1133824</span>,<span class=\"attr\">&quot;2439&quot;</span>:<span class=\"number\">1133825</span>,<span class=\"attr\">&quot;2440&quot;</span>:<span class=\"number\">1133826</span>,<span class=\"attr\">&quot;2441&quot;</span>:<span class=\"number\">1133827</span>,<span class=\"attr\">&quot;2442&quot;</span>:<span class=\"number\">1133828</span>,<span class=\"attr\">&quot;2443&quot;</span>:<span class=\"number\">1133829</span>,<span class=\"attr\">&quot;2446&quot;</span>:<span class=\"number\">1133830</span>,<span class=\"attr\">&quot;2447&quot;</span>:<span class=\"number\">1133831</span>,<span class=\"attr\">&quot;2448&quot;</span>:<span class=\"number\">1133832</span>,<span class=\"attr\">&quot;2449&quot;</span>:<span class=\"number\">1133833</span>,<span class=\"attr\">&quot;2450&quot;</span>:<span class=\"number\">1133834</span>,<span class=\"attr\">&quot;2452&quot;</span>:<span class=\"number\">1133835</span>,<span class=\"attr\">&quot;2453&quot;</span>:<span class=\"number\">1133836</span>,<span class=\"attr\">&quot;2454&quot;</span>:<span class=\"number\">1133837</span>,<span class=\"attr\">&quot;2455&quot;</span>:<span class=\"number\">1133838</span>,<span class=\"attr\">&quot;2456&quot;</span>:<span class=\"number\">1133839</span>,<span class=\"attr\">&quot;2457&quot;</span>:<span class=\"number\">1133840</span>,<span class=\"attr\">&quot;2458&quot;</span>:<span class=\"number\">1133841</span>,<span class=\"attr\">&quot;2459&quot;</span>:<span class=\"number\">1133842</span>,<span class=\"attr\">&quot;2460&quot;</span>:<span class=\"number\">1133843</span>,<span class=\"attr\">&quot;2461&quot;</span>:<span class=\"number\">1133844</span>,<span class=\"attr\">&quot;2462&quot;</span>:<span class=\"number\">1133845</span>,<span class=\"attr\">&quot;2464&quot;</span>:<span class=\"number\">1133846</span>,<span class=\"attr\">&quot;2465&quot;</span>:<span class=\"number\">1133847</span>,<span class=\"attr\">&quot;2466&quot;</span>:<span class=\"number\">1133848</span>,<span class=\"attr\">&quot;2467&quot;</span>:<span class=\"number\">1133849</span>,<span class=\"attr\">&quot;2468&quot;</span>:<span class=\"number\">1133850</span>,<span class=\"attr\">&quot;2469&quot;</span>:<span class=\"number\">1133851</span>,<span class=\"attr\">&quot;2470&quot;</span>:<span class=\"number\">1133852</span>,<span class=\"attr\">&quot;2471&quot;</span>:<span class=\"number\">1133853</span>,<span class=\"attr\">&quot;2472&quot;</span>:<span class=\"number\">1133854</span>,<span class=\"attr\">&quot;2474&quot;</span>:<span class=\"number\">1133855</span>,<span class=\"attr\">&quot;2475&quot;</span>:<span class=\"number\">1133856</span>,<span class=\"attr\">&quot;2476&quot;</span>:<span class=\"number\">1133857</span>,<span class=\"attr\">&quot;2477&quot;</span>:<span class=\"number\">1133858</span>,<span class=\"attr\">&quot;2478&quot;</span>:<span class=\"number\">1133859</span>,<span class=\"attr\">&quot;2479&quot;</span>:<span class=\"number\">1133860</span>,<span class=\"attr\">&quot;2480&quot;</span>:<span class=\"number\">1133861</span>,<span class=\"attr\">&quot;2481&quot;</span>:<span class=\"number\">1133862</span>,<span class=\"attr\">&quot;2482&quot;</span>:<span class=\"number\">1133863</span>,<span class=\"attr\">&quot;2483&quot;</span>:<span class=\"number\">1133864</span>,<span class=\"attr\">&quot;2484&quot;</span>:<span class=\"number\">1133865</span>,<span class=\"attr\">&quot;2485&quot;</span>:<span class=\"number\">1133866</span>,<span class=\"attr\">&quot;2486&quot;</span>:<span class=\"number\">1133867</span>,<span class=\"attr\">&quot;2488&quot;</span>:<span class=\"number\">1133868</span>,<span class=\"attr\">&quot;2489&quot;</span>:<span class=\"number\">1133869</span>,<span class=\"attr\">&quot;2490&quot;</span>:<span class=\"number\">1133870</span>,<span class=\"attr\">&quot;2509&quot;</span>:<span class=\"number\">1133871</span>,<span class=\"attr\">&quot;2510&quot;</span>:<span class=\"number\">1133872</span>,<span class=\"attr\">&quot;2515&quot;</span>:<span class=\"number\">1133873</span>,<span class=\"attr\">&quot;2528&quot;</span>:<span class=\"number\">1133874</span>,<span class=\"attr\">&quot;2529&quot;</span>:<span class=\"number\">1133875</span>,<span class=\"attr\">&quot;1622&quot;</span>:<span class=\"number\">1133876</span>,<span class=\"attr\">&quot;1623&quot;</span>:<span class=\"number\">1133877</span>,<span class=\"attr\">&quot;1624&quot;</span>:<span class=\"number\">1133878</span>,<span class=\"attr\">&quot;1625&quot;</span>:<span class=\"number\">1133879</span>,<span class=\"attr\">&quot;1626&quot;</span>:<span class=\"number\">1133880</span>,<span class=\"attr\">&quot;1627&quot;</span>:<span class=\"number\">1133881</span>,<span class=\"attr\">&quot;1628&quot;</span>:<span class=\"number\">1133882</span>,<span class=\"attr\">&quot;1629&quot;</span>:<span class=\"number\">1133883</span>,<span class=\"attr\">&quot;1633&quot;</span>:<span class=\"number\">1133884</span>,<span class=\"attr\">&quot;1634&quot;</span>:<span class=\"number\">1133885</span>,<span class=\"attr\">&quot;1635&quot;</span>:<span class=\"number\">1133886</span>,<span class=\"attr\">&quot;1636&quot;</span>:<span class=\"number\">1133887</span>,<span class=\"attr\">&quot;1638&quot;</span>:<span class=\"number\">1133888</span>,<span class=\"attr\">&quot;1639&quot;</span>:<span class=\"number\">1133889</span>,<span class=\"attr\">&quot;1641&quot;</span>:<span class=\"number\">1133890</span>,<span class=\"attr\">&quot;1642&quot;</span>:<span class=\"number\">1133891</span>,<span class=\"attr\">&quot;1643&quot;</span>:<span class=\"number\">1133892</span>,<span class=\"attr\">&quot;1644&quot;</span>:<span class=\"number\">1133893</span>,<span class=\"attr\">&quot;1645&quot;</span>:<span class=\"number\">1133894</span>,<span class=\"attr\">&quot;1646&quot;</span>:<span class=\"number\">1133895</span>,<span class=\"attr\">&quot;1647&quot;</span>:<span class=\"number\">1133896</span>,<span class=\"attr\">&quot;1648&quot;</span>:<span class=\"number\">1133897</span>,<span class=\"attr\">&quot;1650&quot;</span>:<span class=\"number\">1133898</span>,<span class=\"attr\">&quot;1651&quot;</span>:<span class=\"number\">1133899</span>,<span class=\"attr\">&quot;1652&quot;</span>:<span class=\"number\">1133900</span>,<span class=\"attr\">&quot;1653&quot;</span>:<span class=\"number\">1133901</span>,<span class=\"attr\">&quot;1654&quot;</span>:<span class=\"number\">1133902</span>,<span class=\"attr\">&quot;1655&quot;</span>:<span class=\"number\">1133903</span>,<span class=\"attr\">&quot;1656&quot;</span>:<span class=\"number\">1133904</span>,<span class=\"attr\">&quot;1657&quot;</span>:<span class=\"number\">1133905</span>,<span class=\"attr\">&quot;1658&quot;</span>:<span class=\"number\">1133906</span>,<span class=\"attr\">&quot;1659&quot;</span>:<span class=\"number\">1133907</span>,<span class=\"attr\">&quot;1660&quot;</span>:<span class=\"number\">1133908</span>,<span class=\"attr\">&quot;1663&quot;</span>:<span class=\"number\">1133909</span>,<span class=\"attr\">&quot;1664&quot;</span>:<span class=\"number\">1133910</span>,<span class=\"attr\">&quot;1665&quot;</span>:<span class=\"number\">1133911</span>,<span class=\"attr\">&quot;1666&quot;</span>:<span class=\"number\">1133912</span>,<span class=\"attr\">&quot;1667&quot;</span>:<span class=\"number\">1133913</span>,<span class=\"attr\">&quot;1669&quot;</span>:<span class=\"number\">1133914</span>,<span class=\"attr\">&quot;1670&quot;</span>:<span class=\"number\">1133915</span>,<span class=\"attr\">&quot;1683&quot;</span>:<span class=\"number\">1133916</span>,<span class=\"attr\">&quot;1684&quot;</span>:<span class=\"number\">1133917</span>,<span class=\"attr\">&quot;1685&quot;</span>:<span class=\"number\">1133918</span>,<span class=\"attr\">&quot;1686&quot;</span>:<span class=\"number\">1133919</span>,<span class=\"attr\">&quot;1687&quot;</span>:<span class=\"number\">1133920</span>,<span class=\"attr\">&quot;1688&quot;</span>:<span class=\"number\">1133921</span>,<span class=\"attr\">&quot;1689&quot;</span>:<span class=\"number\">1133922</span>,<span class=\"attr\">&quot;1690&quot;</span>:<span class=\"number\">1133923</span>,<span class=\"attr\">&quot;1691&quot;</span>:<span class=\"number\">1133924</span>,<span class=\"attr\">&quot;1693&quot;</span>:<span class=\"number\">1133925</span>,<span class=\"attr\">&quot;1694&quot;</span>:<span class=\"number\">1133926</span>,<span class=\"attr\">&quot;1695&quot;</span>:<span class=\"number\">1133927</span>,<span class=\"attr\">&quot;1696&quot;</span>:<span class=\"number\">1133928</span>,<span class=\"attr\">&quot;1698&quot;</span>:<span class=\"number\">1133929</span>,<span class=\"attr\">&quot;1699&quot;</span>:<span class=\"number\">1133930</span>,<span class=\"attr\">&quot;1700&quot;</span>:<span class=\"number\">1133931</span>,<span class=\"attr\">&quot;1701&quot;</span>:<span class=\"number\">1133932</span>,<span class=\"attr\">&quot;1702&quot;</span>:<span class=\"number\">1133933</span>,<span class=\"attr\">&quot;1704&quot;</span>:<span class=\"number\">1133934</span>,<span class=\"attr\">&quot;1705&quot;</span>:<span class=\"number\">1133935</span>,<span class=\"attr\">&quot;1706&quot;</span>:<span class=\"number\">1133936</span>,<span class=\"attr\">&quot;1707&quot;</span>:<span class=\"number\">1133937</span>,<span class=\"attr\">&quot;1708&quot;</span>:<span class=\"number\">1133938</span>,<span class=\"attr\">&quot;1709&quot;</span>:<span class=\"number\">1133939</span>,<span class=\"attr\">&quot;1710&quot;</span>:<span class=\"number\">1133940</span>,<span class=\"attr\">&quot;1711&quot;</span>:<span class=\"number\">1133941</span>,<span class=\"attr\">&quot;1712&quot;</span>:<span class=\"number\">1133942</span>,<span class=\"attr\">&quot;1713&quot;</span>:<span class=\"number\">1133943</span>,<span class=\"attr\">&quot;1714&quot;</span>:<span class=\"number\">1133944</span>,<span class=\"attr\">&quot;1715&quot;</span>:<span class=\"number\">1133945</span>,<span class=\"attr\">&quot;1716&quot;</span>:<span class=\"number\">1133946</span>,<span class=\"attr\">&quot;1718&quot;</span>:<span class=\"number\">1133947</span>,<span class=\"attr\">&quot;1719&quot;</span>:<span class=\"number\">1133948</span>,<span class=\"attr\">&quot;1720&quot;</span>:<span class=\"number\">1133949</span>,<span class=\"attr\">&quot;1783&quot;</span>:<span class=\"number\">1133950</span>,<span class=\"attr\">&quot;1784&quot;</span>:<span class=\"number\">1133951</span>,<span class=\"attr\">&quot;1785&quot;</span>:<span class=\"number\">1133952</span>,<span class=\"attr\">&quot;1786&quot;</span>:<span class=\"number\">1133953</span>,<span class=\"attr\">&quot;1787&quot;</span>:<span class=\"number\">1133954</span>,<span class=\"attr\">&quot;1788&quot;</span>:<span class=\"number\">1133955</span>,<span class=\"attr\">&quot;1789&quot;</span>:<span class=\"number\">1133956</span>,<span class=\"attr\">&quot;1790&quot;</span>:<span class=\"number\">1133957</span>,<span class=\"attr\">&quot;1794&quot;</span>:<span class=\"number\">1133958</span>,<span class=\"attr\">&quot;1795&quot;</span>:<span class=\"number\">1133959</span>,<span class=\"attr\">&quot;1796&quot;</span>:<span class=\"number\">1133960</span>,<span class=\"attr\">&quot;1797&quot;</span>:<span class=\"number\">1133961</span>,<span class=\"attr\">&quot;1799&quot;</span>:<span class=\"number\">1133962</span>,<span class=\"attr\">&quot;1800&quot;</span>:<span class=\"number\">1133963</span>,<span class=\"attr\">&quot;1805&quot;</span>:<span class=\"number\">1133964</span>,<span class=\"attr\">&quot;1806&quot;</span>:<span class=\"number\">1133965</span>,<span class=\"attr\">&quot;1807&quot;</span>:<span class=\"number\">1133966</span>,<span class=\"attr\">&quot;1808&quot;</span>:<span class=\"number\">1133967</span>,<span class=\"attr\">&quot;1809&quot;</span>:<span class=\"number\">1133968</span>,<span class=\"attr\">&quot;1811&quot;</span>:<span class=\"number\">1133969</span>,<span class=\"attr\">&quot;1812&quot;</span>:<span class=\"number\">1133970</span>,<span class=\"attr\">&quot;1813&quot;</span>:<span class=\"number\">1133971</span>,<span class=\"attr\">&quot;1814&quot;</span>:<span class=\"number\">1133972</span>,<span class=\"attr\">&quot;1815&quot;</span>:<span class=\"number\">1133973</span>,<span class=\"attr\">&quot;1816&quot;</span>:<span class=\"number\">1133974</span>,<span class=\"attr\">&quot;1817&quot;</span>:<span class=\"number\">1133975</span>,<span class=\"attr\">&quot;1818&quot;</span>:<span class=\"number\">1133976</span>,<span class=\"attr\">&quot;1819&quot;</span>:<span class=\"number\">1133977</span>,<span class=\"attr\">&quot;1820&quot;</span>:<span class=\"number\">1133978</span>,<span class=\"attr\">&quot;1821&quot;</span>:<span class=\"number\">1133979</span>,<span class=\"attr\">&quot;1824&quot;</span>:<span class=\"number\">1133980</span>,<span class=\"attr\">&quot;1825&quot;</span>:<span class=\"number\">1133981</span>,<span class=\"attr\">&quot;1826&quot;</span>:<span class=\"number\">1133982</span>,<span class=\"attr\">&quot;1827&quot;</span>:<span class=\"number\">1133983</span>,<span class=\"attr\">&quot;1828&quot;</span>:<span class=\"number\">1133984</span>,<span class=\"attr\">&quot;1830&quot;</span>:<span class=\"number\">1133985</span>,<span class=\"attr\">&quot;1831&quot;</span>:<span class=\"number\">1133986</span>,<span class=\"attr\">&quot;1832&quot;</span>:<span class=\"number\">1133987</span>,<span class=\"attr\">&quot;1833&quot;</span>:<span class=\"number\">1133988</span>,<span class=\"attr\">&quot;1834&quot;</span>:<span class=\"number\">1133989</span>,<span class=\"attr\">&quot;1835&quot;</span>:<span class=\"number\">1133990</span>,<span class=\"attr\">&quot;1836&quot;</span>:<span class=\"number\">1133991</span>,<span class=\"attr\">&quot;1837&quot;</span>:<span class=\"number\">1133992</span>,<span class=\"attr\">&quot;1838&quot;</span>:<span class=\"number\">1133993</span>,<span class=\"attr\">&quot;1839&quot;</span>:<span class=\"number\">1133994</span>,<span class=\"attr\">&quot;1840&quot;</span>:<span class=\"number\">1133995</span>,<span class=\"attr\">&quot;1842&quot;</span>:<span class=\"number\">1133996</span>,<span class=\"attr\">&quot;1843&quot;</span>:<span class=\"number\">1133997</span>,<span class=\"attr\">&quot;1844&quot;</span>:<span class=\"number\">1133998</span>,<span class=\"attr\">&quot;1845&quot;</span>:<span class=\"number\">1133999</span>,<span class=\"attr\">&quot;1846&quot;</span>:<span class=\"number\">1134000</span>,<span class=\"attr\">&quot;1847&quot;</span>:<span class=\"number\">1134001</span>,<span class=\"attr\">&quot;1848&quot;</span>:<span class=\"number\">1134002</span>,<span class=\"attr\">&quot;1849&quot;</span>:<span class=\"number\">1134003</span>,<span class=\"attr\">&quot;1850&quot;</span>:<span class=\"number\">1134004</span>,<span class=\"attr\">&quot;1852&quot;</span>:<span class=\"number\">1134005</span>,<span class=\"attr\">&quot;1853&quot;</span>:<span class=\"number\">1134006</span>,<span class=\"attr\">&quot;1854&quot;</span>:<span class=\"number\">1134007</span>,<span class=\"attr\">&quot;1855&quot;</span>:<span class=\"number\">1134008</span>,<span class=\"attr\">&quot;1856&quot;</span>:<span class=\"number\">1134009</span>,<span class=\"attr\">&quot;1857&quot;</span>:<span class=\"number\">1134010</span>,<span class=\"attr\">&quot;1858&quot;</span>:<span class=\"number\">1134011</span>,<span class=\"attr\">&quot;1859&quot;</span>:<span class=\"number\">1134012</span>,<span class=\"attr\">&quot;1860&quot;</span>:<span class=\"number\">1134013</span>,<span class=\"attr\">&quot;1861&quot;</span>:<span class=\"number\">1134014</span>,<span class=\"attr\">&quot;1862&quot;</span>:<span class=\"number\">1134015</span>,<span class=\"attr\">&quot;1863&quot;</span>:<span class=\"number\">1134016</span>,<span class=\"attr\">&quot;1864&quot;</span>:<span class=\"number\">1134017</span>,<span class=\"attr\">&quot;1866&quot;</span>:<span class=\"number\">1134018</span>,<span class=\"attr\">&quot;1867&quot;</span>:<span class=\"number\">1134019</span>,<span class=\"attr\">&quot;1868&quot;</span>:<span class=\"number\">1134020</span>,<span class=\"attr\">&quot;1884&quot;</span>:<span class=\"number\">1134021</span>,<span class=\"attr\">&quot;1885&quot;</span>:<span class=\"number\">1134022</span>,<span class=\"attr\">&quot;1886&quot;</span>:<span class=\"number\">1134023</span>,<span class=\"attr\">&quot;1887&quot;</span>:<span class=\"number\">1134024</span>,<span class=\"attr\">&quot;1888&quot;</span>:<span class=\"number\">1134025</span>,<span class=\"attr\">&quot;1889&quot;</span>:<span class=\"number\">1134026</span>,<span class=\"attr\">&quot;1890&quot;</span>:<span class=\"number\">1134027</span>,<span class=\"attr\">&quot;1891&quot;</span>:<span class=\"number\">1134028</span>,<span class=\"attr\">&quot;1895&quot;</span>:<span class=\"number\">1134029</span>,<span class=\"attr\">&quot;1896&quot;</span>:<span class=\"number\">1134030</span>,<span class=\"attr\">&quot;1897&quot;</span>:<span class=\"number\">1134031</span>,<span class=\"attr\">&quot;1898&quot;</span>:<span class=\"number\">1134032</span>,<span class=\"attr\">&quot;1900&quot;</span>:<span class=\"number\">1134033</span>,<span class=\"attr\">&quot;1901&quot;</span>:<span class=\"number\">1134034</span>,<span class=\"attr\">&quot;1903&quot;</span>:<span class=\"number\">1134035</span>,<span class=\"attr\">&quot;1904&quot;</span>:<span class=\"number\">1134036</span>,<span class=\"attr\">&quot;1905&quot;</span>:<span class=\"number\">1134037</span>,<span class=\"attr\">&quot;1906&quot;</span>:<span class=\"number\">1134038</span>,<span class=\"attr\">&quot;1907&quot;</span>:<span class=\"number\">1134039</span>,<span class=\"attr\">&quot;1908&quot;</span>:<span class=\"number\">1134040</span>,<span class=\"attr\">&quot;1909&quot;</span>:<span class=\"number\">1134041</span>,<span class=\"attr\">&quot;1910&quot;</span>:<span class=\"number\">1134042</span>,<span class=\"attr\">&quot;1912&quot;</span>:<span class=\"number\">1134043</span>,<span class=\"attr\">&quot;1913&quot;</span>:<span class=\"number\">1134044</span>,<span class=\"attr\">&quot;1914&quot;</span>:<span class=\"number\">1134045</span>,<span class=\"attr\">&quot;1915&quot;</span>:<span class=\"number\">1134046</span>,<span class=\"attr\">&quot;1916&quot;</span>:<span class=\"number\">1134047</span>,<span class=\"attr\">&quot;1917&quot;</span>:<span class=\"number\">1134048</span>,<span class=\"attr\">&quot;1918&quot;</span>:<span class=\"number\">1134049</span>,<span class=\"attr\">&quot;1919&quot;</span>:<span class=\"number\">1134050</span>,<span class=\"attr\">&quot;1920&quot;</span>:<span class=\"number\">1134051</span>,<span class=\"attr\">&quot;1921&quot;</span>:<span class=\"number\">1134052</span>,<span class=\"attr\">&quot;1922&quot;</span>:<span class=\"number\">1134053</span>,<span class=\"attr\">&quot;1925&quot;</span>:<span class=\"number\">1134054</span>,<span class=\"attr\">&quot;1926&quot;</span>:<span class=\"number\">1134055</span>,<span class=\"attr\">&quot;1927&quot;</span>:<span class=\"number\">1134056</span>,<span class=\"attr\">&quot;1928&quot;</span>:<span class=\"number\">1134057</span>,<span class=\"attr\">&quot;1929&quot;</span>:<span class=\"number\">1134058</span>,<span class=\"attr\">&quot;1931&quot;</span>:<span class=\"number\">1134059</span>,<span class=\"attr\">&quot;1932&quot;</span>:<span class=\"number\">1134060</span>,<span class=\"attr\">&quot;1933&quot;</span>:<span class=\"number\">1134061</span>,<span class=\"attr\">&quot;1934&quot;</span>:<span class=\"number\">1134062</span>,<span class=\"attr\">&quot;1935&quot;</span>:<span class=\"number\">1134063</span>,<span class=\"attr\">&quot;1936&quot;</span>:<span class=\"number\">1134064</span>,<span class=\"attr\">&quot;1937&quot;</span>:<span class=\"number\">1134065</span>,<span class=\"attr\">&quot;1938&quot;</span>:<span class=\"number\">1134066</span>,<span class=\"attr\">&quot;1939&quot;</span>:<span class=\"number\">1134067</span>,<span class=\"attr\">&quot;1940&quot;</span>:<span class=\"number\">1134068</span>,<span class=\"attr\">&quot;1941&quot;</span>:<span class=\"number\">1134069</span>,<span class=\"attr\">&quot;1943&quot;</span>:<span class=\"number\">1134070</span>,<span class=\"attr\">&quot;1944&quot;</span>:<span class=\"number\">1134071</span>,<span class=\"attr\">&quot;1945&quot;</span>:<span class=\"number\">1134072</span>,<span class=\"attr\">&quot;1946&quot;</span>:<span class=\"number\">1134073</span>,<span class=\"attr\">&quot;1947&quot;</span>:<span class=\"number\">1134074</span>,<span class=\"attr\">&quot;1948&quot;</span>:<span class=\"number\">1134075</span>,<span class=\"attr\">&quot;1949&quot;</span>:<span class=\"number\">1134076</span>,<span class=\"attr\">&quot;1950&quot;</span>:<span class=\"number\">1134077</span>,<span class=\"attr\">&quot;1951&quot;</span>:<span class=\"number\">1134078</span>,<span class=\"attr\">&quot;1953&quot;</span>:<span class=\"number\">1134079</span>,<span class=\"attr\">&quot;1954&quot;</span>:<span class=\"number\">1134080</span>,<span class=\"attr\">&quot;1955&quot;</span>:<span class=\"number\">1134081</span>,<span class=\"attr\">&quot;1956&quot;</span>:<span class=\"number\">1134082</span>,<span class=\"attr\">&quot;1957&quot;</span>:<span class=\"number\">1134083</span>,<span class=\"attr\">&quot;1958&quot;</span>:<span class=\"number\">1134084</span>,<span class=\"attr\">&quot;1959&quot;</span>:<span class=\"number\">1134085</span>,<span class=\"attr\">&quot;1960&quot;</span>:<span class=\"number\">1134086</span>,<span class=\"attr\">&quot;1961&quot;</span>:<span class=\"number\">1134087</span>,<span class=\"attr\">&quot;1962&quot;</span>:<span class=\"number\">1134088</span>,<span class=\"attr\">&quot;1963&quot;</span>:<span class=\"number\">1134089</span>,<span class=\"attr\">&quot;1964&quot;</span>:<span class=\"number\">1134090</span>,<span class=\"attr\">&quot;1965&quot;</span>:<span class=\"number\">1134091</span>,<span class=\"attr\">&quot;1967&quot;</span>:<span class=\"number\">1134092</span>,<span class=\"attr\">&quot;1968&quot;</span>:<span class=\"number\">1134093</span>,<span class=\"attr\">&quot;1969&quot;</span>:<span class=\"number\">1134094</span>,<span class=\"attr\">&quot;1999&quot;</span>:<span class=\"number\">1134095</span>,<span class=\"attr\">&quot;2000&quot;</span>:<span class=\"number\">1134096</span>,<span class=\"attr\">&quot;2001&quot;</span>:<span class=\"number\">1134097</span>,<span class=\"attr\">&quot;2002&quot;</span>:<span class=\"number\">1134098</span>,<span class=\"attr\">&quot;2003&quot;</span>:<span class=\"number\">1134099</span>,<span class=\"attr\">&quot;2004&quot;</span>:<span class=\"number\">1134100</span>,<span class=\"attr\">&quot;2005&quot;</span>:<span class=\"number\">1134101</span>,<span class=\"attr\">&quot;2006&quot;</span>:<span class=\"number\">1134102</span>,<span class=\"attr\">&quot;2010&quot;</span>:<span class=\"number\">1134103</span>,<span class=\"attr\">&quot;2011&quot;</span>:<span class=\"number\">1134104</span>,<span class=\"attr\">&quot;2012&quot;</span>:<span class=\"number\">1134105</span>,<span class=\"attr\">&quot;2013&quot;</span>:<span class=\"number\">1134106</span>,<span class=\"attr\">&quot;2015&quot;</span>:<span class=\"number\">1134107</span>,<span class=\"attr\">&quot;2016&quot;</span>:<span class=\"number\">1134108</span>,<span class=\"attr\">&quot;2018&quot;</span>:<span class=\"number\">1134109</span>,<span class=\"attr\">&quot;2019&quot;</span>:<span class=\"number\">1134110</span>,<span class=\"attr\">&quot;2020&quot;</span>:<span class=\"number\">1134111</span>,<span class=\"attr\">&quot;2021&quot;</span>:<span class=\"number\">1134112</span>,<span class=\"attr\">&quot;2022&quot;</span>:<span class=\"number\">1134113</span>,<span class=\"attr\">&quot;2023&quot;</span>:<span class=\"number\">1134114</span>,<span class=\"attr\">&quot;2024&quot;</span>:<span class=\"number\">1134115</span>,<span class=\"attr\">&quot;2025&quot;</span>:<span class=\"number\">1134116</span>,<span class=\"attr\">&quot;2027&quot;</span>:<span class=\"number\">1134117</span>,<span class=\"attr\">&quot;2028&quot;</span>:<span class=\"number\">1134118</span>,<span class=\"attr\">&quot;2029&quot;</span>:<span class=\"number\">1134119</span>,<span class=\"attr\">&quot;2030&quot;</span>:<span class=\"number\">1134120</span>,<span class=\"attr\">&quot;2031&quot;</span>:<span class=\"number\">1134121</span>,<span class=\"attr\">&quot;2032&quot;</span>:<span class=\"number\">1134122</span>,<span class=\"attr\">&quot;2033&quot;</span>:<span class=\"number\">1134123</span>,<span class=\"attr\">&quot;2034&quot;</span>:<span class=\"number\">1134124</span>,<span class=\"attr\">&quot;2035&quot;</span>:<span class=\"number\">1134125</span>,<span class=\"attr\">&quot;2036&quot;</span>:<span class=\"number\">1134126</span>,<span class=\"attr\">&quot;2037&quot;</span>:<span class=\"number\">1134127</span>,<span class=\"attr\">&quot;2040&quot;</span>:<span class=\"number\">1134128</span>,<span class=\"attr\">&quot;2041&quot;</span>:<span class=\"number\">1134129</span>,<span class=\"attr\">&quot;2042&quot;</span>:<span class=\"number\">1134130</span>,<span class=\"attr\">&quot;2043&quot;</span>:<span class=\"number\">1134131</span>,<span class=\"attr\">&quot;2044&quot;</span>:<span class=\"number\">1134132</span>,<span class=\"attr\">&quot;2046&quot;</span>:<span class=\"number\">1134133</span>,<span class=\"attr\">&quot;2047&quot;</span>:<span class=\"number\">1134134</span>&#125;,<span class=\"attr\">&quot;waitForBatch&quot;</span>:<span class=\"literal\">true</span>,<span class=\"attr\">&quot;jobType&quot;</span>:<span class=\"string\">&quot;MERGED&quot;</span>,<span class=\"attr\">&quot;treeId&quot;</span>:<span class=\"number\">256</span>,<span class=\"attr\">&quot;treeTypeId&quot;</span>:<span class=\"number\">497</span>&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"合并的任务\"><a href=\"#合并的任务\" class=\"headerlink\" title=\"合并的任务\"></a>合并的任务</h3><p>BatchJobAcceptor。2小时扫描一次</p>\n<p>处理过程同merged 且watiForBatch=false，只是多了个等待时间，会收到多个jobCtx，ExecutionPlanner.INSTANCE.merge(jobCtxList)</p>\n<p><font color=\"#FF000\"><strong>难点在于合并任务的逻辑处理。@see com.datastory.trident.serv.scheduler.ExecutionPlanner#merge</strong></font></p>\n<h2 id=\"修改标签规则\"><a href=\"#修改标签规则\" class=\"headerlink\" title=\"修改标签规则\"></a>修改标签规则</h2><pre class=\"mermaid\">graph TD;\n    subgraph all[全部]\n    start[开始]-->edit[修改标签]\n    edit--执行标签任务-->redis[提交到redis的allJob队列]\n    redis--JobAcceptor#parseMessage-->runJob[执行标签 调用海纳]    \n    runJob-->ostart\n    end\n    subgraph ocean[海纳任务]\n    ostart[海纳task]-->oend[海纳任务执行完成]\n    ostart-->jstart\n    end\n    subgraph JobTracker\n    jstart[从redis的scheduler:running获取运行中的任务]-->isJobEnd{任务是否到达终态}\n    isJobEnd--是-->updateLabelCoverage[更新标签覆盖数]-->processRuleUpdatedLabel{判断规则是否改过}\n    updateLabelCoverage-->processOneTimeLabelStatus[一次性标签需要修改oneTimeStatus状态位为已执行]-->removeFromRedisSet[从redis的running中删除]-->oend\n    isJobEnd--否-->jstart\n    processRuleUpdatedLabel--是-->cleanStart\n    end\n    subgraph ofCleanOldRuleJob[清理修改过规则后的过期标签]\n    cleanStart-->cleanEnd\n    end</pre>\n<h3 id=\"任务终态定义\"><a href=\"#任务终态定义\" class=\"headerlink\" title=\"任务终态定义\"></a>任务终态定义</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">this</span>.equals(SUCCESS) || <span class=\"keyword\">this</span>.equals(TIMEOUT) || <span class=\"keyword\">this</span>.equals(KILLED) || <span class=\"keyword\">this</span>.equals(FAILED) || <span class=\"keyword\">this</span>.equals(SYS_KILLED) || <span class=\"keyword\">this</span>.equals(SYS_FAILED)</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"cover":"https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg","excerpt":"","more":"<h2 id=\"周期性标签运行\"><a href=\"#周期性标签运行\" class=\"headerlink\" title=\"周期性标签运行\"></a>周期性标签运行</h2><h3 id=\"获取需要执行的标签\"><a href=\"#获取需要执行的标签\" class=\"headerlink\" title=\"获取需要执行的标签\"></a>获取需要执行的标签</h3><p>CronJobLauncher。10s扫描一次</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> i.id,</span><br><span class=\"line\">       i.label_unique_id,</span><br><span class=\"line\">       i.label_name,</span><br><span class=\"line\">       i.label_type,</span><br><span class=\"line\">       i.demand,</span><br><span class=\"line\">       i.rule_descriptor,</span><br><span class=\"line\">       i.rule_hash,</span><br><span class=\"line\">       i.dsl_config,</span><br><span class=\"line\">       i.execute_config,</span><br><span class=\"line\">       i.next_run_time,</span><br><span class=\"line\">       i.rule_recent_updated,</span><br><span class=\"line\">       i.expire_type,</span><br><span class=\"line\">       i.expire_value,</span><br><span class=\"line\">       i.es_type,</span><br><span class=\"line\">       t.cron_config <span class=\"keyword\">AS</span> tree_cron_config,</span><br><span class=\"line\">       IFNULL(i.cron_config,t.cron_config) <span class=\"keyword\">AS</span> cron_config,</span><br><span class=\"line\">       t.tree_type_id <span class=\"keyword\">AS</span> tree_type,</span><br><span class=\"line\">       i.tree_id,</span><br><span class=\"line\">       i.root_label_id,</span><br><span class=\"line\">       i.parent_label_id,</span><br><span class=\"line\">       i.depth,</span><br><span class=\"line\">       i.acc_id,</span><br><span class=\"line\">       i.emails,</span><br><span class=\"line\">       i.del_flag,</span><br><span class=\"line\">       i.create_time,</span><br><span class=\"line\">       i.update_time,</span><br><span class=\"line\">       i.label_count,</span><br><span class=\"line\">       i.one_time_status</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> t_trident_label_info i</span><br><span class=\"line\"><span class=\"keyword\">LEFT</span> <span class=\"keyword\">JOIN</span> t_trident_label_tree t <span class=\"keyword\">ON</span> t.tree_id <span class=\"operator\">=</span> i.tree_id</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> i.del_flag <span class=\"operator\">=</span> <span class=\"number\">0</span></span><br><span class=\"line\">  <span class=\"keyword\">AND</span> i.execute_config <span class=\"keyword\">IS</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span></span><br><span class=\"line\">  <span class=\"keyword\">AND</span> i.dsl_config <span class=\"keyword\">IS</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span></span><br><span class=\"line\">  <span class=\"keyword\">AND</span> (i.next_run_time <span class=\"operator\">&gt;</span> <span class=\"string\">&#x27;1970-01-01 08:00:00&#x27;</span></span><br><span class=\"line\">       <span class=\"keyword\">AND</span> i.next_run_time <span class=\"operator\">&lt;=</span> NOW())</span><br><span class=\"line\">  <span class=\"keyword\">AND</span> i.one_time_status <span class=\"operator\">&lt;&gt;</span> <span class=\"number\">2</span></span><br></pre></td></tr></table></figure>\n<p>桉树id分组</p>\n<p>遍历每个分组，如果分组下的标签执行周期 != 树的执行周期，ofSpecialCronJob 立即提交任务（fusion）</p>\n<p>否则合并多个标签任务id，ofNormalCronJob 提交任务（merged，waitForBatch=true） </p>\n<p>遍历完成后，更新下次执行时间（nextRunTime）</p>\n<p>以上任务提交后都先放在redis的<code>ds:trident:mq:allJob</code>​队列中</p>\n<p>运行中的任务在 redis的 <code>ds:trident:scheduler:running</code>中</p>\n<p><img src=\"/image/image-20210106101222963.png\" alt=\"image-20210106101222963\"></p>\n<h3 id=\"任务分发\"><a href=\"#任务分发\" class=\"headerlink\" title=\"任务分发\"></a>任务分发</h3><p>JobAcceptor。 10s扫描一次 redis中的<code>ds:trident:mq:allJob</code>队列</p>\n<h4 id=\"fusion\"><a href=\"#fusion\" class=\"headerlink\" title=\"fusion\"></a>fusion</h4><p>将fusion作业直接提交到海纳执行，sendJobToTracker 放到<code>ds:trident:scheduler:running</code>中</p>\n<h4 id=\"merged\"><a href=\"#merged\" class=\"headerlink\" title=\"merged\"></a>merged</h4><p>将merged且waitForBatch=false的，进行合并。ExecutionPlanner.INSTANCE.merge(ImmutableList.of(jobCtx))，然后提交海纳，sendJobToTracker 放到<code>ds:trident:scheduler:running</code>中</p>\n<pre class=\"mermaid\">graph LR\n    合并任务-->condition{是否大于合并阈值}\n    condition--否,简单合并-->将多个sql语句放到一个task里面\n    condition--是,深度合并-->对sql逻辑进行合并后放到一个task里面</pre>\n\n<p>合并任务相关单元测试可以参考com.datastory.trident.serv.scheduler.ExecutionPlannerTest</p>\n<p>将merged且waitForBatch=true的，提交到<code>ds:trident:mq:mergeJob</code>队列</p>\n<p><img src=\"/image/image-20210106144024660.png\" alt=\"image-20210106144024660\"></p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"attr\">&quot;labelJobIdMap&quot;</span>:&#123;<span class=\"attr\">&quot;2048&quot;</span>:<span class=\"number\">1133541</span>,<span class=\"attr\">&quot;2049&quot;</span>:<span class=\"number\">1133542</span>,<span class=\"attr\">&quot;2050&quot;</span>:<span class=\"number\">1133543</span>,<span class=\"attr\">&quot;2051&quot;</span>:<span class=\"number\">1133544</span>,<span class=\"attr\">&quot;2052&quot;</span>:<span class=\"number\">1133545</span>,<span class=\"attr\">&quot;2053&quot;</span>:<span class=\"number\">1133546</span>,<span class=\"attr\">&quot;2054&quot;</span>:<span class=\"number\">1133547</span>,<span class=\"attr\">&quot;2055&quot;</span>:<span class=\"number\">1133548</span>,<span class=\"attr\">&quot;2056&quot;</span>:<span class=\"number\">1133549</span>,<span class=\"attr\">&quot;2058&quot;</span>:<span class=\"number\">1133550</span>,<span class=\"attr\">&quot;2059&quot;</span>:<span class=\"number\">1133551</span>,<span class=\"attr\">&quot;2060&quot;</span>:<span class=\"number\">1133552</span>,<span class=\"attr\">&quot;2061&quot;</span>:<span class=\"number\">1133553</span>,<span class=\"attr\">&quot;2062&quot;</span>:<span class=\"number\">1133554</span>,<span class=\"attr\">&quot;2063&quot;</span>:<span class=\"number\">1133555</span>,<span class=\"attr\">&quot;2064&quot;</span>:<span class=\"number\">1133556</span>,<span class=\"attr\">&quot;2065&quot;</span>:<span class=\"number\">1133557</span>,<span class=\"attr\">&quot;2066&quot;</span>:<span class=\"number\">1133558</span>,<span class=\"attr\">&quot;2068&quot;</span>:<span class=\"number\">1133559</span>,<span class=\"attr\">&quot;2069&quot;</span>:<span class=\"number\">1133560</span>,<span class=\"attr\">&quot;2070&quot;</span>:<span class=\"number\">1133561</span>,<span class=\"attr\">&quot;2071&quot;</span>:<span class=\"number\">1133562</span>,<span class=\"attr\">&quot;2072&quot;</span>:<span class=\"number\">1133563</span>,<span class=\"attr\">&quot;2073&quot;</span>:<span class=\"number\">1133564</span>,<span class=\"attr\">&quot;2074&quot;</span>:<span class=\"number\">1133565</span>,<span class=\"attr\">&quot;2075&quot;</span>:<span class=\"number\">1133566</span>,<span class=\"attr\">&quot;2076&quot;</span>:<span class=\"number\">1133567</span>,<span class=\"attr\">&quot;2077&quot;</span>:<span class=\"number\">1133568</span>,<span class=\"attr\">&quot;2078&quot;</span>:<span class=\"number\">1133569</span>,<span class=\"attr\">&quot;2079&quot;</span>:<span class=\"number\">1133570</span>,<span class=\"attr\">&quot;2080&quot;</span>:<span class=\"number\">1133571</span>,<span class=\"attr\">&quot;2082&quot;</span>:<span class=\"number\">1133572</span>,<span class=\"attr\">&quot;2083&quot;</span>:<span class=\"number\">1133573</span>,<span class=\"attr\">&quot;2084&quot;</span>:<span class=\"number\">1133574</span>,<span class=\"attr\">&quot;2094&quot;</span>:<span class=\"number\">1133575</span>,<span class=\"attr\">&quot;2095&quot;</span>:<span class=\"number\">1133576</span>,<span class=\"attr\">&quot;2096&quot;</span>:<span class=\"number\">1133577</span>,<span class=\"attr\">&quot;2097&quot;</span>:<span class=\"number\">1133578</span>,<span class=\"attr\">&quot;2098&quot;</span>:<span class=\"number\">1133579</span>,<span class=\"attr\">&quot;2099&quot;</span>:<span class=\"number\">1133580</span>,<span class=\"attr\">&quot;2100&quot;</span>:<span class=\"number\">1133581</span>,<span class=\"attr\">&quot;2101&quot;</span>:<span class=\"number\">1133582</span>,<span class=\"attr\">&quot;2105&quot;</span>:<span class=\"number\">1133583</span>,<span class=\"attr\">&quot;2106&quot;</span>:<span class=\"number\">1133584</span>,<span class=\"attr\">&quot;2107&quot;</span>:<span class=\"number\">1133585</span>,<span class=\"attr\">&quot;2108&quot;</span>:<span class=\"number\">1133586</span>,<span class=\"attr\">&quot;2110&quot;</span>:<span class=\"number\">1133587</span>,<span class=\"attr\">&quot;2111&quot;</span>:<span class=\"number\">1133588</span>,<span class=\"attr\">&quot;2113&quot;</span>:<span class=\"number\">1133589</span>,<span class=\"attr\">&quot;2114&quot;</span>:<span class=\"number\">1133590</span>,<span class=\"attr\">&quot;2115&quot;</span>:<span class=\"number\">1133591</span>,<span class=\"attr\">&quot;2116&quot;</span>:<span class=\"number\">1133592</span>,<span class=\"attr\">&quot;2117&quot;</span>:<span class=\"number\">1133593</span>,<span class=\"attr\">&quot;2118&quot;</span>:<span class=\"number\">1133594</span>,<span class=\"attr\">&quot;2119&quot;</span>:<span class=\"number\">1133595</span>,<span class=\"attr\">&quot;2120&quot;</span>:<span class=\"number\">1133596</span>,<span class=\"attr\">&quot;2122&quot;</span>:<span class=\"number\">1133597</span>,<span class=\"attr\">&quot;2123&quot;</span>:<span class=\"number\">1133598</span>,<span class=\"attr\">&quot;2124&quot;</span>:<span class=\"number\">1133599</span>,<span class=\"attr\">&quot;2125&quot;</span>:<span class=\"number\">1133600</span>,<span class=\"attr\">&quot;2126&quot;</span>:<span class=\"number\">1133601</span>,<span class=\"attr\">&quot;2127&quot;</span>:<span class=\"number\">1133602</span>,<span class=\"attr\">&quot;2128&quot;</span>:<span class=\"number\">1133603</span>,<span class=\"attr\">&quot;2129&quot;</span>:<span class=\"number\">1133604</span>,<span class=\"attr\">&quot;2130&quot;</span>:<span class=\"number\">1133605</span>,<span class=\"attr\">&quot;2131&quot;</span>:<span class=\"number\">1133606</span>,<span class=\"attr\">&quot;2132&quot;</span>:<span class=\"number\">1133607</span>,<span class=\"attr\">&quot;2135&quot;</span>:<span class=\"number\">1133608</span>,<span class=\"attr\">&quot;2136&quot;</span>:<span class=\"number\">1133609</span>,<span class=\"attr\">&quot;2137&quot;</span>:<span class=\"number\">1133610</span>,<span class=\"attr\">&quot;2138&quot;</span>:<span class=\"number\">1133611</span>,<span class=\"attr\">&quot;2139&quot;</span>:<span class=\"number\">1133612</span>,<span class=\"attr\">&quot;2141&quot;</span>:<span class=\"number\">1133613</span>,<span class=\"attr\">&quot;2142&quot;</span>:<span class=\"number\">1133614</span>,<span class=\"attr\">&quot;2143&quot;</span>:<span class=\"number\">1133615</span>,<span class=\"attr\">&quot;2144&quot;</span>:<span class=\"number\">1133616</span>,<span class=\"attr\">&quot;2145&quot;</span>:<span class=\"number\">1133617</span>,<span class=\"attr\">&quot;2146&quot;</span>:<span class=\"number\">1133618</span>,<span class=\"attr\">&quot;2147&quot;</span>:<span class=\"number\">1133619</span>,<span class=\"attr\">&quot;2148&quot;</span>:<span class=\"number\">1133620</span>,<span class=\"attr\">&quot;2149&quot;</span>:<span class=\"number\">1133621</span>,<span class=\"attr\">&quot;2150&quot;</span>:<span class=\"number\">1133622</span>,<span class=\"attr\">&quot;2151&quot;</span>:<span class=\"number\">1133623</span>,<span class=\"attr\">&quot;2153&quot;</span>:<span class=\"number\">1133624</span>,<span class=\"attr\">&quot;2154&quot;</span>:<span class=\"number\">1133625</span>,<span class=\"attr\">&quot;2155&quot;</span>:<span class=\"number\">1133626</span>,<span class=\"attr\">&quot;2156&quot;</span>:<span class=\"number\">1133627</span>,<span class=\"attr\">&quot;2157&quot;</span>:<span class=\"number\">1133628</span>,<span class=\"attr\">&quot;2158&quot;</span>:<span class=\"number\">1133629</span>,<span class=\"attr\">&quot;2159&quot;</span>:<span class=\"number\">1133630</span>,<span class=\"attr\">&quot;2160&quot;</span>:<span class=\"number\">1133631</span>,<span class=\"attr\">&quot;2161&quot;</span>:<span class=\"number\">1133632</span>,<span class=\"attr\">&quot;2163&quot;</span>:<span class=\"number\">1133633</span>,<span class=\"attr\">&quot;2164&quot;</span>:<span class=\"number\">1133634</span>,<span class=\"attr\">&quot;2165&quot;</span>:<span class=\"number\">1133635</span>,<span class=\"attr\">&quot;2166&quot;</span>:<span class=\"number\">1133636</span>,<span class=\"attr\">&quot;2167&quot;</span>:<span class=\"number\">1133637</span>,<span class=\"attr\">&quot;2168&quot;</span>:<span class=\"number\">1133638</span>,<span class=\"attr\">&quot;2169&quot;</span>:<span class=\"number\">1133639</span>,<span class=\"attr\">&quot;2170&quot;</span>:<span class=\"number\">1133640</span>,<span class=\"attr\">&quot;2171&quot;</span>:<span class=\"number\">1133641</span>,<span class=\"attr\">&quot;2172&quot;</span>:<span class=\"number\">1133642</span>,<span class=\"attr\">&quot;2173&quot;</span>:<span class=\"number\">1133643</span>,<span class=\"attr\">&quot;2174&quot;</span>:<span class=\"number\">1133644</span>,<span class=\"attr\">&quot;2175&quot;</span>:<span class=\"number\">1133645</span>,<span class=\"attr\">&quot;2177&quot;</span>:<span class=\"number\">1133646</span>,<span class=\"attr\">&quot;2178&quot;</span>:<span class=\"number\">1133647</span>,<span class=\"attr\">&quot;2179&quot;</span>:<span class=\"number\">1133648</span>,<span class=\"attr\">&quot;2189&quot;</span>:<span class=\"number\">1133649</span>,<span class=\"attr\">&quot;2190&quot;</span>:<span class=\"number\">1133650</span>,<span class=\"attr\">&quot;2191&quot;</span>:<span class=\"number\">1133651</span>,<span class=\"attr\">&quot;2192&quot;</span>:<span class=\"number\">1133652</span>,<span class=\"attr\">&quot;2193&quot;</span>:<span class=\"number\">1133653</span>,<span class=\"attr\">&quot;2194&quot;</span>:<span class=\"number\">1133654</span>,<span class=\"attr\">&quot;2195&quot;</span>:<span class=\"number\">1133655</span>,<span class=\"attr\">&quot;2196&quot;</span>:<span class=\"number\">1133656</span>,<span class=\"attr\">&quot;2200&quot;</span>:<span class=\"number\">1133657</span>,<span class=\"attr\">&quot;2201&quot;</span>:<span class=\"number\">1133658</span>,<span class=\"attr\">&quot;2202&quot;</span>:<span class=\"number\">1133659</span>,<span class=\"attr\">&quot;2203&quot;</span>:<span class=\"number\">1133660</span>,<span class=\"attr\">&quot;2205&quot;</span>:<span class=\"number\">1133661</span>,<span class=\"attr\">&quot;2206&quot;</span>:<span class=\"number\">1133662</span>,<span class=\"attr\">&quot;2208&quot;</span>:<span class=\"number\">1133663</span>,<span class=\"attr\">&quot;2209&quot;</span>:<span class=\"number\">1133664</span>,<span class=\"attr\">&quot;2210&quot;</span>:<span class=\"number\">1133665</span>,<span class=\"attr\">&quot;2211&quot;</span>:<span class=\"number\">1133666</span>,<span class=\"attr\">&quot;2212&quot;</span>:<span class=\"number\">1133667</span>,<span class=\"attr\">&quot;2214&quot;</span>:<span class=\"number\">1133668</span>,<span class=\"attr\">&quot;2215&quot;</span>:<span class=\"number\">1133669</span>,<span class=\"attr\">&quot;2216&quot;</span>:<span class=\"number\">1133670</span>,<span class=\"attr\">&quot;2217&quot;</span>:<span class=\"number\">1133671</span>,<span class=\"attr\">&quot;2218&quot;</span>:<span class=\"number\">1133672</span>,<span class=\"attr\">&quot;2219&quot;</span>:<span class=\"number\">1133673</span>,<span class=\"attr\">&quot;2220&quot;</span>:<span class=\"number\">1133674</span>,<span class=\"attr\">&quot;2221&quot;</span>:<span class=\"number\">1133675</span>,<span class=\"attr\">&quot;2222&quot;</span>:<span class=\"number\">1133676</span>,<span class=\"attr\">&quot;2223&quot;</span>:<span class=\"number\">1133677</span>,<span class=\"attr\">&quot;2224&quot;</span>:<span class=\"number\">1133678</span>,<span class=\"attr\">&quot;2227&quot;</span>:<span class=\"number\">1133679</span>,<span class=\"attr\">&quot;2228&quot;</span>:<span class=\"number\">1133680</span>,<span class=\"attr\">&quot;2229&quot;</span>:<span class=\"number\">1133681</span>,<span class=\"attr\">&quot;2230&quot;</span>:<span class=\"number\">1133682</span>,<span class=\"attr\">&quot;2231&quot;</span>:<span class=\"number\">1133683</span>,<span class=\"attr\">&quot;2233&quot;</span>:<span class=\"number\">1133684</span>,<span class=\"attr\">&quot;2234&quot;</span>:<span class=\"number\">1133685</span>,<span class=\"attr\">&quot;2235&quot;</span>:<span class=\"number\">1133686</span>,<span class=\"attr\">&quot;2236&quot;</span>:<span class=\"number\">1133687</span>,<span class=\"attr\">&quot;2237&quot;</span>:<span class=\"number\">1133688</span>,<span class=\"attr\">&quot;2238&quot;</span>:<span class=\"number\">1133689</span>,<span class=\"attr\">&quot;2239&quot;</span>:<span class=\"number\">1133690</span>,<span class=\"attr\">&quot;2240&quot;</span>:<span class=\"number\">1133691</span>,<span class=\"attr\">&quot;2241&quot;</span>:<span class=\"number\">1133692</span>,<span class=\"attr\">&quot;2242&quot;</span>:<span class=\"number\">1133693</span>,<span class=\"attr\">&quot;2243&quot;</span>:<span class=\"number\">1133694</span>,<span class=\"attr\">&quot;2245&quot;</span>:<span class=\"number\">1133695</span>,<span class=\"attr\">&quot;2246&quot;</span>:<span class=\"number\">1133696</span>,<span class=\"attr\">&quot;2247&quot;</span>:<span class=\"number\">1133697</span>,<span class=\"attr\">&quot;2248&quot;</span>:<span class=\"number\">1133698</span>,<span class=\"attr\">&quot;2249&quot;</span>:<span class=\"number\">1133699</span>,<span class=\"attr\">&quot;2250&quot;</span>:<span class=\"number\">1133700</span>,<span class=\"attr\">&quot;2251&quot;</span>:<span class=\"number\">1133701</span>,<span class=\"attr\">&quot;2252&quot;</span>:<span class=\"number\">1133702</span>,<span class=\"attr\">&quot;2253&quot;</span>:<span class=\"number\">1133703</span>,<span class=\"attr\">&quot;2255&quot;</span>:<span class=\"number\">1133704</span>,<span class=\"attr\">&quot;2256&quot;</span>:<span class=\"number\">1133705</span>,<span class=\"attr\">&quot;2257&quot;</span>:<span class=\"number\">1133706</span>,<span class=\"attr\">&quot;2258&quot;</span>:<span class=\"number\">1133707</span>,<span class=\"attr\">&quot;2259&quot;</span>:<span class=\"number\">1133708</span>,<span class=\"attr\">&quot;2260&quot;</span>:<span class=\"number\">1133709</span>,<span class=\"attr\">&quot;2261&quot;</span>:<span class=\"number\">1133710</span>,<span class=\"attr\">&quot;2262&quot;</span>:<span class=\"number\">1133711</span>,<span class=\"attr\">&quot;2263&quot;</span>:<span class=\"number\">1133712</span>,<span class=\"attr\">&quot;2264&quot;</span>:<span class=\"number\">1133713</span>,<span class=\"attr\">&quot;2265&quot;</span>:<span class=\"number\">1133714</span>,<span class=\"attr\">&quot;2266&quot;</span>:<span class=\"number\">1133715</span>,<span class=\"attr\">&quot;2267&quot;</span>:<span class=\"number\">1133716</span>,<span class=\"attr\">&quot;2269&quot;</span>:<span class=\"number\">1133717</span>,<span class=\"attr\">&quot;2270&quot;</span>:<span class=\"number\">1133718</span>,<span class=\"attr\">&quot;2271&quot;</span>:<span class=\"number\">1133719</span>,<span class=\"attr\">&quot;2273&quot;</span>:<span class=\"number\">1133720</span>,<span class=\"attr\">&quot;2278&quot;</span>:<span class=\"number\">1133721</span>,<span class=\"attr\">&quot;2280&quot;</span>:<span class=\"number\">1133722</span>,<span class=\"attr\">&quot;2298&quot;</span>:<span class=\"number\">1133723</span>,<span class=\"attr\">&quot;2299&quot;</span>:<span class=\"number\">1133724</span>,<span class=\"attr\">&quot;2300&quot;</span>:<span class=\"number\">1133725</span>,<span class=\"attr\">&quot;2301&quot;</span>:<span class=\"number\">1133726</span>,<span class=\"attr\">&quot;2302&quot;</span>:<span class=\"number\">1133727</span>,<span class=\"attr\">&quot;2303&quot;</span>:<span class=\"number\">1133728</span>,<span class=\"attr\">&quot;2304&quot;</span>:<span class=\"number\">1133729</span>,<span class=\"attr\">&quot;2305&quot;</span>:<span class=\"number\">1133730</span>,<span class=\"attr\">&quot;2309&quot;</span>:<span class=\"number\">1133731</span>,<span class=\"attr\">&quot;2310&quot;</span>:<span class=\"number\">1133732</span>,<span class=\"attr\">&quot;2311&quot;</span>:<span class=\"number\">1133733</span>,<span class=\"attr\">&quot;2312&quot;</span>:<span class=\"number\">1133734</span>,<span class=\"attr\">&quot;2314&quot;</span>:<span class=\"number\">1133735</span>,<span class=\"attr\">&quot;2315&quot;</span>:<span class=\"number\">1133736</span>,<span class=\"attr\">&quot;2317&quot;</span>:<span class=\"number\">1133737</span>,<span class=\"attr\">&quot;2318&quot;</span>:<span class=\"number\">1133738</span>,<span class=\"attr\">&quot;2319&quot;</span>:<span class=\"number\">1133739</span>,<span class=\"attr\">&quot;2320&quot;</span>:<span class=\"number\">1133740</span>,<span class=\"attr\">&quot;2321&quot;</span>:<span class=\"number\">1133741</span>,<span class=\"attr\">&quot;2322&quot;</span>:<span class=\"number\">1133742</span>,<span class=\"attr\">&quot;2323&quot;</span>:<span class=\"number\">1133743</span>,<span class=\"attr\">&quot;2324&quot;</span>:<span class=\"number\">1133744</span>,<span class=\"attr\">&quot;2326&quot;</span>:<span class=\"number\">1133745</span>,<span class=\"attr\">&quot;2327&quot;</span>:<span class=\"number\">1133746</span>,<span class=\"attr\">&quot;2328&quot;</span>:<span class=\"number\">1133747</span>,<span class=\"attr\">&quot;2329&quot;</span>:<span class=\"number\">1133748</span>,<span class=\"attr\">&quot;2330&quot;</span>:<span class=\"number\">1133749</span>,<span class=\"attr\">&quot;2331&quot;</span>:<span class=\"number\">1133750</span>,<span class=\"attr\">&quot;2332&quot;</span>:<span class=\"number\">1133751</span>,<span class=\"attr\">&quot;2333&quot;</span>:<span class=\"number\">1133752</span>,<span class=\"attr\">&quot;2334&quot;</span>:<span class=\"number\">1133753</span>,<span class=\"attr\">&quot;2335&quot;</span>:<span class=\"number\">1133754</span>,<span class=\"attr\">&quot;2336&quot;</span>:<span class=\"number\">1133755</span>,<span class=\"attr\">&quot;2339&quot;</span>:<span class=\"number\">1133756</span>,<span class=\"attr\">&quot;2340&quot;</span>:<span class=\"number\">1133757</span>,<span class=\"attr\">&quot;2341&quot;</span>:<span class=\"number\">1133758</span>,<span class=\"attr\">&quot;2342&quot;</span>:<span class=\"number\">1133759</span>,<span class=\"attr\">&quot;2343&quot;</span>:<span class=\"number\">1133760</span>,<span class=\"attr\">&quot;2345&quot;</span>:<span class=\"number\">1133761</span>,<span class=\"attr\">&quot;2346&quot;</span>:<span class=\"number\">1133762</span>,<span class=\"attr\">&quot;2347&quot;</span>:<span class=\"number\">1133763</span>,<span class=\"attr\">&quot;2348&quot;</span>:<span class=\"number\">1133764</span>,<span class=\"attr\">&quot;2349&quot;</span>:<span class=\"number\">1133765</span>,<span class=\"attr\">&quot;2350&quot;</span>:<span class=\"number\">1133766</span>,<span class=\"attr\">&quot;2351&quot;</span>:<span class=\"number\">1133767</span>,<span class=\"attr\">&quot;2352&quot;</span>:<span class=\"number\">1133768</span>,<span class=\"attr\">&quot;2353&quot;</span>:<span class=\"number\">1133769</span>,<span class=\"attr\">&quot;2354&quot;</span>:<span class=\"number\">1133770</span>,<span class=\"attr\">&quot;2355&quot;</span>:<span class=\"number\">1133771</span>,<span class=\"attr\">&quot;2357&quot;</span>:<span class=\"number\">1133772</span>,<span class=\"attr\">&quot;2358&quot;</span>:<span class=\"number\">1133773</span>,<span class=\"attr\">&quot;2359&quot;</span>:<span class=\"number\">1133774</span>,<span class=\"attr\">&quot;2360&quot;</span>:<span class=\"number\">1133775</span>,<span class=\"attr\">&quot;2361&quot;</span>:<span class=\"number\">1133776</span>,<span class=\"attr\">&quot;2362&quot;</span>:<span class=\"number\">1133777</span>,<span class=\"attr\">&quot;2363&quot;</span>:<span class=\"number\">1133778</span>,<span class=\"attr\">&quot;2364&quot;</span>:<span class=\"number\">1133779</span>,<span class=\"attr\">&quot;2365&quot;</span>:<span class=\"number\">1133780</span>,<span class=\"attr\">&quot;2367&quot;</span>:<span class=\"number\">1133781</span>,<span class=\"attr\">&quot;2368&quot;</span>:<span class=\"number\">1133782</span>,<span class=\"attr\">&quot;2369&quot;</span>:<span class=\"number\">1133783</span>,<span class=\"attr\">&quot;2370&quot;</span>:<span class=\"number\">1133784</span>,<span class=\"attr\">&quot;2371&quot;</span>:<span class=\"number\">1133785</span>,<span class=\"attr\">&quot;2372&quot;</span>:<span class=\"number\">1133786</span>,<span class=\"attr\">&quot;2373&quot;</span>:<span class=\"number\">1133787</span>,<span class=\"attr\">&quot;2374&quot;</span>:<span class=\"number\">1133788</span>,<span class=\"attr\">&quot;2375&quot;</span>:<span class=\"number\">1133789</span>,<span class=\"attr\">&quot;2376&quot;</span>:<span class=\"number\">1133790</span>,<span class=\"attr\">&quot;2377&quot;</span>:<span class=\"number\">1133791</span>,<span class=\"attr\">&quot;2378&quot;</span>:<span class=\"number\">1133792</span>,<span class=\"attr\">&quot;2379&quot;</span>:<span class=\"number\">1133793</span>,<span class=\"attr\">&quot;2381&quot;</span>:<span class=\"number\">1133794</span>,<span class=\"attr\">&quot;2382&quot;</span>:<span class=\"number\">1133795</span>,<span class=\"attr\">&quot;2383&quot;</span>:<span class=\"number\">1133796</span>,<span class=\"attr\">&quot;2405&quot;</span>:<span class=\"number\">1133797</span>,<span class=\"attr\">&quot;2406&quot;</span>:<span class=\"number\">1133798</span>,<span class=\"attr\">&quot;2407&quot;</span>:<span class=\"number\">1133799</span>,<span class=\"attr\">&quot;2408&quot;</span>:<span class=\"number\">1133800</span>,<span class=\"attr\">&quot;2409&quot;</span>:<span class=\"number\">1133801</span>,<span class=\"attr\">&quot;2410&quot;</span>:<span class=\"number\">1133802</span>,<span class=\"attr\">&quot;2411&quot;</span>:<span class=\"number\">1133803</span>,<span class=\"attr\">&quot;2412&quot;</span>:<span class=\"number\">1133804</span>,<span class=\"attr\">&quot;2416&quot;</span>:<span class=\"number\">1133805</span>,<span class=\"attr\">&quot;2417&quot;</span>:<span class=\"number\">1133806</span>,<span class=\"attr\">&quot;2418&quot;</span>:<span class=\"number\">1133807</span>,<span class=\"attr\">&quot;2419&quot;</span>:<span class=\"number\">1133808</span>,<span class=\"attr\">&quot;2421&quot;</span>:<span class=\"number\">1133809</span>,<span class=\"attr\">&quot;2422&quot;</span>:<span class=\"number\">1133810</span>,<span class=\"attr\">&quot;2424&quot;</span>:<span class=\"number\">1133811</span>,<span class=\"attr\">&quot;2425&quot;</span>:<span class=\"number\">1133812</span>,<span class=\"attr\">&quot;2426&quot;</span>:<span class=\"number\">1133813</span>,<span class=\"attr\">&quot;2427&quot;</span>:<span class=\"number\">1133814</span>,<span class=\"attr\">&quot;2428&quot;</span>:<span class=\"number\">1133815</span>,<span class=\"attr\">&quot;2429&quot;</span>:<span class=\"number\">1133816</span>,<span class=\"attr\">&quot;2430&quot;</span>:<span class=\"number\">1133817</span>,<span class=\"attr\">&quot;2431&quot;</span>:<span class=\"number\">1133818</span>,<span class=\"attr\">&quot;2433&quot;</span>:<span class=\"number\">1133819</span>,<span class=\"attr\">&quot;2434&quot;</span>:<span class=\"number\">1133820</span>,<span class=\"attr\">&quot;2435&quot;</span>:<span class=\"number\">1133821</span>,<span class=\"attr\">&quot;2436&quot;</span>:<span class=\"number\">1133822</span>,<span class=\"attr\">&quot;2437&quot;</span>:<span class=\"number\">1133823</span>,<span class=\"attr\">&quot;2438&quot;</span>:<span class=\"number\">1133824</span>,<span class=\"attr\">&quot;2439&quot;</span>:<span class=\"number\">1133825</span>,<span class=\"attr\">&quot;2440&quot;</span>:<span class=\"number\">1133826</span>,<span class=\"attr\">&quot;2441&quot;</span>:<span class=\"number\">1133827</span>,<span class=\"attr\">&quot;2442&quot;</span>:<span class=\"number\">1133828</span>,<span class=\"attr\">&quot;2443&quot;</span>:<span class=\"number\">1133829</span>,<span class=\"attr\">&quot;2446&quot;</span>:<span class=\"number\">1133830</span>,<span class=\"attr\">&quot;2447&quot;</span>:<span class=\"number\">1133831</span>,<span class=\"attr\">&quot;2448&quot;</span>:<span class=\"number\">1133832</span>,<span class=\"attr\">&quot;2449&quot;</span>:<span class=\"number\">1133833</span>,<span class=\"attr\">&quot;2450&quot;</span>:<span class=\"number\">1133834</span>,<span class=\"attr\">&quot;2452&quot;</span>:<span class=\"number\">1133835</span>,<span class=\"attr\">&quot;2453&quot;</span>:<span class=\"number\">1133836</span>,<span class=\"attr\">&quot;2454&quot;</span>:<span class=\"number\">1133837</span>,<span class=\"attr\">&quot;2455&quot;</span>:<span class=\"number\">1133838</span>,<span class=\"attr\">&quot;2456&quot;</span>:<span class=\"number\">1133839</span>,<span class=\"attr\">&quot;2457&quot;</span>:<span class=\"number\">1133840</span>,<span class=\"attr\">&quot;2458&quot;</span>:<span class=\"number\">1133841</span>,<span class=\"attr\">&quot;2459&quot;</span>:<span class=\"number\">1133842</span>,<span class=\"attr\">&quot;2460&quot;</span>:<span class=\"number\">1133843</span>,<span class=\"attr\">&quot;2461&quot;</span>:<span class=\"number\">1133844</span>,<span class=\"attr\">&quot;2462&quot;</span>:<span class=\"number\">1133845</span>,<span class=\"attr\">&quot;2464&quot;</span>:<span class=\"number\">1133846</span>,<span class=\"attr\">&quot;2465&quot;</span>:<span class=\"number\">1133847</span>,<span class=\"attr\">&quot;2466&quot;</span>:<span class=\"number\">1133848</span>,<span class=\"attr\">&quot;2467&quot;</span>:<span class=\"number\">1133849</span>,<span class=\"attr\">&quot;2468&quot;</span>:<span class=\"number\">1133850</span>,<span class=\"attr\">&quot;2469&quot;</span>:<span class=\"number\">1133851</span>,<span class=\"attr\">&quot;2470&quot;</span>:<span class=\"number\">1133852</span>,<span class=\"attr\">&quot;2471&quot;</span>:<span class=\"number\">1133853</span>,<span class=\"attr\">&quot;2472&quot;</span>:<span class=\"number\">1133854</span>,<span class=\"attr\">&quot;2474&quot;</span>:<span class=\"number\">1133855</span>,<span class=\"attr\">&quot;2475&quot;</span>:<span class=\"number\">1133856</span>,<span class=\"attr\">&quot;2476&quot;</span>:<span class=\"number\">1133857</span>,<span class=\"attr\">&quot;2477&quot;</span>:<span class=\"number\">1133858</span>,<span class=\"attr\">&quot;2478&quot;</span>:<span class=\"number\">1133859</span>,<span class=\"attr\">&quot;2479&quot;</span>:<span class=\"number\">1133860</span>,<span class=\"attr\">&quot;2480&quot;</span>:<span class=\"number\">1133861</span>,<span class=\"attr\">&quot;2481&quot;</span>:<span class=\"number\">1133862</span>,<span class=\"attr\">&quot;2482&quot;</span>:<span class=\"number\">1133863</span>,<span class=\"attr\">&quot;2483&quot;</span>:<span class=\"number\">1133864</span>,<span class=\"attr\">&quot;2484&quot;</span>:<span class=\"number\">1133865</span>,<span class=\"attr\">&quot;2485&quot;</span>:<span class=\"number\">1133866</span>,<span class=\"attr\">&quot;2486&quot;</span>:<span class=\"number\">1133867</span>,<span class=\"attr\">&quot;2488&quot;</span>:<span class=\"number\">1133868</span>,<span class=\"attr\">&quot;2489&quot;</span>:<span class=\"number\">1133869</span>,<span class=\"attr\">&quot;2490&quot;</span>:<span class=\"number\">1133870</span>,<span class=\"attr\">&quot;2509&quot;</span>:<span class=\"number\">1133871</span>,<span class=\"attr\">&quot;2510&quot;</span>:<span class=\"number\">1133872</span>,<span class=\"attr\">&quot;2515&quot;</span>:<span class=\"number\">1133873</span>,<span class=\"attr\">&quot;2528&quot;</span>:<span class=\"number\">1133874</span>,<span class=\"attr\">&quot;2529&quot;</span>:<span class=\"number\">1133875</span>,<span class=\"attr\">&quot;1622&quot;</span>:<span class=\"number\">1133876</span>,<span class=\"attr\">&quot;1623&quot;</span>:<span class=\"number\">1133877</span>,<span class=\"attr\">&quot;1624&quot;</span>:<span class=\"number\">1133878</span>,<span class=\"attr\">&quot;1625&quot;</span>:<span class=\"number\">1133879</span>,<span class=\"attr\">&quot;1626&quot;</span>:<span class=\"number\">1133880</span>,<span class=\"attr\">&quot;1627&quot;</span>:<span class=\"number\">1133881</span>,<span class=\"attr\">&quot;1628&quot;</span>:<span class=\"number\">1133882</span>,<span class=\"attr\">&quot;1629&quot;</span>:<span class=\"number\">1133883</span>,<span class=\"attr\">&quot;1633&quot;</span>:<span class=\"number\">1133884</span>,<span class=\"attr\">&quot;1634&quot;</span>:<span class=\"number\">1133885</span>,<span class=\"attr\">&quot;1635&quot;</span>:<span class=\"number\">1133886</span>,<span class=\"attr\">&quot;1636&quot;</span>:<span class=\"number\">1133887</span>,<span class=\"attr\">&quot;1638&quot;</span>:<span class=\"number\">1133888</span>,<span class=\"attr\">&quot;1639&quot;</span>:<span class=\"number\">1133889</span>,<span class=\"attr\">&quot;1641&quot;</span>:<span class=\"number\">1133890</span>,<span class=\"attr\">&quot;1642&quot;</span>:<span class=\"number\">1133891</span>,<span class=\"attr\">&quot;1643&quot;</span>:<span class=\"number\">1133892</span>,<span class=\"attr\">&quot;1644&quot;</span>:<span class=\"number\">1133893</span>,<span class=\"attr\">&quot;1645&quot;</span>:<span class=\"number\">1133894</span>,<span class=\"attr\">&quot;1646&quot;</span>:<span class=\"number\">1133895</span>,<span class=\"attr\">&quot;1647&quot;</span>:<span class=\"number\">1133896</span>,<span class=\"attr\">&quot;1648&quot;</span>:<span class=\"number\">1133897</span>,<span class=\"attr\">&quot;1650&quot;</span>:<span class=\"number\">1133898</span>,<span class=\"attr\">&quot;1651&quot;</span>:<span class=\"number\">1133899</span>,<span class=\"attr\">&quot;1652&quot;</span>:<span class=\"number\">1133900</span>,<span class=\"attr\">&quot;1653&quot;</span>:<span class=\"number\">1133901</span>,<span class=\"attr\">&quot;1654&quot;</span>:<span class=\"number\">1133902</span>,<span class=\"attr\">&quot;1655&quot;</span>:<span class=\"number\">1133903</span>,<span class=\"attr\">&quot;1656&quot;</span>:<span class=\"number\">1133904</span>,<span class=\"attr\">&quot;1657&quot;</span>:<span class=\"number\">1133905</span>,<span class=\"attr\">&quot;1658&quot;</span>:<span class=\"number\">1133906</span>,<span class=\"attr\">&quot;1659&quot;</span>:<span class=\"number\">1133907</span>,<span class=\"attr\">&quot;1660&quot;</span>:<span class=\"number\">1133908</span>,<span class=\"attr\">&quot;1663&quot;</span>:<span class=\"number\">1133909</span>,<span class=\"attr\">&quot;1664&quot;</span>:<span class=\"number\">1133910</span>,<span class=\"attr\">&quot;1665&quot;</span>:<span class=\"number\">1133911</span>,<span class=\"attr\">&quot;1666&quot;</span>:<span class=\"number\">1133912</span>,<span class=\"attr\">&quot;1667&quot;</span>:<span class=\"number\">1133913</span>,<span class=\"attr\">&quot;1669&quot;</span>:<span class=\"number\">1133914</span>,<span class=\"attr\">&quot;1670&quot;</span>:<span class=\"number\">1133915</span>,<span class=\"attr\">&quot;1683&quot;</span>:<span class=\"number\">1133916</span>,<span class=\"attr\">&quot;1684&quot;</span>:<span class=\"number\">1133917</span>,<span class=\"attr\">&quot;1685&quot;</span>:<span class=\"number\">1133918</span>,<span class=\"attr\">&quot;1686&quot;</span>:<span class=\"number\">1133919</span>,<span class=\"attr\">&quot;1687&quot;</span>:<span class=\"number\">1133920</span>,<span class=\"attr\">&quot;1688&quot;</span>:<span class=\"number\">1133921</span>,<span class=\"attr\">&quot;1689&quot;</span>:<span class=\"number\">1133922</span>,<span class=\"attr\">&quot;1690&quot;</span>:<span class=\"number\">1133923</span>,<span class=\"attr\">&quot;1691&quot;</span>:<span class=\"number\">1133924</span>,<span class=\"attr\">&quot;1693&quot;</span>:<span class=\"number\">1133925</span>,<span class=\"attr\">&quot;1694&quot;</span>:<span class=\"number\">1133926</span>,<span class=\"attr\">&quot;1695&quot;</span>:<span class=\"number\">1133927</span>,<span class=\"attr\">&quot;1696&quot;</span>:<span class=\"number\">1133928</span>,<span class=\"attr\">&quot;1698&quot;</span>:<span class=\"number\">1133929</span>,<span class=\"attr\">&quot;1699&quot;</span>:<span class=\"number\">1133930</span>,<span class=\"attr\">&quot;1700&quot;</span>:<span class=\"number\">1133931</span>,<span class=\"attr\">&quot;1701&quot;</span>:<span class=\"number\">1133932</span>,<span class=\"attr\">&quot;1702&quot;</span>:<span class=\"number\">1133933</span>,<span class=\"attr\">&quot;1704&quot;</span>:<span class=\"number\">1133934</span>,<span class=\"attr\">&quot;1705&quot;</span>:<span class=\"number\">1133935</span>,<span class=\"attr\">&quot;1706&quot;</span>:<span class=\"number\">1133936</span>,<span class=\"attr\">&quot;1707&quot;</span>:<span class=\"number\">1133937</span>,<span class=\"attr\">&quot;1708&quot;</span>:<span class=\"number\">1133938</span>,<span class=\"attr\">&quot;1709&quot;</span>:<span class=\"number\">1133939</span>,<span class=\"attr\">&quot;1710&quot;</span>:<span class=\"number\">1133940</span>,<span class=\"attr\">&quot;1711&quot;</span>:<span class=\"number\">1133941</span>,<span class=\"attr\">&quot;1712&quot;</span>:<span class=\"number\">1133942</span>,<span class=\"attr\">&quot;1713&quot;</span>:<span class=\"number\">1133943</span>,<span class=\"attr\">&quot;1714&quot;</span>:<span class=\"number\">1133944</span>,<span class=\"attr\">&quot;1715&quot;</span>:<span class=\"number\">1133945</span>,<span class=\"attr\">&quot;1716&quot;</span>:<span class=\"number\">1133946</span>,<span class=\"attr\">&quot;1718&quot;</span>:<span class=\"number\">1133947</span>,<span class=\"attr\">&quot;1719&quot;</span>:<span class=\"number\">1133948</span>,<span class=\"attr\">&quot;1720&quot;</span>:<span class=\"number\">1133949</span>,<span class=\"attr\">&quot;1783&quot;</span>:<span class=\"number\">1133950</span>,<span class=\"attr\">&quot;1784&quot;</span>:<span class=\"number\">1133951</span>,<span class=\"attr\">&quot;1785&quot;</span>:<span class=\"number\">1133952</span>,<span class=\"attr\">&quot;1786&quot;</span>:<span class=\"number\">1133953</span>,<span class=\"attr\">&quot;1787&quot;</span>:<span class=\"number\">1133954</span>,<span class=\"attr\">&quot;1788&quot;</span>:<span class=\"number\">1133955</span>,<span class=\"attr\">&quot;1789&quot;</span>:<span class=\"number\">1133956</span>,<span class=\"attr\">&quot;1790&quot;</span>:<span class=\"number\">1133957</span>,<span class=\"attr\">&quot;1794&quot;</span>:<span class=\"number\">1133958</span>,<span class=\"attr\">&quot;1795&quot;</span>:<span class=\"number\">1133959</span>,<span class=\"attr\">&quot;1796&quot;</span>:<span class=\"number\">1133960</span>,<span class=\"attr\">&quot;1797&quot;</span>:<span class=\"number\">1133961</span>,<span class=\"attr\">&quot;1799&quot;</span>:<span class=\"number\">1133962</span>,<span class=\"attr\">&quot;1800&quot;</span>:<span class=\"number\">1133963</span>,<span class=\"attr\">&quot;1805&quot;</span>:<span class=\"number\">1133964</span>,<span class=\"attr\">&quot;1806&quot;</span>:<span class=\"number\">1133965</span>,<span class=\"attr\">&quot;1807&quot;</span>:<span class=\"number\">1133966</span>,<span class=\"attr\">&quot;1808&quot;</span>:<span class=\"number\">1133967</span>,<span class=\"attr\">&quot;1809&quot;</span>:<span class=\"number\">1133968</span>,<span class=\"attr\">&quot;1811&quot;</span>:<span class=\"number\">1133969</span>,<span class=\"attr\">&quot;1812&quot;</span>:<span class=\"number\">1133970</span>,<span class=\"attr\">&quot;1813&quot;</span>:<span class=\"number\">1133971</span>,<span class=\"attr\">&quot;1814&quot;</span>:<span class=\"number\">1133972</span>,<span class=\"attr\">&quot;1815&quot;</span>:<span class=\"number\">1133973</span>,<span class=\"attr\">&quot;1816&quot;</span>:<span class=\"number\">1133974</span>,<span class=\"attr\">&quot;1817&quot;</span>:<span class=\"number\">1133975</span>,<span class=\"attr\">&quot;1818&quot;</span>:<span class=\"number\">1133976</span>,<span class=\"attr\">&quot;1819&quot;</span>:<span class=\"number\">1133977</span>,<span class=\"attr\">&quot;1820&quot;</span>:<span class=\"number\">1133978</span>,<span class=\"attr\">&quot;1821&quot;</span>:<span class=\"number\">1133979</span>,<span class=\"attr\">&quot;1824&quot;</span>:<span class=\"number\">1133980</span>,<span class=\"attr\">&quot;1825&quot;</span>:<span class=\"number\">1133981</span>,<span class=\"attr\">&quot;1826&quot;</span>:<span class=\"number\">1133982</span>,<span class=\"attr\">&quot;1827&quot;</span>:<span class=\"number\">1133983</span>,<span class=\"attr\">&quot;1828&quot;</span>:<span class=\"number\">1133984</span>,<span class=\"attr\">&quot;1830&quot;</span>:<span class=\"number\">1133985</span>,<span class=\"attr\">&quot;1831&quot;</span>:<span class=\"number\">1133986</span>,<span class=\"attr\">&quot;1832&quot;</span>:<span class=\"number\">1133987</span>,<span class=\"attr\">&quot;1833&quot;</span>:<span class=\"number\">1133988</span>,<span class=\"attr\">&quot;1834&quot;</span>:<span class=\"number\">1133989</span>,<span class=\"attr\">&quot;1835&quot;</span>:<span class=\"number\">1133990</span>,<span class=\"attr\">&quot;1836&quot;</span>:<span class=\"number\">1133991</span>,<span class=\"attr\">&quot;1837&quot;</span>:<span class=\"number\">1133992</span>,<span class=\"attr\">&quot;1838&quot;</span>:<span class=\"number\">1133993</span>,<span class=\"attr\">&quot;1839&quot;</span>:<span class=\"number\">1133994</span>,<span class=\"attr\">&quot;1840&quot;</span>:<span class=\"number\">1133995</span>,<span class=\"attr\">&quot;1842&quot;</span>:<span class=\"number\">1133996</span>,<span class=\"attr\">&quot;1843&quot;</span>:<span class=\"number\">1133997</span>,<span class=\"attr\">&quot;1844&quot;</span>:<span class=\"number\">1133998</span>,<span class=\"attr\">&quot;1845&quot;</span>:<span class=\"number\">1133999</span>,<span class=\"attr\">&quot;1846&quot;</span>:<span class=\"number\">1134000</span>,<span class=\"attr\">&quot;1847&quot;</span>:<span class=\"number\">1134001</span>,<span class=\"attr\">&quot;1848&quot;</span>:<span class=\"number\">1134002</span>,<span class=\"attr\">&quot;1849&quot;</span>:<span class=\"number\">1134003</span>,<span class=\"attr\">&quot;1850&quot;</span>:<span class=\"number\">1134004</span>,<span class=\"attr\">&quot;1852&quot;</span>:<span class=\"number\">1134005</span>,<span class=\"attr\">&quot;1853&quot;</span>:<span class=\"number\">1134006</span>,<span class=\"attr\">&quot;1854&quot;</span>:<span class=\"number\">1134007</span>,<span class=\"attr\">&quot;1855&quot;</span>:<span class=\"number\">1134008</span>,<span class=\"attr\">&quot;1856&quot;</span>:<span class=\"number\">1134009</span>,<span class=\"attr\">&quot;1857&quot;</span>:<span class=\"number\">1134010</span>,<span class=\"attr\">&quot;1858&quot;</span>:<span class=\"number\">1134011</span>,<span class=\"attr\">&quot;1859&quot;</span>:<span class=\"number\">1134012</span>,<span class=\"attr\">&quot;1860&quot;</span>:<span class=\"number\">1134013</span>,<span class=\"attr\">&quot;1861&quot;</span>:<span class=\"number\">1134014</span>,<span class=\"attr\">&quot;1862&quot;</span>:<span class=\"number\">1134015</span>,<span class=\"attr\">&quot;1863&quot;</span>:<span class=\"number\">1134016</span>,<span class=\"attr\">&quot;1864&quot;</span>:<span class=\"number\">1134017</span>,<span class=\"attr\">&quot;1866&quot;</span>:<span class=\"number\">1134018</span>,<span class=\"attr\">&quot;1867&quot;</span>:<span class=\"number\">1134019</span>,<span class=\"attr\">&quot;1868&quot;</span>:<span class=\"number\">1134020</span>,<span class=\"attr\">&quot;1884&quot;</span>:<span class=\"number\">1134021</span>,<span class=\"attr\">&quot;1885&quot;</span>:<span class=\"number\">1134022</span>,<span class=\"attr\">&quot;1886&quot;</span>:<span class=\"number\">1134023</span>,<span class=\"attr\">&quot;1887&quot;</span>:<span class=\"number\">1134024</span>,<span class=\"attr\">&quot;1888&quot;</span>:<span class=\"number\">1134025</span>,<span class=\"attr\">&quot;1889&quot;</span>:<span class=\"number\">1134026</span>,<span class=\"attr\">&quot;1890&quot;</span>:<span class=\"number\">1134027</span>,<span class=\"attr\">&quot;1891&quot;</span>:<span class=\"number\">1134028</span>,<span class=\"attr\">&quot;1895&quot;</span>:<span class=\"number\">1134029</span>,<span class=\"attr\">&quot;1896&quot;</span>:<span class=\"number\">1134030</span>,<span class=\"attr\">&quot;1897&quot;</span>:<span class=\"number\">1134031</span>,<span class=\"attr\">&quot;1898&quot;</span>:<span class=\"number\">1134032</span>,<span class=\"attr\">&quot;1900&quot;</span>:<span class=\"number\">1134033</span>,<span class=\"attr\">&quot;1901&quot;</span>:<span class=\"number\">1134034</span>,<span class=\"attr\">&quot;1903&quot;</span>:<span class=\"number\">1134035</span>,<span class=\"attr\">&quot;1904&quot;</span>:<span class=\"number\">1134036</span>,<span class=\"attr\">&quot;1905&quot;</span>:<span class=\"number\">1134037</span>,<span class=\"attr\">&quot;1906&quot;</span>:<span class=\"number\">1134038</span>,<span class=\"attr\">&quot;1907&quot;</span>:<span class=\"number\">1134039</span>,<span class=\"attr\">&quot;1908&quot;</span>:<span class=\"number\">1134040</span>,<span class=\"attr\">&quot;1909&quot;</span>:<span class=\"number\">1134041</span>,<span class=\"attr\">&quot;1910&quot;</span>:<span class=\"number\">1134042</span>,<span class=\"attr\">&quot;1912&quot;</span>:<span class=\"number\">1134043</span>,<span class=\"attr\">&quot;1913&quot;</span>:<span class=\"number\">1134044</span>,<span class=\"attr\">&quot;1914&quot;</span>:<span class=\"number\">1134045</span>,<span class=\"attr\">&quot;1915&quot;</span>:<span class=\"number\">1134046</span>,<span class=\"attr\">&quot;1916&quot;</span>:<span class=\"number\">1134047</span>,<span class=\"attr\">&quot;1917&quot;</span>:<span class=\"number\">1134048</span>,<span class=\"attr\">&quot;1918&quot;</span>:<span class=\"number\">1134049</span>,<span class=\"attr\">&quot;1919&quot;</span>:<span class=\"number\">1134050</span>,<span class=\"attr\">&quot;1920&quot;</span>:<span class=\"number\">1134051</span>,<span class=\"attr\">&quot;1921&quot;</span>:<span class=\"number\">1134052</span>,<span class=\"attr\">&quot;1922&quot;</span>:<span class=\"number\">1134053</span>,<span class=\"attr\">&quot;1925&quot;</span>:<span class=\"number\">1134054</span>,<span class=\"attr\">&quot;1926&quot;</span>:<span class=\"number\">1134055</span>,<span class=\"attr\">&quot;1927&quot;</span>:<span class=\"number\">1134056</span>,<span class=\"attr\">&quot;1928&quot;</span>:<span class=\"number\">1134057</span>,<span class=\"attr\">&quot;1929&quot;</span>:<span class=\"number\">1134058</span>,<span class=\"attr\">&quot;1931&quot;</span>:<span class=\"number\">1134059</span>,<span class=\"attr\">&quot;1932&quot;</span>:<span class=\"number\">1134060</span>,<span class=\"attr\">&quot;1933&quot;</span>:<span class=\"number\">1134061</span>,<span class=\"attr\">&quot;1934&quot;</span>:<span class=\"number\">1134062</span>,<span class=\"attr\">&quot;1935&quot;</span>:<span class=\"number\">1134063</span>,<span class=\"attr\">&quot;1936&quot;</span>:<span class=\"number\">1134064</span>,<span class=\"attr\">&quot;1937&quot;</span>:<span class=\"number\">1134065</span>,<span class=\"attr\">&quot;1938&quot;</span>:<span class=\"number\">1134066</span>,<span class=\"attr\">&quot;1939&quot;</span>:<span class=\"number\">1134067</span>,<span class=\"attr\">&quot;1940&quot;</span>:<span class=\"number\">1134068</span>,<span class=\"attr\">&quot;1941&quot;</span>:<span class=\"number\">1134069</span>,<span class=\"attr\">&quot;1943&quot;</span>:<span class=\"number\">1134070</span>,<span class=\"attr\">&quot;1944&quot;</span>:<span class=\"number\">1134071</span>,<span class=\"attr\">&quot;1945&quot;</span>:<span class=\"number\">1134072</span>,<span class=\"attr\">&quot;1946&quot;</span>:<span class=\"number\">1134073</span>,<span class=\"attr\">&quot;1947&quot;</span>:<span class=\"number\">1134074</span>,<span class=\"attr\">&quot;1948&quot;</span>:<span class=\"number\">1134075</span>,<span class=\"attr\">&quot;1949&quot;</span>:<span class=\"number\">1134076</span>,<span class=\"attr\">&quot;1950&quot;</span>:<span class=\"number\">1134077</span>,<span class=\"attr\">&quot;1951&quot;</span>:<span class=\"number\">1134078</span>,<span class=\"attr\">&quot;1953&quot;</span>:<span class=\"number\">1134079</span>,<span class=\"attr\">&quot;1954&quot;</span>:<span class=\"number\">1134080</span>,<span class=\"attr\">&quot;1955&quot;</span>:<span class=\"number\">1134081</span>,<span class=\"attr\">&quot;1956&quot;</span>:<span class=\"number\">1134082</span>,<span class=\"attr\">&quot;1957&quot;</span>:<span class=\"number\">1134083</span>,<span class=\"attr\">&quot;1958&quot;</span>:<span class=\"number\">1134084</span>,<span class=\"attr\">&quot;1959&quot;</span>:<span class=\"number\">1134085</span>,<span class=\"attr\">&quot;1960&quot;</span>:<span class=\"number\">1134086</span>,<span class=\"attr\">&quot;1961&quot;</span>:<span class=\"number\">1134087</span>,<span class=\"attr\">&quot;1962&quot;</span>:<span class=\"number\">1134088</span>,<span class=\"attr\">&quot;1963&quot;</span>:<span class=\"number\">1134089</span>,<span class=\"attr\">&quot;1964&quot;</span>:<span class=\"number\">1134090</span>,<span class=\"attr\">&quot;1965&quot;</span>:<span class=\"number\">1134091</span>,<span class=\"attr\">&quot;1967&quot;</span>:<span class=\"number\">1134092</span>,<span class=\"attr\">&quot;1968&quot;</span>:<span class=\"number\">1134093</span>,<span class=\"attr\">&quot;1969&quot;</span>:<span class=\"number\">1134094</span>,<span class=\"attr\">&quot;1999&quot;</span>:<span class=\"number\">1134095</span>,<span class=\"attr\">&quot;2000&quot;</span>:<span class=\"number\">1134096</span>,<span class=\"attr\">&quot;2001&quot;</span>:<span class=\"number\">1134097</span>,<span class=\"attr\">&quot;2002&quot;</span>:<span class=\"number\">1134098</span>,<span class=\"attr\">&quot;2003&quot;</span>:<span class=\"number\">1134099</span>,<span class=\"attr\">&quot;2004&quot;</span>:<span class=\"number\">1134100</span>,<span class=\"attr\">&quot;2005&quot;</span>:<span class=\"number\">1134101</span>,<span class=\"attr\">&quot;2006&quot;</span>:<span class=\"number\">1134102</span>,<span class=\"attr\">&quot;2010&quot;</span>:<span class=\"number\">1134103</span>,<span class=\"attr\">&quot;2011&quot;</span>:<span class=\"number\">1134104</span>,<span class=\"attr\">&quot;2012&quot;</span>:<span class=\"number\">1134105</span>,<span class=\"attr\">&quot;2013&quot;</span>:<span class=\"number\">1134106</span>,<span class=\"attr\">&quot;2015&quot;</span>:<span class=\"number\">1134107</span>,<span class=\"attr\">&quot;2016&quot;</span>:<span class=\"number\">1134108</span>,<span class=\"attr\">&quot;2018&quot;</span>:<span class=\"number\">1134109</span>,<span class=\"attr\">&quot;2019&quot;</span>:<span class=\"number\">1134110</span>,<span class=\"attr\">&quot;2020&quot;</span>:<span class=\"number\">1134111</span>,<span class=\"attr\">&quot;2021&quot;</span>:<span class=\"number\">1134112</span>,<span class=\"attr\">&quot;2022&quot;</span>:<span class=\"number\">1134113</span>,<span class=\"attr\">&quot;2023&quot;</span>:<span class=\"number\">1134114</span>,<span class=\"attr\">&quot;2024&quot;</span>:<span class=\"number\">1134115</span>,<span class=\"attr\">&quot;2025&quot;</span>:<span class=\"number\">1134116</span>,<span class=\"attr\">&quot;2027&quot;</span>:<span class=\"number\">1134117</span>,<span class=\"attr\">&quot;2028&quot;</span>:<span class=\"number\">1134118</span>,<span class=\"attr\">&quot;2029&quot;</span>:<span class=\"number\">1134119</span>,<span class=\"attr\">&quot;2030&quot;</span>:<span class=\"number\">1134120</span>,<span class=\"attr\">&quot;2031&quot;</span>:<span class=\"number\">1134121</span>,<span class=\"attr\">&quot;2032&quot;</span>:<span class=\"number\">1134122</span>,<span class=\"attr\">&quot;2033&quot;</span>:<span class=\"number\">1134123</span>,<span class=\"attr\">&quot;2034&quot;</span>:<span class=\"number\">1134124</span>,<span class=\"attr\">&quot;2035&quot;</span>:<span class=\"number\">1134125</span>,<span class=\"attr\">&quot;2036&quot;</span>:<span class=\"number\">1134126</span>,<span class=\"attr\">&quot;2037&quot;</span>:<span class=\"number\">1134127</span>,<span class=\"attr\">&quot;2040&quot;</span>:<span class=\"number\">1134128</span>,<span class=\"attr\">&quot;2041&quot;</span>:<span class=\"number\">1134129</span>,<span class=\"attr\">&quot;2042&quot;</span>:<span class=\"number\">1134130</span>,<span class=\"attr\">&quot;2043&quot;</span>:<span class=\"number\">1134131</span>,<span class=\"attr\">&quot;2044&quot;</span>:<span class=\"number\">1134132</span>,<span class=\"attr\">&quot;2046&quot;</span>:<span class=\"number\">1134133</span>,<span class=\"attr\">&quot;2047&quot;</span>:<span class=\"number\">1134134</span>&#125;,<span class=\"attr\">&quot;waitForBatch&quot;</span>:<span class=\"literal\">true</span>,<span class=\"attr\">&quot;jobType&quot;</span>:<span class=\"string\">&quot;MERGED&quot;</span>,<span class=\"attr\">&quot;treeId&quot;</span>:<span class=\"number\">256</span>,<span class=\"attr\">&quot;treeTypeId&quot;</span>:<span class=\"number\">497</span>&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"合并的任务\"><a href=\"#合并的任务\" class=\"headerlink\" title=\"合并的任务\"></a>合并的任务</h3><p>BatchJobAcceptor。2小时扫描一次</p>\n<p>处理过程同merged 且watiForBatch=false，只是多了个等待时间，会收到多个jobCtx，ExecutionPlanner.INSTANCE.merge(jobCtxList)</p>\n<p><font color=\"#FF000\"><strong>难点在于合并任务的逻辑处理。@see com.datastory.trident.serv.scheduler.ExecutionPlanner#merge</strong></font></p>\n<h2 id=\"修改标签规则\"><a href=\"#修改标签规则\" class=\"headerlink\" title=\"修改标签规则\"></a>修改标签规则</h2><pre class=\"mermaid\">graph TD;\n    subgraph all[全部]\n    start[开始]-->edit[修改标签]\n    edit--执行标签任务-->redis[提交到redis的allJob队列]\n    redis--JobAcceptor#parseMessage-->runJob[执行标签 调用海纳]    \n    runJob-->ostart\n    end\n    subgraph ocean[海纳任务]\n    ostart[海纳task]-->oend[海纳任务执行完成]\n    ostart-->jstart\n    end\n    subgraph JobTracker\n    jstart[从redis的scheduler:running获取运行中的任务]-->isJobEnd{任务是否到达终态}\n    isJobEnd--是-->updateLabelCoverage[更新标签覆盖数]-->processRuleUpdatedLabel{判断规则是否改过}\n    updateLabelCoverage-->processOneTimeLabelStatus[一次性标签需要修改oneTimeStatus状态位为已执行]-->removeFromRedisSet[从redis的running中删除]-->oend\n    isJobEnd--否-->jstart\n    processRuleUpdatedLabel--是-->cleanStart\n    end\n    subgraph ofCleanOldRuleJob[清理修改过规则后的过期标签]\n    cleanStart-->cleanEnd\n    end</pre>\n<h3 id=\"任务终态定义\"><a href=\"#任务终态定义\" class=\"headerlink\" title=\"任务终态定义\"></a>任务终态定义</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">this</span>.equals(SUCCESS) || <span class=\"keyword\">this</span>.equals(TIMEOUT) || <span class=\"keyword\">this</span>.equals(KILLED) || <span class=\"keyword\">this</span>.equals(FAILED) || <span class=\"keyword\">this</span>.equals(SYS_KILLED) || <span class=\"keyword\">this</span>.equals(SYS_FAILED)</span><br></pre></td></tr></table></figure>\n"},{"title":"标签体系一些坑","overdue":false,"date":"2021-01-15T06:24:07.000Z","updated":"2021-01-15T06:24:07.000Z","_content":"# 平台侧\n## 标签树类型\n- [ ] 更新标签树类型的任务（update_tree_type）每晚定时更新，可能不及时\n- [ ] 更新任务可能出错，导致es中info没有数据，但是打标签流程正常，则label_default会有数据。导致 1. 用户平均标签有问题 2. 人群包有问题。（人群包查的info，hasChild）\n- [ ] 物料表的删除、字段变更（包含删除，修改字段吗，修改字段类型等），es的mapping和hbase那边没有更新，某些情况下导致更新标签树类型的任务失败\n- [ ] 迁移集群后，任务失败（除非连得上原来的集群）或数据跟着迁移且avalon跟着更新\n- [ ] 配置\n\n## 标签树\n- [ ] 没有del_flag\n- [ ] 没有删除接口\n- [ ] 在存储方案中没有标签树的信息\n\n## 标签\n- [ ] 深度合并优化\n\n# 业务侧\n## for 领客\n### 通用标签树\n- [ ] 每个租户复制标签树（from 通用标签树）。如果通用标签树还在维护（增删改），租户的标签树怎么同步更新？\n- [ ]\n\n## 标签树类型\n\n## 标签树\n- [ ] 没有统一的前置过滤条件\n","source":"_posts/标签体系一些坑.md","raw":"---\ntitle: 标签体系一些坑\ntags: trident\noverdue: false\ncategories: trident\ndate: 2021-01-15 14:24:07\nupdated: 2021-01-15 14:24:07\n---\n# 平台侧\n## 标签树类型\n- [ ] 更新标签树类型的任务（update_tree_type）每晚定时更新，可能不及时\n- [ ] 更新任务可能出错，导致es中info没有数据，但是打标签流程正常，则label_default会有数据。导致 1. 用户平均标签有问题 2. 人群包有问题。（人群包查的info，hasChild）\n- [ ] 物料表的删除、字段变更（包含删除，修改字段吗，修改字段类型等），es的mapping和hbase那边没有更新，某些情况下导致更新标签树类型的任务失败\n- [ ] 迁移集群后，任务失败（除非连得上原来的集群）或数据跟着迁移且avalon跟着更新\n- [ ] 配置\n\n## 标签树\n- [ ] 没有del_flag\n- [ ] 没有删除接口\n- [ ] 在存储方案中没有标签树的信息\n\n## 标签\n- [ ] 深度合并优化\n\n# 业务侧\n## for 领客\n### 通用标签树\n- [ ] 每个租户复制标签树（from 通用标签树）。如果通用标签树还在维护（增删改），租户的标签树怎么同步更新？\n- [ ]\n\n## 标签树类型\n\n## 标签树\n- [ ] 没有统一的前置过滤条件\n","slug":"标签体系一些坑","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"ckk26vf360008w5ha64t0gx3d","content":"<h1 id=\"平台侧\"><a href=\"#平台侧\" class=\"headerlink\" title=\"平台侧\"></a>平台侧</h1><h2 id=\"标签树类型\"><a href=\"#标签树类型\" class=\"headerlink\" title=\"标签树类型\"></a>标签树类型</h2><ul>\n<li><input disabled=\"\" type=\"checkbox\"> 更新标签树类型的任务（update_tree_type）每晚定时更新，可能不及时</li>\n<li><input disabled=\"\" type=\"checkbox\"> 更新任务可能出错，导致es中info没有数据，但是打标签流程正常，则label_default会有数据。导致 1. 用户平均标签有问题 2. 人群包有问题。（人群包查的info，hasChild）</li>\n<li><input disabled=\"\" type=\"checkbox\"> 物料表的删除、字段变更（包含删除，修改字段吗，修改字段类型等），es的mapping和hbase那边没有更新，某些情况下导致更新标签树类型的任务失败</li>\n<li><input disabled=\"\" type=\"checkbox\"> 迁移集群后，任务失败（除非连得上原来的集群）或数据跟着迁移且avalon跟着更新</li>\n<li><input disabled=\"\" type=\"checkbox\"> 配置</li>\n</ul>\n<h2 id=\"标签树\"><a href=\"#标签树\" class=\"headerlink\" title=\"标签树\"></a>标签树</h2><ul>\n<li><input disabled=\"\" type=\"checkbox\"> 没有del_flag</li>\n<li><input disabled=\"\" type=\"checkbox\"> 没有删除接口</li>\n<li><input disabled=\"\" type=\"checkbox\"> 在存储方案中没有标签树的信息</li>\n</ul>\n<h2 id=\"标签\"><a href=\"#标签\" class=\"headerlink\" title=\"标签\"></a>标签</h2><ul>\n<li><input disabled=\"\" type=\"checkbox\"> 深度合并优化</li>\n</ul>\n<h1 id=\"业务侧\"><a href=\"#业务侧\" class=\"headerlink\" title=\"业务侧\"></a>业务侧</h1><h2 id=\"for-领客\"><a href=\"#for-领客\" class=\"headerlink\" title=\"for 领客\"></a>for 领客</h2><h3 id=\"通用标签树\"><a href=\"#通用标签树\" class=\"headerlink\" title=\"通用标签树\"></a>通用标签树</h3><ul>\n<li><input disabled=\"\" type=\"checkbox\"> 每个租户复制标签树（from 通用标签树）。如果通用标签树还在维护（增删改），租户的标签树怎么同步更新？</li>\n<li>[ ]</li>\n</ul>\n<h2 id=\"标签树类型-1\"><a href=\"#标签树类型-1\" class=\"headerlink\" title=\"标签树类型\"></a>标签树类型</h2><h2 id=\"标签树-1\"><a href=\"#标签树-1\" class=\"headerlink\" title=\"标签树\"></a>标签树</h2><ul>\n<li><input disabled=\"\" type=\"checkbox\"> 没有统一的前置过滤条件</li>\n</ul>\n","site":{"data":{}},"cover":"https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg","excerpt":"","more":"<h1 id=\"平台侧\"><a href=\"#平台侧\" class=\"headerlink\" title=\"平台侧\"></a>平台侧</h1><h2 id=\"标签树类型\"><a href=\"#标签树类型\" class=\"headerlink\" title=\"标签树类型\"></a>标签树类型</h2><ul>\n<li><input disabled=\"\" type=\"checkbox\"> 更新标签树类型的任务（update_tree_type）每晚定时更新，可能不及时</li>\n<li><input disabled=\"\" type=\"checkbox\"> 更新任务可能出错，导致es中info没有数据，但是打标签流程正常，则label_default会有数据。导致 1. 用户平均标签有问题 2. 人群包有问题。（人群包查的info，hasChild）</li>\n<li><input disabled=\"\" type=\"checkbox\"> 物料表的删除、字段变更（包含删除，修改字段吗，修改字段类型等），es的mapping和hbase那边没有更新，某些情况下导致更新标签树类型的任务失败</li>\n<li><input disabled=\"\" type=\"checkbox\"> 迁移集群后，任务失败（除非连得上原来的集群）或数据跟着迁移且avalon跟着更新</li>\n<li><input disabled=\"\" type=\"checkbox\"> 配置</li>\n</ul>\n<h2 id=\"标签树\"><a href=\"#标签树\" class=\"headerlink\" title=\"标签树\"></a>标签树</h2><ul>\n<li><input disabled=\"\" type=\"checkbox\"> 没有del_flag</li>\n<li><input disabled=\"\" type=\"checkbox\"> 没有删除接口</li>\n<li><input disabled=\"\" type=\"checkbox\"> 在存储方案中没有标签树的信息</li>\n</ul>\n<h2 id=\"标签\"><a href=\"#标签\" class=\"headerlink\" title=\"标签\"></a>标签</h2><ul>\n<li><input disabled=\"\" type=\"checkbox\"> 深度合并优化</li>\n</ul>\n<h1 id=\"业务侧\"><a href=\"#业务侧\" class=\"headerlink\" title=\"业务侧\"></a>业务侧</h1><h2 id=\"for-领客\"><a href=\"#for-领客\" class=\"headerlink\" title=\"for 领客\"></a>for 领客</h2><h3 id=\"通用标签树\"><a href=\"#通用标签树\" class=\"headerlink\" title=\"通用标签树\"></a>通用标签树</h3><ul>\n<li><input disabled=\"\" type=\"checkbox\"> 每个租户复制标签树（from 通用标签树）。如果通用标签树还在维护（增删改），租户的标签树怎么同步更新？</li>\n<li>[ ]</li>\n</ul>\n<h2 id=\"标签树类型-1\"><a href=\"#标签树类型-1\" class=\"headerlink\" title=\"标签树类型\"></a>标签树类型</h2><h2 id=\"标签树-1\"><a href=\"#标签树-1\" class=\"headerlink\" title=\"标签树\"></a>标签树</h2><ul>\n<li><input disabled=\"\" type=\"checkbox\"> 没有统一的前置过滤条件</li>\n</ul>\n"},{"title":"标签体系级联更新、删除","overdue":false,"date":"2021-01-12T08:08:28.000Z","updated":"2021-01-12T08:08:28.000Z","_content":"# 数据源被删除\n## 典型场景如下\n+ 标签树类型的物料表在不知道的情况下，被人为物理删除了\n+ 迁移集群后，原来的物料表没有跟着迁移，或迁移后，avalon没有更新物料表元信息\n---\n以上情况会导致标签树类型无法再更新物料表，整个打标签流程都受影响。\n\n## 触发机制\n在updateAllTreeType的定时任务中，判断treeType对应的datasource状态是否为green\n\n非green的情况下，\n+ 标签树类型delFlag设置为1（停用）\n+ 树类型下的delFlag=0的labelInfo，设置delFlag=2\n\ngreen的情况下\n+ 标签树类型delFlag设置为1（停用）\n+ 将树类型下的labelInfo，delFlag=4的都设置回的delFlag=0\n---\n⚠️\n\n**labelTreeType：delFlag： 0启用， 1 停用, 2删除**\n**labelInfo：del_flag 0=未删除 1=删除 添加2=临时删除**\n\n# 数据源更新\n## 典型场景如下\n项目还处在开发阶段，字段类型时有改变，如gender字段早期为varchar类型，取值男、女，后续又改成integer，取值0、1.\n\n## 触发机制\n主动更新（接口更新）\n\n### ES 更新\n 删掉原来的info type，直接新生成\n### HBase更新\n disable table ，alter，enable table\n### 数据库更新\nt_trident_tree_type_corpus、t_trident_corpus_field","source":"_posts/标签体系级联更新、删除.md","raw":"---\ntitle: 标签体系级联更新、删除\ntags: trident\noverdue: false\ncategories: trident\ndate: 2021-01-12 16:08:28\nupdated: 2021-01-12 16:08:28\n---\n# 数据源被删除\n## 典型场景如下\n+ 标签树类型的物料表在不知道的情况下，被人为物理删除了\n+ 迁移集群后，原来的物料表没有跟着迁移，或迁移后，avalon没有更新物料表元信息\n---\n以上情况会导致标签树类型无法再更新物料表，整个打标签流程都受影响。\n\n## 触发机制\n在updateAllTreeType的定时任务中，判断treeType对应的datasource状态是否为green\n\n非green的情况下，\n+ 标签树类型delFlag设置为1（停用）\n+ 树类型下的delFlag=0的labelInfo，设置delFlag=2\n\ngreen的情况下\n+ 标签树类型delFlag设置为1（停用）\n+ 将树类型下的labelInfo，delFlag=4的都设置回的delFlag=0\n---\n⚠️\n\n**labelTreeType：delFlag： 0启用， 1 停用, 2删除**\n**labelInfo：del_flag 0=未删除 1=删除 添加2=临时删除**\n\n# 数据源更新\n## 典型场景如下\n项目还处在开发阶段，字段类型时有改变，如gender字段早期为varchar类型，取值男、女，后续又改成integer，取值0、1.\n\n## 触发机制\n主动更新（接口更新）\n\n### ES 更新\n 删掉原来的info type，直接新生成\n### HBase更新\n disable table ，alter，enable table\n### 数据库更新\nt_trident_tree_type_corpus、t_trident_corpus_field","slug":"标签体系级联更新、删除","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"ckk26vf3d000cw5hag49tenm0","content":"<h1 id=\"数据源被删除\"><a href=\"#数据源被删除\" class=\"headerlink\" title=\"数据源被删除\"></a>数据源被删除</h1><h2 id=\"典型场景如下\"><a href=\"#典型场景如下\" class=\"headerlink\" title=\"典型场景如下\"></a>典型场景如下</h2><ul>\n<li>标签树类型的物料表在不知道的情况下，被人为物理删除了</li>\n<li>迁移集群后，原来的物料表没有跟着迁移，或迁移后，avalon没有更新物料表元信息</li>\n</ul>\n<hr>\n<p>以上情况会导致标签树类型无法再更新物料表，整个打标签流程都受影响。</p>\n<h2 id=\"触发机制\"><a href=\"#触发机制\" class=\"headerlink\" title=\"触发机制\"></a>触发机制</h2><p>在updateAllTreeType的定时任务中，判断treeType对应的datasource状态是否为green</p>\n<p>非green的情况下，</p>\n<ul>\n<li>标签树类型delFlag设置为1（停用）</li>\n<li>树类型下的delFlag=0的labelInfo，设置delFlag=2</li>\n</ul>\n<p>green的情况下</p>\n<ul>\n<li>标签树类型delFlag设置为1（停用）</li>\n<li>将树类型下的labelInfo，delFlag=4的都设置回的delFlag=0</li>\n</ul>\n<hr>\n<p>⚠️</p>\n<p><strong>labelTreeType：delFlag： 0启用， 1 停用, 2删除</strong><br><strong>labelInfo：del_flag 0=未删除 1=删除 添加2=临时删除</strong></p>\n<h1 id=\"数据源更新\"><a href=\"#数据源更新\" class=\"headerlink\" title=\"数据源更新\"></a>数据源更新</h1><h2 id=\"典型场景如下-1\"><a href=\"#典型场景如下-1\" class=\"headerlink\" title=\"典型场景如下\"></a>典型场景如下</h2><p>项目还处在开发阶段，字段类型时有改变，如gender字段早期为varchar类型，取值男、女，后续又改成integer，取值0、1.</p>\n<h2 id=\"触发机制-1\"><a href=\"#触发机制-1\" class=\"headerlink\" title=\"触发机制\"></a>触发机制</h2><p>主动更新（接口更新）</p>\n<h3 id=\"ES-更新\"><a href=\"#ES-更新\" class=\"headerlink\" title=\"ES 更新\"></a>ES 更新</h3><p> 删掉原来的info type，直接新生成</p>\n<h3 id=\"HBase更新\"><a href=\"#HBase更新\" class=\"headerlink\" title=\"HBase更新\"></a>HBase更新</h3><p> disable table ，alter，enable table</p>\n<h3 id=\"数据库更新\"><a href=\"#数据库更新\" class=\"headerlink\" title=\"数据库更新\"></a>数据库更新</h3><p>t_trident_tree_type_corpus、t_trident_corpus_field</p>\n","site":{"data":{}},"cover":"https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg","excerpt":"","more":"<h1 id=\"数据源被删除\"><a href=\"#数据源被删除\" class=\"headerlink\" title=\"数据源被删除\"></a>数据源被删除</h1><h2 id=\"典型场景如下\"><a href=\"#典型场景如下\" class=\"headerlink\" title=\"典型场景如下\"></a>典型场景如下</h2><ul>\n<li>标签树类型的物料表在不知道的情况下，被人为物理删除了</li>\n<li>迁移集群后，原来的物料表没有跟着迁移，或迁移后，avalon没有更新物料表元信息</li>\n</ul>\n<hr>\n<p>以上情况会导致标签树类型无法再更新物料表，整个打标签流程都受影响。</p>\n<h2 id=\"触发机制\"><a href=\"#触发机制\" class=\"headerlink\" title=\"触发机制\"></a>触发机制</h2><p>在updateAllTreeType的定时任务中，判断treeType对应的datasource状态是否为green</p>\n<p>非green的情况下，</p>\n<ul>\n<li>标签树类型delFlag设置为1（停用）</li>\n<li>树类型下的delFlag=0的labelInfo，设置delFlag=2</li>\n</ul>\n<p>green的情况下</p>\n<ul>\n<li>标签树类型delFlag设置为1（停用）</li>\n<li>将树类型下的labelInfo，delFlag=4的都设置回的delFlag=0</li>\n</ul>\n<hr>\n<p>⚠️</p>\n<p><strong>labelTreeType：delFlag： 0启用， 1 停用, 2删除</strong><br><strong>labelInfo：del_flag 0=未删除 1=删除 添加2=临时删除</strong></p>\n<h1 id=\"数据源更新\"><a href=\"#数据源更新\" class=\"headerlink\" title=\"数据源更新\"></a>数据源更新</h1><h2 id=\"典型场景如下-1\"><a href=\"#典型场景如下-1\" class=\"headerlink\" title=\"典型场景如下\"></a>典型场景如下</h2><p>项目还处在开发阶段，字段类型时有改变，如gender字段早期为varchar类型，取值男、女，后续又改成integer，取值0、1.</p>\n<h2 id=\"触发机制-1\"><a href=\"#触发机制-1\" class=\"headerlink\" title=\"触发机制\"></a>触发机制</h2><p>主动更新（接口更新）</p>\n<h3 id=\"ES-更新\"><a href=\"#ES-更新\" class=\"headerlink\" title=\"ES 更新\"></a>ES 更新</h3><p> 删掉原来的info type，直接新生成</p>\n<h3 id=\"HBase更新\"><a href=\"#HBase更新\" class=\"headerlink\" title=\"HBase更新\"></a>HBase更新</h3><p> disable table ，alter，enable table</p>\n<h3 id=\"数据库更新\"><a href=\"#数据库更新\" class=\"headerlink\" title=\"数据库更新\"></a>数据库更新</h3><p>t_trident_tree_type_corpus、t_trident_corpus_field</p>\n"},{"title":"用户画像标签体系3","overdue":false,"date":"2021-01-08T09:11:07.000Z","updated":"2021-01-08T09:11:07.000Z","_content":" 用户画像的核心在于给用户“打标签”，每一个标签通常是人为规定的特征标识，用高度精炼的特征描述一类人，例如年龄、性别、兴趣偏好等，不同的标签通过结构化的数据体系整合，就可与组合出不同的用户画像。\n\n​ 梳理标签体系是实现用户画像过程中最基础、也是最核心的工作，后续的建模、数据仓库搭建都会依赖于标签体系。\n\n​ 为什么需要梳理标签体系，因为不同的企业做用户画像有不同的战略目的，广告公司做用户画像是为精准广告服务，电商做用户画像是为用户购买更多商品，内容平台做用户画像是推荐用户更感兴趣的内容提升流量再变现，金融行业做用户画像是为了寻找到目标客户的同时做好风险的控制。\n\n​ 所以第一步，我们要结合所在的行业，业务去分析我们用户画像的目的。这其实就是战略，我们要通过战略去指引我们最终的方向。\n\n![标签画像](/image/用户画像标签体系1-1610100155452.png)\n\n对于电商企业来说，可能最重要的两个问题就是：\n\n**现有用户- 我的现存用户是谁？为什么买我的产品？他们有什么偏好？哪些用户价值最高？**\n\n**潜在客户- 我的潜在用户在哪儿？他们喜欢什么？哪些渠道能找到他们？获客成本是多少？**\n\n而对于金融企业，还要加上一条：\n\n**用户风险—用户的收入能力怎么样？他们是否有过贷款或者信用卡的逾期？他们的征信有问题吗？**\n\n我们做用户画像的目的也就是根据我们指定的战略方向最终去解决这些问题。\n\n在梳理标签的过程还要紧密的结合我们的数据，不能脱离了数据去空想，当然如果是我们必须要的数据，我们可能需要想办法去获取这些数据，这就是数据采集的问题，我们之后会深入的讨论。\n\n先展示两种常见的标签体系，随后我们将按步骤建立我们的标签体系。\n\n## 电商类标签体系\n![电商类](/image/用户画像标签体系1-1610100324696.png)\n可以看到电商类的标签体系，更关注用户的属性，行为等等信息。那么我们需要的数据也就来源于用户可提供的基本信息，以及用户的行为信息，这些我们可以通过埋点获取，而用户的订单情况也是非常的重要的标签。\n\n## 金融类标签体系\n![金融类](/image/用户画像标签体系1-1610100346329.png)\n对于金融行业，最明显的区别是增加了用户的价值和用户风险的信息。这些信息在用户申请贷款时一般都可以提供，还有很多信息需要通过征信获取。\n\n最终，不管是电商还是金融或者其他领域，我们都可以通过数据对用户进行画像，最终建立标签体系，影响我们的业务，最终实现战略目的。\n\n下面我们来具体看一下如何一步步的分析建立整体标签体系。\n\n## 标签的维度与类型\n在我们建立用户标签时，首先要明确基于哪种维度去建立标签。\n\n一般除了基于用户维度（userid）建立用户标签体系外，还有基于设备维度（cookieid）建立相应的标签体系，当用户没有登录设备时，就需要这个维度。当然这两个维度还可以进行关联。\n\n而两者的关联就是需要ID-Mapping算法来解决，这也是一个非常复杂的算法。更多的时候我们还是以用户的唯一标识来建立用户画像。\n\n而标签也分为很多种类型，这里参照常见的分类方式，\n\n从对用户打标签的方式来看，一般分为三种类型：1、基于统计类的标签；2、基于规则类的标签、3、基于挖掘类的标签。下面我们介绍这三种类型标签的区别：\n\n+ 统计类标签：这类标签是最为基础也最为常见的标签类型，例如对于某个用户来说，他的性别、年龄、城市、星座、近7日活跃时长、近7日活跃天数、近7日活跃次数等字段可以从用户注册数据、用户访问、消费类数据中统计得出。该类标签构成了用户画像的基础；\n\n+ 规则类标签：该类标签基于用户行为及确定的规则产生。例如对平台上“消费活跃”用户这一口径的定义为近30天交易次数>=2。在实际开发画像的过程中，由于运营人员对业务更为熟悉、而数据人员对数据的结构、分布、特征更为熟悉，因此规则类标签的规则确定由运营人员和数据人员共同协商确定；\n\n+ 机器学习挖掘类标签：该类标签通过数据挖掘产生，应用在对用户的某些属性或某些行为进行预测判断。例如根据一个用户的行为习惯判断该用户是男性还是女性，根据一个用户的消费习惯判断其对某商品的偏好程度。该类标签需要通过算法挖掘产生。\n\n标签的类型是对标签的一个区分，方便我们了解标签是在数据处理的哪个阶段产生的，也更方便我们管理。\n\n## 标签分级分类\n标签需要进行分级分类的管理，一方面使得标签更加的清晰有条件，另一方面也方便我们对标签进行存储查询，也就是管理标签。\n\n![标签分级分类](/image/用户画像标签体系1-1610100447523.png)\n用户画像体系和标签分类从两个不同角度来梳理标签，用户画像体系偏战略和应用，标签分类偏管理和技术实现侧。\n\n把标签分成不同的层级和类别，一是方便管理数千个标签，让散乱的标签体系化；二是维度并不孤立，标签之间互有关联；三可以为标签建模提供标签子集。\n\n梳理某类别的子分类时，尽可能的遵循MECE原则（相互独立、完全穷尽），尤其是一些有关用户分类的，要能覆盖所有用户，但又不交叉。比如：用户活跃度的划分为核心用户、活跃用户、新用户、老用户、流失用户，用户消费能力分为超强、强、中、弱，这样按照给定的规则每个用户都有分到不同的组里。\n\n## 标签命名\n标签的命名也是为了我们可以对标签进行统一的管理，也更好识别出是什么标签。\n\n![标签命名](/image/用户画像标签体系1-1610100479337.png)\n这是一种非常好的命名方式，解释如下：\n\n标签主题：用于刻画属于那种类型的标签，如用户属性、用户行为、用户消费、风险控制等多种类型，可用A、B、C、D等\n字母表示各标签主题；\n+ 标签类型：标签类型可划为分类型和统计型这两种类型，其中分类型用于刻画用户属于哪种类型，如是男是女、是否是会员、\n是否已流失等标签，统计型标签用于刻画统计用户的某些行为次数，如历史购买金额、优惠券使用次数、近30日登陆次数等\n标签，这类标签都需要对应一个用户相应行为的权重次数；\n+ 开发方式：开发方式可分为统计型开发和算法型开发两大开发方式。其中统计型开发可直接从数据仓库中各主题表建模加工\n而成，算法型开发需要对数据做机器学习的算法处理得到相应的标签；\n+ 是否互斥标签：对应同一级类目下（如一级标签、二级标签），各标签之间的关系是否为互斥，可将标签划分为互斥关系和\n非互斥关系。例如对于男、女标签就是互斥关系，同一个用户不是被打上男性标签就是女性标签，对于高活跃、中活跃、低\n活跃标签也是互斥关系；\n+ 用户维度：用于刻画该标签是打在用户唯一标识（userid）上，还是打在用户使用的设备（cookieid）上。可用U、C等字\n母分别标识userid和cookieid维度。\n\n最终形成得标签示例：\n\n对于用户是男是女这个标签，标签主题是用户属性，标签类型属于分类型，开发方式为统计型，为互斥关系，用户\n维度为userid。这样给男性用户打上标签“A111U001_001”，女性用户打上标签“A111U001_002”，其中\n“A111U”为上面介绍的命名方式，“001”为一级标签的id，后面对于用户属性维度的其他一级标签可用“002”、\n“003”等方式追加命名，“_”后面的“001”和“002”为该一级标签下的标签明细，如果是划分高、中、低活跃\n用户的，对应一级标签下的明细可划分为“001”、“002”、“003”。\n![ddl](/image/用户画像标签体系1-1610100518466.png)\n\n## 标签存储与管理\n### Hive与Druid数仓存储标签计算结果集\n因为数据非常大，所以跑标签出来的结果必须要通过hive和druid数仓引擎来完成。\n\n在数据仓库的建模过程中，主要是事实表和维度表的开发。\n\n事实表依据业务来开发，描述业务的过程，可以理解为我们对原始数据做ETL整理后业务事实。\n\n而维度表就是我们最终形成的用户维度，维度表是实时变化的，逐渐的建立起用户的画像。\n\n比如用户维度标签：\n\n首先我们根据之前讨论的用户指标体系，将用户按照人口，行为，消费等等建立相关中间表，注意表的命名。\n\n![ETL](/image/用户画像标签体系1-1610100559561.png)\n第一张人口属性表：\n\n![人口属性](/image/用户画像标签体系1-1610100569781.png)\n同样的，其他的也按这种方式进行存储，这种属性类的计算很容易筛选出来。\n\n然后，我们将用户的标签查询出来，汇总到用户身上：\n![汇总sql](/image/用户画像标签体系1-1610100589257.png)\n最终用户的标签就形成了\n\n![用户标签](/image/用户画像标签体系1-1610100608905.png)\n当然，对于复杂的规则和算法类标签，就需要在计算中间表时做更复杂的计算，我们需要在Flink里解决这些复杂的计算，未来开发中我们会详细的讨论，这一部分先根据标签体系把相应的表结构都设计出来。\n\n### Mysql存储标签元数据\nMysql对于小数据量的读写速度更快，也更适合我们对标签定义，管理。我们也可以在前端开发标签的管理页面。\n\n![metadata](/image/用户画像标签体系1-1610100632944.png)\n我们在mysql存储的字段如图所示，在页面上提供编辑等功能，在开发标签的过程中，就可以控制标签的使用了。\n\n这样，我们的标签体系已经根据实际的业务情况建立起来了，在明确了标签体系以后，也就明确了我们的业务支撑。\n\n从下一章开始我们将正式开始搭建大数据集群，接入数据，进行标签开发。\n\n\n\n转载自 [用户画像标签体系——从零开始搭建实时用户画像(三)](https://www.cnblogs.com/tree1123/p/12979172.html)","source":"_posts/用户画像标签体系3.md","raw":"---\ntitle: 用户画像标签体系3\ntags: trident 标签 画像\noverdue: false\ncategories: trident 标签 画像\ndate: 2021-01-08 17:11:07\nupdated: 2021-01-08 17:11:07\n---\n 用户画像的核心在于给用户“打标签”，每一个标签通常是人为规定的特征标识，用高度精炼的特征描述一类人，例如年龄、性别、兴趣偏好等，不同的标签通过结构化的数据体系整合，就可与组合出不同的用户画像。\n\n​ 梳理标签体系是实现用户画像过程中最基础、也是最核心的工作，后续的建模、数据仓库搭建都会依赖于标签体系。\n\n​ 为什么需要梳理标签体系，因为不同的企业做用户画像有不同的战略目的，广告公司做用户画像是为精准广告服务，电商做用户画像是为用户购买更多商品，内容平台做用户画像是推荐用户更感兴趣的内容提升流量再变现，金融行业做用户画像是为了寻找到目标客户的同时做好风险的控制。\n\n​ 所以第一步，我们要结合所在的行业，业务去分析我们用户画像的目的。这其实就是战略，我们要通过战略去指引我们最终的方向。\n\n![标签画像](/image/用户画像标签体系1-1610100155452.png)\n\n对于电商企业来说，可能最重要的两个问题就是：\n\n**现有用户- 我的现存用户是谁？为什么买我的产品？他们有什么偏好？哪些用户价值最高？**\n\n**潜在客户- 我的潜在用户在哪儿？他们喜欢什么？哪些渠道能找到他们？获客成本是多少？**\n\n而对于金融企业，还要加上一条：\n\n**用户风险—用户的收入能力怎么样？他们是否有过贷款或者信用卡的逾期？他们的征信有问题吗？**\n\n我们做用户画像的目的也就是根据我们指定的战略方向最终去解决这些问题。\n\n在梳理标签的过程还要紧密的结合我们的数据，不能脱离了数据去空想，当然如果是我们必须要的数据，我们可能需要想办法去获取这些数据，这就是数据采集的问题，我们之后会深入的讨论。\n\n先展示两种常见的标签体系，随后我们将按步骤建立我们的标签体系。\n\n## 电商类标签体系\n![电商类](/image/用户画像标签体系1-1610100324696.png)\n可以看到电商类的标签体系，更关注用户的属性，行为等等信息。那么我们需要的数据也就来源于用户可提供的基本信息，以及用户的行为信息，这些我们可以通过埋点获取，而用户的订单情况也是非常的重要的标签。\n\n## 金融类标签体系\n![金融类](/image/用户画像标签体系1-1610100346329.png)\n对于金融行业，最明显的区别是增加了用户的价值和用户风险的信息。这些信息在用户申请贷款时一般都可以提供，还有很多信息需要通过征信获取。\n\n最终，不管是电商还是金融或者其他领域，我们都可以通过数据对用户进行画像，最终建立标签体系，影响我们的业务，最终实现战略目的。\n\n下面我们来具体看一下如何一步步的分析建立整体标签体系。\n\n## 标签的维度与类型\n在我们建立用户标签时，首先要明确基于哪种维度去建立标签。\n\n一般除了基于用户维度（userid）建立用户标签体系外，还有基于设备维度（cookieid）建立相应的标签体系，当用户没有登录设备时，就需要这个维度。当然这两个维度还可以进行关联。\n\n而两者的关联就是需要ID-Mapping算法来解决，这也是一个非常复杂的算法。更多的时候我们还是以用户的唯一标识来建立用户画像。\n\n而标签也分为很多种类型，这里参照常见的分类方式，\n\n从对用户打标签的方式来看，一般分为三种类型：1、基于统计类的标签；2、基于规则类的标签、3、基于挖掘类的标签。下面我们介绍这三种类型标签的区别：\n\n+ 统计类标签：这类标签是最为基础也最为常见的标签类型，例如对于某个用户来说，他的性别、年龄、城市、星座、近7日活跃时长、近7日活跃天数、近7日活跃次数等字段可以从用户注册数据、用户访问、消费类数据中统计得出。该类标签构成了用户画像的基础；\n\n+ 规则类标签：该类标签基于用户行为及确定的规则产生。例如对平台上“消费活跃”用户这一口径的定义为近30天交易次数>=2。在实际开发画像的过程中，由于运营人员对业务更为熟悉、而数据人员对数据的结构、分布、特征更为熟悉，因此规则类标签的规则确定由运营人员和数据人员共同协商确定；\n\n+ 机器学习挖掘类标签：该类标签通过数据挖掘产生，应用在对用户的某些属性或某些行为进行预测判断。例如根据一个用户的行为习惯判断该用户是男性还是女性，根据一个用户的消费习惯判断其对某商品的偏好程度。该类标签需要通过算法挖掘产生。\n\n标签的类型是对标签的一个区分，方便我们了解标签是在数据处理的哪个阶段产生的，也更方便我们管理。\n\n## 标签分级分类\n标签需要进行分级分类的管理，一方面使得标签更加的清晰有条件，另一方面也方便我们对标签进行存储查询，也就是管理标签。\n\n![标签分级分类](/image/用户画像标签体系1-1610100447523.png)\n用户画像体系和标签分类从两个不同角度来梳理标签，用户画像体系偏战略和应用，标签分类偏管理和技术实现侧。\n\n把标签分成不同的层级和类别，一是方便管理数千个标签，让散乱的标签体系化；二是维度并不孤立，标签之间互有关联；三可以为标签建模提供标签子集。\n\n梳理某类别的子分类时，尽可能的遵循MECE原则（相互独立、完全穷尽），尤其是一些有关用户分类的，要能覆盖所有用户，但又不交叉。比如：用户活跃度的划分为核心用户、活跃用户、新用户、老用户、流失用户，用户消费能力分为超强、强、中、弱，这样按照给定的规则每个用户都有分到不同的组里。\n\n## 标签命名\n标签的命名也是为了我们可以对标签进行统一的管理，也更好识别出是什么标签。\n\n![标签命名](/image/用户画像标签体系1-1610100479337.png)\n这是一种非常好的命名方式，解释如下：\n\n标签主题：用于刻画属于那种类型的标签，如用户属性、用户行为、用户消费、风险控制等多种类型，可用A、B、C、D等\n字母表示各标签主题；\n+ 标签类型：标签类型可划为分类型和统计型这两种类型，其中分类型用于刻画用户属于哪种类型，如是男是女、是否是会员、\n是否已流失等标签，统计型标签用于刻画统计用户的某些行为次数，如历史购买金额、优惠券使用次数、近30日登陆次数等\n标签，这类标签都需要对应一个用户相应行为的权重次数；\n+ 开发方式：开发方式可分为统计型开发和算法型开发两大开发方式。其中统计型开发可直接从数据仓库中各主题表建模加工\n而成，算法型开发需要对数据做机器学习的算法处理得到相应的标签；\n+ 是否互斥标签：对应同一级类目下（如一级标签、二级标签），各标签之间的关系是否为互斥，可将标签划分为互斥关系和\n非互斥关系。例如对于男、女标签就是互斥关系，同一个用户不是被打上男性标签就是女性标签，对于高活跃、中活跃、低\n活跃标签也是互斥关系；\n+ 用户维度：用于刻画该标签是打在用户唯一标识（userid）上，还是打在用户使用的设备（cookieid）上。可用U、C等字\n母分别标识userid和cookieid维度。\n\n最终形成得标签示例：\n\n对于用户是男是女这个标签，标签主题是用户属性，标签类型属于分类型，开发方式为统计型，为互斥关系，用户\n维度为userid。这样给男性用户打上标签“A111U001_001”，女性用户打上标签“A111U001_002”，其中\n“A111U”为上面介绍的命名方式，“001”为一级标签的id，后面对于用户属性维度的其他一级标签可用“002”、\n“003”等方式追加命名，“_”后面的“001”和“002”为该一级标签下的标签明细，如果是划分高、中、低活跃\n用户的，对应一级标签下的明细可划分为“001”、“002”、“003”。\n![ddl](/image/用户画像标签体系1-1610100518466.png)\n\n## 标签存储与管理\n### Hive与Druid数仓存储标签计算结果集\n因为数据非常大，所以跑标签出来的结果必须要通过hive和druid数仓引擎来完成。\n\n在数据仓库的建模过程中，主要是事实表和维度表的开发。\n\n事实表依据业务来开发，描述业务的过程，可以理解为我们对原始数据做ETL整理后业务事实。\n\n而维度表就是我们最终形成的用户维度，维度表是实时变化的，逐渐的建立起用户的画像。\n\n比如用户维度标签：\n\n首先我们根据之前讨论的用户指标体系，将用户按照人口，行为，消费等等建立相关中间表，注意表的命名。\n\n![ETL](/image/用户画像标签体系1-1610100559561.png)\n第一张人口属性表：\n\n![人口属性](/image/用户画像标签体系1-1610100569781.png)\n同样的，其他的也按这种方式进行存储，这种属性类的计算很容易筛选出来。\n\n然后，我们将用户的标签查询出来，汇总到用户身上：\n![汇总sql](/image/用户画像标签体系1-1610100589257.png)\n最终用户的标签就形成了\n\n![用户标签](/image/用户画像标签体系1-1610100608905.png)\n当然，对于复杂的规则和算法类标签，就需要在计算中间表时做更复杂的计算，我们需要在Flink里解决这些复杂的计算，未来开发中我们会详细的讨论，这一部分先根据标签体系把相应的表结构都设计出来。\n\n### Mysql存储标签元数据\nMysql对于小数据量的读写速度更快，也更适合我们对标签定义，管理。我们也可以在前端开发标签的管理页面。\n\n![metadata](/image/用户画像标签体系1-1610100632944.png)\n我们在mysql存储的字段如图所示，在页面上提供编辑等功能，在开发标签的过程中，就可以控制标签的使用了。\n\n这样，我们的标签体系已经根据实际的业务情况建立起来了，在明确了标签体系以后，也就明确了我们的业务支撑。\n\n从下一章开始我们将正式开始搭建大数据集群，接入数据，进行标签开发。\n\n\n\n转载自 [用户画像标签体系——从零开始搭建实时用户画像(三)](https://www.cnblogs.com/tree1123/p/12979172.html)","slug":"用户画像标签体系3","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"ckk26vf3q000dw5ha1sek33jk","content":"<p> 用户画像的核心在于给用户“打标签”，每一个标签通常是人为规定的特征标识，用高度精炼的特征描述一类人，例如年龄、性别、兴趣偏好等，不同的标签通过结构化的数据体系整合，就可与组合出不同的用户画像。</p>\n<p>​ 梳理标签体系是实现用户画像过程中最基础、也是最核心的工作，后续的建模、数据仓库搭建都会依赖于标签体系。</p>\n<p>​ 为什么需要梳理标签体系，因为不同的企业做用户画像有不同的战略目的，广告公司做用户画像是为精准广告服务，电商做用户画像是为用户购买更多商品，内容平台做用户画像是推荐用户更感兴趣的内容提升流量再变现，金融行业做用户画像是为了寻找到目标客户的同时做好风险的控制。</p>\n<p>​ 所以第一步，我们要结合所在的行业，业务去分析我们用户画像的目的。这其实就是战略，我们要通过战略去指引我们最终的方向。</p>\n<p><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100155452.png\" alt=\"标签画像\"></p>\n<p>对于电商企业来说，可能最重要的两个问题就是：</p>\n<p><strong>现有用户- 我的现存用户是谁？为什么买我的产品？他们有什么偏好？哪些用户价值最高？</strong></p>\n<p><strong>潜在客户- 我的潜在用户在哪儿？他们喜欢什么？哪些渠道能找到他们？获客成本是多少？</strong></p>\n<p>而对于金融企业，还要加上一条：</p>\n<p><strong>用户风险—用户的收入能力怎么样？他们是否有过贷款或者信用卡的逾期？他们的征信有问题吗？</strong></p>\n<p>我们做用户画像的目的也就是根据我们指定的战略方向最终去解决这些问题。</p>\n<p>在梳理标签的过程还要紧密的结合我们的数据，不能脱离了数据去空想，当然如果是我们必须要的数据，我们可能需要想办法去获取这些数据，这就是数据采集的问题，我们之后会深入的讨论。</p>\n<p>先展示两种常见的标签体系，随后我们将按步骤建立我们的标签体系。</p>\n<h2 id=\"电商类标签体系\"><a href=\"#电商类标签体系\" class=\"headerlink\" title=\"电商类标签体系\"></a>电商类标签体系</h2><p><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100324696.png\" alt=\"电商类\"><br>可以看到电商类的标签体系，更关注用户的属性，行为等等信息。那么我们需要的数据也就来源于用户可提供的基本信息，以及用户的行为信息，这些我们可以通过埋点获取，而用户的订单情况也是非常的重要的标签。</p>\n<h2 id=\"金融类标签体系\"><a href=\"#金融类标签体系\" class=\"headerlink\" title=\"金融类标签体系\"></a>金融类标签体系</h2><p><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100346329.png\" alt=\"金融类\"><br>对于金融行业，最明显的区别是增加了用户的价值和用户风险的信息。这些信息在用户申请贷款时一般都可以提供，还有很多信息需要通过征信获取。</p>\n<p>最终，不管是电商还是金融或者其他领域，我们都可以通过数据对用户进行画像，最终建立标签体系，影响我们的业务，最终实现战略目的。</p>\n<p>下面我们来具体看一下如何一步步的分析建立整体标签体系。</p>\n<h2 id=\"标签的维度与类型\"><a href=\"#标签的维度与类型\" class=\"headerlink\" title=\"标签的维度与类型\"></a>标签的维度与类型</h2><p>在我们建立用户标签时，首先要明确基于哪种维度去建立标签。</p>\n<p>一般除了基于用户维度（userid）建立用户标签体系外，还有基于设备维度（cookieid）建立相应的标签体系，当用户没有登录设备时，就需要这个维度。当然这两个维度还可以进行关联。</p>\n<p>而两者的关联就是需要ID-Mapping算法来解决，这也是一个非常复杂的算法。更多的时候我们还是以用户的唯一标识来建立用户画像。</p>\n<p>而标签也分为很多种类型，这里参照常见的分类方式，</p>\n<p>从对用户打标签的方式来看，一般分为三种类型：1、基于统计类的标签；2、基于规则类的标签、3、基于挖掘类的标签。下面我们介绍这三种类型标签的区别：</p>\n<ul>\n<li><p>统计类标签：这类标签是最为基础也最为常见的标签类型，例如对于某个用户来说，他的性别、年龄、城市、星座、近7日活跃时长、近7日活跃天数、近7日活跃次数等字段可以从用户注册数据、用户访问、消费类数据中统计得出。该类标签构成了用户画像的基础；</p>\n</li>\n<li><p>规则类标签：该类标签基于用户行为及确定的规则产生。例如对平台上“消费活跃”用户这一口径的定义为近30天交易次数&gt;=2。在实际开发画像的过程中，由于运营人员对业务更为熟悉、而数据人员对数据的结构、分布、特征更为熟悉，因此规则类标签的规则确定由运营人员和数据人员共同协商确定；</p>\n</li>\n<li><p>机器学习挖掘类标签：该类标签通过数据挖掘产生，应用在对用户的某些属性或某些行为进行预测判断。例如根据一个用户的行为习惯判断该用户是男性还是女性，根据一个用户的消费习惯判断其对某商品的偏好程度。该类标签需要通过算法挖掘产生。</p>\n</li>\n</ul>\n<p>标签的类型是对标签的一个区分，方便我们了解标签是在数据处理的哪个阶段产生的，也更方便我们管理。</p>\n<h2 id=\"标签分级分类\"><a href=\"#标签分级分类\" class=\"headerlink\" title=\"标签分级分类\"></a>标签分级分类</h2><p>标签需要进行分级分类的管理，一方面使得标签更加的清晰有条件，另一方面也方便我们对标签进行存储查询，也就是管理标签。</p>\n<p><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100447523.png\" alt=\"标签分级分类\"><br>用户画像体系和标签分类从两个不同角度来梳理标签，用户画像体系偏战略和应用，标签分类偏管理和技术实现侧。</p>\n<p>把标签分成不同的层级和类别，一是方便管理数千个标签，让散乱的标签体系化；二是维度并不孤立，标签之间互有关联；三可以为标签建模提供标签子集。</p>\n<p>梳理某类别的子分类时，尽可能的遵循MECE原则（相互独立、完全穷尽），尤其是一些有关用户分类的，要能覆盖所有用户，但又不交叉。比如：用户活跃度的划分为核心用户、活跃用户、新用户、老用户、流失用户，用户消费能力分为超强、强、中、弱，这样按照给定的规则每个用户都有分到不同的组里。</p>\n<h2 id=\"标签命名\"><a href=\"#标签命名\" class=\"headerlink\" title=\"标签命名\"></a>标签命名</h2><p>标签的命名也是为了我们可以对标签进行统一的管理，也更好识别出是什么标签。</p>\n<p><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100479337.png\" alt=\"标签命名\"><br>这是一种非常好的命名方式，解释如下：</p>\n<p>标签主题：用于刻画属于那种类型的标签，如用户属性、用户行为、用户消费、风险控制等多种类型，可用A、B、C、D等<br>字母表示各标签主题；</p>\n<ul>\n<li>标签类型：标签类型可划为分类型和统计型这两种类型，其中分类型用于刻画用户属于哪种类型，如是男是女、是否是会员、<br>是否已流失等标签，统计型标签用于刻画统计用户的某些行为次数，如历史购买金额、优惠券使用次数、近30日登陆次数等<br>标签，这类标签都需要对应一个用户相应行为的权重次数；</li>\n<li>开发方式：开发方式可分为统计型开发和算法型开发两大开发方式。其中统计型开发可直接从数据仓库中各主题表建模加工<br>而成，算法型开发需要对数据做机器学习的算法处理得到相应的标签；</li>\n<li>是否互斥标签：对应同一级类目下（如一级标签、二级标签），各标签之间的关系是否为互斥，可将标签划分为互斥关系和<br>非互斥关系。例如对于男、女标签就是互斥关系，同一个用户不是被打上男性标签就是女性标签，对于高活跃、中活跃、低<br>活跃标签也是互斥关系；</li>\n<li>用户维度：用于刻画该标签是打在用户唯一标识（userid）上，还是打在用户使用的设备（cookieid）上。可用U、C等字<br>母分别标识userid和cookieid维度。</li>\n</ul>\n<p>最终形成得标签示例：</p>\n<p>对于用户是男是女这个标签，标签主题是用户属性，标签类型属于分类型，开发方式为统计型，为互斥关系，用户<br>维度为userid。这样给男性用户打上标签“A111U001_001”，女性用户打上标签“A111U001_002”，其中<br>“A111U”为上面介绍的命名方式，“001”为一级标签的id，后面对于用户属性维度的其他一级标签可用“002”、<br>“003”等方式追加命名，“_”后面的“001”和“002”为该一级标签下的标签明细，如果是划分高、中、低活跃<br>用户的，对应一级标签下的明细可划分为“001”、“002”、“003”。<br><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100518466.png\" alt=\"ddl\"></p>\n<h2 id=\"标签存储与管理\"><a href=\"#标签存储与管理\" class=\"headerlink\" title=\"标签存储与管理\"></a>标签存储与管理</h2><h3 id=\"Hive与Druid数仓存储标签计算结果集\"><a href=\"#Hive与Druid数仓存储标签计算结果集\" class=\"headerlink\" title=\"Hive与Druid数仓存储标签计算结果集\"></a>Hive与Druid数仓存储标签计算结果集</h3><p>因为数据非常大，所以跑标签出来的结果必须要通过hive和druid数仓引擎来完成。</p>\n<p>在数据仓库的建模过程中，主要是事实表和维度表的开发。</p>\n<p>事实表依据业务来开发，描述业务的过程，可以理解为我们对原始数据做ETL整理后业务事实。</p>\n<p>而维度表就是我们最终形成的用户维度，维度表是实时变化的，逐渐的建立起用户的画像。</p>\n<p>比如用户维度标签：</p>\n<p>首先我们根据之前讨论的用户指标体系，将用户按照人口，行为，消费等等建立相关中间表，注意表的命名。</p>\n<p><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100559561.png\" alt=\"ETL\"><br>第一张人口属性表：</p>\n<p><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100569781.png\" alt=\"人口属性\"><br>同样的，其他的也按这种方式进行存储，这种属性类的计算很容易筛选出来。</p>\n<p>然后，我们将用户的标签查询出来，汇总到用户身上：<br><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100589257.png\" alt=\"汇总sql\"><br>最终用户的标签就形成了</p>\n<p><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100608905.png\" alt=\"用户标签\"><br>当然，对于复杂的规则和算法类标签，就需要在计算中间表时做更复杂的计算，我们需要在Flink里解决这些复杂的计算，未来开发中我们会详细的讨论，这一部分先根据标签体系把相应的表结构都设计出来。</p>\n<h3 id=\"Mysql存储标签元数据\"><a href=\"#Mysql存储标签元数据\" class=\"headerlink\" title=\"Mysql存储标签元数据\"></a>Mysql存储标签元数据</h3><p>Mysql对于小数据量的读写速度更快，也更适合我们对标签定义，管理。我们也可以在前端开发标签的管理页面。</p>\n<p><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100632944.png\" alt=\"metadata\"><br>我们在mysql存储的字段如图所示，在页面上提供编辑等功能，在开发标签的过程中，就可以控制标签的使用了。</p>\n<p>这样，我们的标签体系已经根据实际的业务情况建立起来了，在明确了标签体系以后，也就明确了我们的业务支撑。</p>\n<p>从下一章开始我们将正式开始搭建大数据集群，接入数据，进行标签开发。</p>\n<p>转载自 <a href=\"https://www.cnblogs.com/tree1123/p/12979172.html\">用户画像标签体系——从零开始搭建实时用户画像(三)</a></p>\n","site":{"data":{}},"cover":"https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg","excerpt":"","more":"<p> 用户画像的核心在于给用户“打标签”，每一个标签通常是人为规定的特征标识，用高度精炼的特征描述一类人，例如年龄、性别、兴趣偏好等，不同的标签通过结构化的数据体系整合，就可与组合出不同的用户画像。</p>\n<p>​ 梳理标签体系是实现用户画像过程中最基础、也是最核心的工作，后续的建模、数据仓库搭建都会依赖于标签体系。</p>\n<p>​ 为什么需要梳理标签体系，因为不同的企业做用户画像有不同的战略目的，广告公司做用户画像是为精准广告服务，电商做用户画像是为用户购买更多商品，内容平台做用户画像是推荐用户更感兴趣的内容提升流量再变现，金融行业做用户画像是为了寻找到目标客户的同时做好风险的控制。</p>\n<p>​ 所以第一步，我们要结合所在的行业，业务去分析我们用户画像的目的。这其实就是战略，我们要通过战略去指引我们最终的方向。</p>\n<p><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100155452.png\" alt=\"标签画像\"></p>\n<p>对于电商企业来说，可能最重要的两个问题就是：</p>\n<p><strong>现有用户- 我的现存用户是谁？为什么买我的产品？他们有什么偏好？哪些用户价值最高？</strong></p>\n<p><strong>潜在客户- 我的潜在用户在哪儿？他们喜欢什么？哪些渠道能找到他们？获客成本是多少？</strong></p>\n<p>而对于金融企业，还要加上一条：</p>\n<p><strong>用户风险—用户的收入能力怎么样？他们是否有过贷款或者信用卡的逾期？他们的征信有问题吗？</strong></p>\n<p>我们做用户画像的目的也就是根据我们指定的战略方向最终去解决这些问题。</p>\n<p>在梳理标签的过程还要紧密的结合我们的数据，不能脱离了数据去空想，当然如果是我们必须要的数据，我们可能需要想办法去获取这些数据，这就是数据采集的问题，我们之后会深入的讨论。</p>\n<p>先展示两种常见的标签体系，随后我们将按步骤建立我们的标签体系。</p>\n<h2 id=\"电商类标签体系\"><a href=\"#电商类标签体系\" class=\"headerlink\" title=\"电商类标签体系\"></a>电商类标签体系</h2><p><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100324696.png\" alt=\"电商类\"><br>可以看到电商类的标签体系，更关注用户的属性，行为等等信息。那么我们需要的数据也就来源于用户可提供的基本信息，以及用户的行为信息，这些我们可以通过埋点获取，而用户的订单情况也是非常的重要的标签。</p>\n<h2 id=\"金融类标签体系\"><a href=\"#金融类标签体系\" class=\"headerlink\" title=\"金融类标签体系\"></a>金融类标签体系</h2><p><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100346329.png\" alt=\"金融类\"><br>对于金融行业，最明显的区别是增加了用户的价值和用户风险的信息。这些信息在用户申请贷款时一般都可以提供，还有很多信息需要通过征信获取。</p>\n<p>最终，不管是电商还是金融或者其他领域，我们都可以通过数据对用户进行画像，最终建立标签体系，影响我们的业务，最终实现战略目的。</p>\n<p>下面我们来具体看一下如何一步步的分析建立整体标签体系。</p>\n<h2 id=\"标签的维度与类型\"><a href=\"#标签的维度与类型\" class=\"headerlink\" title=\"标签的维度与类型\"></a>标签的维度与类型</h2><p>在我们建立用户标签时，首先要明确基于哪种维度去建立标签。</p>\n<p>一般除了基于用户维度（userid）建立用户标签体系外，还有基于设备维度（cookieid）建立相应的标签体系，当用户没有登录设备时，就需要这个维度。当然这两个维度还可以进行关联。</p>\n<p>而两者的关联就是需要ID-Mapping算法来解决，这也是一个非常复杂的算法。更多的时候我们还是以用户的唯一标识来建立用户画像。</p>\n<p>而标签也分为很多种类型，这里参照常见的分类方式，</p>\n<p>从对用户打标签的方式来看，一般分为三种类型：1、基于统计类的标签；2、基于规则类的标签、3、基于挖掘类的标签。下面我们介绍这三种类型标签的区别：</p>\n<ul>\n<li><p>统计类标签：这类标签是最为基础也最为常见的标签类型，例如对于某个用户来说，他的性别、年龄、城市、星座、近7日活跃时长、近7日活跃天数、近7日活跃次数等字段可以从用户注册数据、用户访问、消费类数据中统计得出。该类标签构成了用户画像的基础；</p>\n</li>\n<li><p>规则类标签：该类标签基于用户行为及确定的规则产生。例如对平台上“消费活跃”用户这一口径的定义为近30天交易次数&gt;=2。在实际开发画像的过程中，由于运营人员对业务更为熟悉、而数据人员对数据的结构、分布、特征更为熟悉，因此规则类标签的规则确定由运营人员和数据人员共同协商确定；</p>\n</li>\n<li><p>机器学习挖掘类标签：该类标签通过数据挖掘产生，应用在对用户的某些属性或某些行为进行预测判断。例如根据一个用户的行为习惯判断该用户是男性还是女性，根据一个用户的消费习惯判断其对某商品的偏好程度。该类标签需要通过算法挖掘产生。</p>\n</li>\n</ul>\n<p>标签的类型是对标签的一个区分，方便我们了解标签是在数据处理的哪个阶段产生的，也更方便我们管理。</p>\n<h2 id=\"标签分级分类\"><a href=\"#标签分级分类\" class=\"headerlink\" title=\"标签分级分类\"></a>标签分级分类</h2><p>标签需要进行分级分类的管理，一方面使得标签更加的清晰有条件，另一方面也方便我们对标签进行存储查询，也就是管理标签。</p>\n<p><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100447523.png\" alt=\"标签分级分类\"><br>用户画像体系和标签分类从两个不同角度来梳理标签，用户画像体系偏战略和应用，标签分类偏管理和技术实现侧。</p>\n<p>把标签分成不同的层级和类别，一是方便管理数千个标签，让散乱的标签体系化；二是维度并不孤立，标签之间互有关联；三可以为标签建模提供标签子集。</p>\n<p>梳理某类别的子分类时，尽可能的遵循MECE原则（相互独立、完全穷尽），尤其是一些有关用户分类的，要能覆盖所有用户，但又不交叉。比如：用户活跃度的划分为核心用户、活跃用户、新用户、老用户、流失用户，用户消费能力分为超强、强、中、弱，这样按照给定的规则每个用户都有分到不同的组里。</p>\n<h2 id=\"标签命名\"><a href=\"#标签命名\" class=\"headerlink\" title=\"标签命名\"></a>标签命名</h2><p>标签的命名也是为了我们可以对标签进行统一的管理，也更好识别出是什么标签。</p>\n<p><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100479337.png\" alt=\"标签命名\"><br>这是一种非常好的命名方式，解释如下：</p>\n<p>标签主题：用于刻画属于那种类型的标签，如用户属性、用户行为、用户消费、风险控制等多种类型，可用A、B、C、D等<br>字母表示各标签主题；</p>\n<ul>\n<li>标签类型：标签类型可划为分类型和统计型这两种类型，其中分类型用于刻画用户属于哪种类型，如是男是女、是否是会员、<br>是否已流失等标签，统计型标签用于刻画统计用户的某些行为次数，如历史购买金额、优惠券使用次数、近30日登陆次数等<br>标签，这类标签都需要对应一个用户相应行为的权重次数；</li>\n<li>开发方式：开发方式可分为统计型开发和算法型开发两大开发方式。其中统计型开发可直接从数据仓库中各主题表建模加工<br>而成，算法型开发需要对数据做机器学习的算法处理得到相应的标签；</li>\n<li>是否互斥标签：对应同一级类目下（如一级标签、二级标签），各标签之间的关系是否为互斥，可将标签划分为互斥关系和<br>非互斥关系。例如对于男、女标签就是互斥关系，同一个用户不是被打上男性标签就是女性标签，对于高活跃、中活跃、低<br>活跃标签也是互斥关系；</li>\n<li>用户维度：用于刻画该标签是打在用户唯一标识（userid）上，还是打在用户使用的设备（cookieid）上。可用U、C等字<br>母分别标识userid和cookieid维度。</li>\n</ul>\n<p>最终形成得标签示例：</p>\n<p>对于用户是男是女这个标签，标签主题是用户属性，标签类型属于分类型，开发方式为统计型，为互斥关系，用户<br>维度为userid。这样给男性用户打上标签“A111U001_001”，女性用户打上标签“A111U001_002”，其中<br>“A111U”为上面介绍的命名方式，“001”为一级标签的id，后面对于用户属性维度的其他一级标签可用“002”、<br>“003”等方式追加命名，“_”后面的“001”和“002”为该一级标签下的标签明细，如果是划分高、中、低活跃<br>用户的，对应一级标签下的明细可划分为“001”、“002”、“003”。<br><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100518466.png\" alt=\"ddl\"></p>\n<h2 id=\"标签存储与管理\"><a href=\"#标签存储与管理\" class=\"headerlink\" title=\"标签存储与管理\"></a>标签存储与管理</h2><h3 id=\"Hive与Druid数仓存储标签计算结果集\"><a href=\"#Hive与Druid数仓存储标签计算结果集\" class=\"headerlink\" title=\"Hive与Druid数仓存储标签计算结果集\"></a>Hive与Druid数仓存储标签计算结果集</h3><p>因为数据非常大，所以跑标签出来的结果必须要通过hive和druid数仓引擎来完成。</p>\n<p>在数据仓库的建模过程中，主要是事实表和维度表的开发。</p>\n<p>事实表依据业务来开发，描述业务的过程，可以理解为我们对原始数据做ETL整理后业务事实。</p>\n<p>而维度表就是我们最终形成的用户维度，维度表是实时变化的，逐渐的建立起用户的画像。</p>\n<p>比如用户维度标签：</p>\n<p>首先我们根据之前讨论的用户指标体系，将用户按照人口，行为，消费等等建立相关中间表，注意表的命名。</p>\n<p><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100559561.png\" alt=\"ETL\"><br>第一张人口属性表：</p>\n<p><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100569781.png\" alt=\"人口属性\"><br>同样的，其他的也按这种方式进行存储，这种属性类的计算很容易筛选出来。</p>\n<p>然后，我们将用户的标签查询出来，汇总到用户身上：<br><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100589257.png\" alt=\"汇总sql\"><br>最终用户的标签就形成了</p>\n<p><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100608905.png\" alt=\"用户标签\"><br>当然，对于复杂的规则和算法类标签，就需要在计算中间表时做更复杂的计算，我们需要在Flink里解决这些复杂的计算，未来开发中我们会详细的讨论，这一部分先根据标签体系把相应的表结构都设计出来。</p>\n<h3 id=\"Mysql存储标签元数据\"><a href=\"#Mysql存储标签元数据\" class=\"headerlink\" title=\"Mysql存储标签元数据\"></a>Mysql存储标签元数据</h3><p>Mysql对于小数据量的读写速度更快，也更适合我们对标签定义，管理。我们也可以在前端开发标签的管理页面。</p>\n<p><img src=\"/image/%E7%94%A8%E6%88%B7%E7%94%BB%E5%83%8F%E6%A0%87%E7%AD%BE%E4%BD%93%E7%B3%BB1-1610100632944.png\" alt=\"metadata\"><br>我们在mysql存储的字段如图所示，在页面上提供编辑等功能，在开发标签的过程中，就可以控制标签的使用了。</p>\n<p>这样，我们的标签体系已经根据实际的业务情况建立起来了，在明确了标签体系以后，也就明确了我们的业务支撑。</p>\n<p>从下一章开始我们将正式开始搭建大数据集群，接入数据，进行标签开发。</p>\n<p>转载自 <a href=\"https://www.cnblogs.com/tree1123/p/12979172.html\">用户画像标签体系——从零开始搭建实时用户画像(三)</a></p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"ckk26vf260001w5ha8ikmg4w2","category_id":"ckk26vf2p0004w5ha7h0mef21","_id":"ckk26vf3s000ew5ha7ybmegtt"},{"post_id":"ckk26vf2l0003w5ha3ppuddlq","category_id":"ckk26vf380009w5ha54rcftmr","_id":"ckk26vf3v000iw5hafim3e7bm"},{"post_id":"ckk26vf2t0006w5ha6erlff0a","category_id":"ckk26vf3s000fw5hafpmuhe5h","_id":"ckk26vf3z000mw5haa6xqasai"},{"post_id":"ckk26vf2x0007w5hacqqb82n5","category_id":"ckk26vf3v000jw5hah5wnew8v","_id":"ckk26vf46000rw5hacrbyfxt8"},{"post_id":"ckk26vf360008w5ha64t0gx3d","category_id":"ckk26vf3v000jw5hah5wnew8v","_id":"ckk26vf4a000vw5ha0nxt89yh"},{"post_id":"ckk26vf3d000cw5hag49tenm0","category_id":"ckk26vf3v000jw5hah5wnew8v","_id":"ckk26vf4c000yw5habdxo6dgn"},{"post_id":"ckk26vf3q000dw5ha1sek33jk","category_id":"ckk26vf49000uw5ha8r47fcs1","_id":"ckk26vf4f0010w5hacwzfculd"}],"PostTag":[{"post_id":"ckk26vf260001w5ha8ikmg4w2","tag_id":"ckk26vf2s0005w5ha7jofg324","_id":"ckk26vf3d000bw5ha0bgf24d9"},{"post_id":"ckk26vf2l0003w5ha3ppuddlq","tag_id":"ckk26vf38000aw5ha9y3v31bn","_id":"ckk26vf3u000hw5hac5jeawpk"},{"post_id":"ckk26vf2t0006w5ha6erlff0a","tag_id":"ckk26vf3t000gw5ha1ugqdhte","_id":"ckk26vf3z000lw5hab5778n9j"},{"post_id":"ckk26vf2x0007w5hacqqb82n5","tag_id":"ckk26vf3w000kw5ha236k5xxc","_id":"ckk26vf45000pw5haegwl2pe8"},{"post_id":"ckk26vf360008w5ha64t0gx3d","tag_id":"ckk26vf3w000kw5ha236k5xxc","_id":"ckk26vf48000tw5ha8c6ge3zn"},{"post_id":"ckk26vf3d000cw5hag49tenm0","tag_id":"ckk26vf3w000kw5ha236k5xxc","_id":"ckk26vf4b000xw5ha3ep8b5mp"},{"post_id":"ckk26vf3q000dw5ha1sek33jk","tag_id":"ckk26vf4b000ww5hab5bzfiu0","_id":"ckk26vf4d000zw5haa56r4iin"}],"Tag":[{"name":"git","_id":"ckk26vf2s0005w5ha7jofg324"},{"name":"flink sql","_id":"ckk26vf38000aw5ha9y3v31bn"},{"name":"hexo demo","_id":"ckk26vf3t000gw5ha1ugqdhte"},{"name":"trident","_id":"ckk26vf3w000kw5ha236k5xxc"},{"name":"trident 标签 画像","_id":"ckk26vf4b000ww5hab5bzfiu0"}]}}